---
title: Bekannte Probleme in Excel XLL-Entwicklung
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: overview
keywords:
- Bekannte Probleme [excel 2007]
localization_priority: Normal
ms.assetid: 3dfecc0b-a91c-448e-8721-5d3486b625fa
description: 'Gilt für: Excel 2013 | Office 2013 | Visual Studio'
ms.openlocfilehash: 34784f6895386efe7e6c3ca7ec213c7d71931058
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "32304004"
---
# <a name="known-issues-in-excel-xll-development"></a><span data-ttu-id="a94af-104">Bekannte Probleme in Excel XLL-Entwicklung</span><span class="sxs-lookup"><span data-stu-id="a94af-104">Known Issues in Excel XLL Development</span></span>

 <span data-ttu-id="a94af-105">**Gilt für**: Excel 2013 | Office 2013 | Visual Studio</span><span class="sxs-lookup"><span data-stu-id="a94af-105">**Applies to**: Excel 2013 | Office 2013 | Visual Studio</span></span> 
  
<span data-ttu-id="a94af-106">In diesem Thema werden bekannte Probleme in Microsoft Excel beschrieben, die bei der XLL-Entwicklung auftreten können.</span><span class="sxs-lookup"><span data-stu-id="a94af-106">This topic describes known issues in Microsoft Excel that you might encounter in XLL development.</span></span>
  
## <a name="unregistering-xll-commands-and-functions"></a><span data-ttu-id="a94af-107">Aufheben der Registrierung von XLL-Befehlen und -Funktionen</span><span class="sxs-lookup"><span data-stu-id="a94af-107">Unregistering XLL Commands and Functions</span></span>

<span data-ttu-id="a94af-108">Wenn eine XLL eine Funktion oder einen Befehl registriert, erstellt Excel einen neuen Namen für die Ressource und ordnet diesem Namen einen Verweis auf die DLL-Funktion zu.</span><span class="sxs-lookup"><span data-stu-id="a94af-108">When an XLL registers a function or command, Excel creates a new name for the resource and associates a reference to the DLL function with that name.</span></span> <span data-ttu-id="a94af-109">Der Name wird aus dem vierten Argument  *pxFunctionText*  der [xlfRegister-Funktion](xlfregister-form-1.md) übernommen.</span><span class="sxs-lookup"><span data-stu-id="a94af-109">The name is taken from the fourth argument,  *pxFunctionText*  , of the [xlfRegister](xlfregister-form-1.md) function.</span></span> <span data-ttu-id="a94af-110">Dieser Name wird in den normalen Dialogfelder zum Verwalten von Arbeitsblattnamen ausgeblendet.</span><span class="sxs-lookup"><span data-stu-id="a94af-110">This name is hidden from the normal dialog boxes for managing worksheet names.</span></span> <span data-ttu-id="a94af-111">Wenn Sie die Registrierung einer Funktion oder eines Befehls aufheben möchten, müssen Sie den Namen mithilfe der [xlfSetName-Funktion](xlfsetname.md) löschen, indem Sie den Namen übergeben, aber keine Definition übergeben.</span><span class="sxs-lookup"><span data-stu-id="a94af-111">To unregister a function or command, you must delete the name by using the [xlfSetName](xlfsetname.md) function, passing the name but not passing a definition.</span></span> <span data-ttu-id="a94af-112">Ein Fehler verhindert jedoch, dass der Name aus den Listen des #A0 entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="a94af-112">However, a bug prevents this from removing the name from the Function Wizard lists.</span></span> 
  
## <a name="argument-description-string-truncation-in-the-function-wizard"></a><span data-ttu-id="a94af-113">Argumentbeschreibung Zeichenfolgenkürzung im Funktions-Assistenten</span><span class="sxs-lookup"><span data-stu-id="a94af-113">Argument Description String Truncation in the Function Wizard</span></span>

<span data-ttu-id="a94af-114">Der  *Parameter pxArgumentHelp1*  und alle nachfolgenden Parameter der **xlfRegister-Funktion** sind optionale Zeichenfolgen, die den Argumenten der XLL-Funktion entsprechen.</span><span class="sxs-lookup"><span data-stu-id="a94af-114">The  *pxArgumentHelp1*  parameter and all subsequent parameters of the **xlfRegister** function are optional strings that correspond to the arguments of the XLL function.</span></span> <span data-ttu-id="a94af-115">Der Funktions-Assistent zeigt diese an, um Hilfe im Dialogfeld Argumentkonstruktion zu bieten.</span><span class="sxs-lookup"><span data-stu-id="a94af-115">The Function Wizard displays these to provide help in the argument construction dialog box.</span></span> <span data-ttu-id="a94af-116">Manchmal Excel die Zeichenfolge, die dem letzten Argument entspricht, beim Anzeigen im Dialogfeld um ein oder zwei Zeichen abgeschnitten.</span><span class="sxs-lookup"><span data-stu-id="a94af-116">Sometimes Excel truncates the string that corresponds to the final argument by one or two characters when displaying it in the dialog box.</span></span> <span data-ttu-id="a94af-117">Sie können dies vermeiden, indem Sie eine zusätzliche leere Zeichenfolge als letzten Parameter für die Argumenthilfe ihrer Funktionsregistrierung hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="a94af-117">You can avoid this by adding an additional "empty string" as the last "argument help" parameter of your function registration.</span></span>
  
## <a name="binary-name-scope-limitation"></a><span data-ttu-id="a94af-118">Einschränkung des Binärnamenbereichs</span><span class="sxs-lookup"><span data-stu-id="a94af-118">Binary Name Scope Limitation</span></span>

<span data-ttu-id="a94af-119">Binäre Namen und ihre Daten können nur abgerufen werden, wenn das Arbeitsblatt, das zum Zeitpunkt der Erstellen aktiv war, wieder aktiv ist.</span><span class="sxs-lookup"><span data-stu-id="a94af-119">Binary names and their data can be retrieved only when the worksheet that was active at the time they were created is again active.</span></span> <span data-ttu-id="a94af-120">Da Arbeitsblattfunktionen Arbeitsblätter in einer Arbeitsmappe nicht aktivieren können (nur Befehle können dies tun), sind Anwendungen mit binären Namen sehr begrenzt.</span><span class="sxs-lookup"><span data-stu-id="a94af-120">Because worksheet functions cannot activate worksheets within a workbook (only commands can do this), applications of binary names are very limited.</span></span> <span data-ttu-id="a94af-121">Wenn Sie über einen Befehl verfügen, der nur von einem bestimmten Arbeitsblatt aufgerufen wird, können Sie beispielsweise einen binären Namen verwenden, um befehlsbezogene Daten zu speichern.</span><span class="sxs-lookup"><span data-stu-id="a94af-121">If you have a command that is only invoked from a particular worksheet, for example, you could use a binary name to store command-related data.</span></span>
  
## <a name="xlset-and-workbooks-with-array-formulas"></a><span data-ttu-id="a94af-122">xlSet und Arbeitsmappen mit Arrayformeln</span><span class="sxs-lookup"><span data-stu-id="a94af-122">xlSet and Workbooks with Array Formulas</span></span>

<span data-ttu-id="a94af-123">In Excel 2003 und früheren Versionen schlägt die [xlSet-Funktion](xlset.md) fehl, wenn Sie versuchen, einem Bereich in einem Arbeitsblatt, das nicht das aktive Arbeitsblatt ist, Werte zuzuordnen, wobei der entsprechende Bereich im aktiven Blatt eine Arrayformel enthält.</span><span class="sxs-lookup"><span data-stu-id="a94af-123">In Excel 2003 and earlier versions, the [xlSet function](xlset.md) fails if you try to assign values to a range on a worksheet that is not the active worksheet, where the equivalent range on the active sheet contains an array formula.</span></span> <span data-ttu-id="a94af-124">In diesem Fall Excel die Meldung "Sie können einen Teil eines Arrays nicht ändern".</span><span class="sxs-lookup"><span data-stu-id="a94af-124">In this case, Excel displays the message "You cannot change part of an array."</span></span> <span data-ttu-id="a94af-125">Dies wurde in Excel 2007 behoben.</span><span class="sxs-lookup"><span data-stu-id="a94af-125">This was fixed in Excel 2007.</span></span> 
  
## <a name="circular-references-are-tolerated-in-data-tables"></a><span data-ttu-id="a94af-126">Zirkelverweise werden in Datentabellen toleriert</span><span class="sxs-lookup"><span data-stu-id="a94af-126">Circular References are Tolerated in Data Tables</span></span>

<span data-ttu-id="a94af-127">Excel verursacht derzeit keinen Fehler, wenn die Berechnung, auf der eine Datentabelle basiert, auf etwas in der Tabelle selbst verweist.</span><span class="sxs-lookup"><span data-stu-id="a94af-127">Excel currently does not raise an error if the calculation that a data table is based on refers to something in the table itself.</span></span> <span data-ttu-id="a94af-128">So unwahrscheinlich dieses Szenario auch sein mag, Sie sollten beim Erstellen oder Ändern von Formeln, die zum Berechnen von Datentabellewerten verwendet werden, vorsichtig sein.</span><span class="sxs-lookup"><span data-stu-id="a94af-128">As unlikely as this scenario might be, you should be careful when you are creating or modifying formulas that are used to calculate data table values.</span></span>
  
## <a name="converting-an-integer-xloper12-to-an-xloper"></a><span data-ttu-id="a94af-129">Konvertieren einer ganzzahligen XLOPER12 in einen XLOPER</span><span class="sxs-lookup"><span data-stu-id="a94af-129">Converting an Integer XLOPER12 to an XLOPER</span></span>

<span data-ttu-id="a94af-130">Da der ganzzahlige Typ **xltypeInt** eine 32-Bit-ganze Zahl im **XLOPER12-Datentyp** ist, es sich jedoch nur um eine 16-Bit-ganzzahlige Zahl im **XLOPER-Datentyp** handelt, können einige ganzzahlige **XLOPER12-Werte** nicht in einer ganzzahligen **XLOPER enthalten sein.**</span><span class="sxs-lookup"><span data-stu-id="a94af-130">Because the integer type **xltypeInt** is a 32-bit signed integer in the **XLOPER12** data type, but it is only a 16-bit signed integer in the **XLOPER** data type, it is possible that some integer **XLOPER12** values cannot be contained in an integer **XLOPER**.</span></span> <span data-ttu-id="a94af-131">Wenn Excel diesen Typ intern konvertiert, wird dieses Problem dadurch behoben, dass der Typ in einen Gleitkommatyp **xltypeNum** **XLOPER konvertiert wird.**</span><span class="sxs-lookup"><span data-stu-id="a94af-131">Where Excel converts this type internally, it gets around this problem by converting the type to a floating-point **xltypeNum** **XLOPER**.</span></span>
  
<span data-ttu-id="a94af-132">Die Framework [XLOper12ToXLOper-Funktion](xloper12toxloper.md) spiegelt dieses Verhalten so ab, dass es intern Excel ist.</span><span class="sxs-lookup"><span data-stu-id="a94af-132">The Framework [XLOper12ToXLOper](xloper12toxloper.md) function mirrors this behavior to be consistent with Excel internally.</span></span> <span data-ttu-id="a94af-133">Wenn Sie diese Funktion aufrufen, sollten Sie nicht davon ausgehen, dass der zurückgegebene **XLOPER** immer **xltypeInt ist.** Das **my_xloper.val.w** gibt einen false-Wert an, wenn der **my_xloper** **xltypeNum ist.**</span><span class="sxs-lookup"><span data-stu-id="a94af-133">When you call this function, you should not assume that the returned **XLOPER** will always be **xltypeInt**; reading **my_xloper.val.w** gives a false value if the **my_xloper** type is **xltypeNum**.</span></span>
  
## <a name="returning-xloper-or-xloper12-by-modifying-arguments-in-place"></a><span data-ttu-id="a94af-134">Zurückgeben von XLOPER oder XLOPER12 durch Ändern von Argumenten an Ort und Stelle</span><span class="sxs-lookup"><span data-stu-id="a94af-134">Returning XLOPER or XLOPER12 by Modifying Arguments in Place</span></span>

<span data-ttu-id="a94af-135">Excel ermöglicht die Registrierung von Funktionen, die einen **XLOPER-** oder **XLOPER12-Wert** zurückgeben, indem ein vorhandenes Argument geändert wird.</span><span class="sxs-lookup"><span data-stu-id="a94af-135">Excel permits the registration of functions that return an **XLOPER** or **XLOPER12** by modifying an argument in place.</span></span> <span data-ttu-id="a94af-136">Wenn jedoch ein **XLOPER** /  **XLOPER12-Argument** auf den Arbeitsspeicher verweist und der Zeiger dann vom Rückgabewert der DLL-Funktion überschrieben wird, Excel Speicher verloren.</span><span class="sxs-lookup"><span data-stu-id="a94af-136">However, if an **XLOPER**/ **XLOPER12** argument points to memory, and the pointer is then overwritten by the return value of the DLL function, Excel can leak memory.</span></span> <span data-ttu-id="a94af-137">Excel wird kein Fehler angezeigt, aber es kann schließlich abstürzen.</span><span class="sxs-lookup"><span data-stu-id="a94af-137">Excel does not display an error, but it might eventually crash.</span></span> <span data-ttu-id="a94af-138">Wenn die DLL den Arbeitsspeicher für den Rückgabewert zugewiesen hat, Excel möglicherweise versuchen, diesen Speicher frei zu geben, was zu einem sofortigen Anwendungsabsturz führen kann.</span><span class="sxs-lookup"><span data-stu-id="a94af-138">Also, if the DLL allocated memory for the return value, Excel might try to free that memory, which could cause an immediate application crash.</span></span> <span data-ttu-id="a94af-139">Daher sollten Sie **xlOPER** /  **XLOPER12-Argumente nicht** an Ort und Stelle ändern.</span><span class="sxs-lookup"><span data-stu-id="a94af-139">Therefore, you should not modify **XLOPER**/ **XLOPER12** arguments in place.</span></span> <span data-ttu-id="a94af-140">Alle **XLOPER-** oder **XLOPER12-Argumente** sollten als streng schreibgeschützt behandelt werden.</span><span class="sxs-lookup"><span data-stu-id="a94af-140">All **XLOPER** or **XLOPER12** arguments should be treated as strictly read-only.</span></span> 
  
<span data-ttu-id="a94af-141">Weitere Informationen finden Sie unter [Speicherverwaltung in Excel](memory-management-in-excel.md).</span><span class="sxs-lookup"><span data-stu-id="a94af-141">For more information, see [Memory Management in Excel](memory-management-in-excel.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="a94af-142">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="a94af-142">See also</span></span>



[<span data-ttu-id="a94af-143">XLOper12ToXLOper</span><span class="sxs-lookup"><span data-stu-id="a94af-143">XLOper12ToXLOper</span></span>](xloper12toxloper.md)


[<span data-ttu-id="a94af-144">Entwickeln von XLLs für Excel</span><span class="sxs-lookup"><span data-stu-id="a94af-144">Developing Excel XLLs</span></span>](developing-excel-xlls.md)
  
[<span data-ttu-id="a94af-145">Excel XLL SDK – API-Funktionsreferenz</span><span class="sxs-lookup"><span data-stu-id="a94af-145">Excel XLL SDK API Function Reference</span></span>](excel-xll-sdk-api-function-reference.md)
  
[<span data-ttu-id="a94af-146">Speicherverwaltung in Excel</span><span class="sxs-lookup"><span data-stu-id="a94af-146">Memory Management in Excel</span></span>](memory-management-in-excel.md)

