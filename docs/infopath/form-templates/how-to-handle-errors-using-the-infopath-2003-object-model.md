---
title: Behandeln von Fehlern mithilfe des InfoPath 2003-Objektmodells
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
keywords:
- infopath 2003-kompatible Formularvorlagen, Behandeln von Fehlern, InfoPath 2003-kompatible Formularvorlagen, Fehlerbehandlung, Formularvorlagen [InfoPath 2007], Fehlerbehandlung,Fehlerbehandlung [InfoPath 2007], InfoPath 2003-kompatible Formularvorlagen
localization_priority: Normal
ms.assetid: eeb05205-d6f4-4931-b9a9-55a663bb1a25
description: Beim Erstellen von benutzerdefinierten Anwendungen müssen Entwickler häufig Fehler behandeln, wobei auch Programmiercode geschrieben werden muss, um nach Fehlern zu suchen, die von der Anwendung ausgelöst wurden, oder um benutzerdefinierte Fehler zu erstellen und auszulösen. Das InfoPath 2003-kompatible Objektmodell unterstützt die Fehlerbehandlung mithilfe des ErrorObject-Objekts in Verbindung mit der ErrorsCollection-Auflistung.
ms.openlocfilehash: 93991e33d8867f89454bec08b41ba83e98ab0a17
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33439478"
---
# <a name="handle-errors-using-the-infopath-2003-object-model"></a><span data-ttu-id="d86f0-105">Behandeln von Fehlern mithilfe des InfoPath 2003-Objektmodells</span><span class="sxs-lookup"><span data-stu-id="d86f0-105">Handle Errors Using the InfoPath 2003 Object Model</span></span>

<span data-ttu-id="d86f0-106">Beim Erstellen von benutzerdefinierten Anwendungen müssen Entwickler häufig Fehler behandeln, wobei auch Programmiercode geschrieben werden muss, um nach Fehlern zu suchen, die von der Anwendung ausgelöst wurden, oder um benutzerdefinierte Fehler zu erstellen und auszulösen.</span><span class="sxs-lookup"><span data-stu-id="d86f0-106">When creating custom applications, developers must often perform error handling that involves writing programming code to check for errors raised by the application or to create and raise custom errors.</span></span> <span data-ttu-id="d86f0-107">Das InfoPath 2003-kompatible Objektmodell unterstützt die Fehlerbehandlung mithilfe des [ErrorObject-Objekts](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorObject.aspx) in Verbindung mit der [ErrorsCollection-Auflistung.](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx)</span><span class="sxs-lookup"><span data-stu-id="d86f0-107">The InfoPath 2003-compatible object model supports error handling through the use of the [ErrorObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorObject.aspx) object in association with the [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) collection.</span></span> 
  
<span data-ttu-id="d86f0-108">In InfoPath können Fehler auftreten, wenn in ein Formular eingegebene Daten die XML-Schemaüberprüfung nicht erfolgreich sind, wenn eine benutzerdefinierte Überprüfungseinschränkung fehlschlägt, wenn ein Fehler von der [ReportError-Methode](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.ReportError.aspx) des [DataDOMEventObject-Objekts](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) generiert wird oder wenn ein Fehler mit der [Add-Methode](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx) der [ErrorsCollection-Auflistung](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="d86f0-108">In InfoPath, errors can occur when data entered into a form fails XML schema validation, when a custom validation constraint fails, when an error is generated by the [ReportError](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.ReportError.aspx) method of the [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) object, or when an error is created using the [Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx) method of the [ErrorsCollection](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.ErrorsCollection.aspx) collection.</span></span> 
  
## <a name="overview-of-the-errorscollection-collection"></a><span data-ttu-id="d86f0-109">Übersicht über die ErrorsCollection-Auflistung</span><span class="sxs-lookup"><span data-stu-id="d86f0-109">Overview of the ErrorsCollection Collection</span></span>

<span data-ttu-id="d86f0-110">Die **ErrorsCollection**-Auflistung stellt die folgenden Methoden und Eigenschaften bereit, mit deren Hilfe Entwickler die in der Auflistung enthaltenen **ErrorObject**-Objekte verwalten können.</span><span class="sxs-lookup"><span data-stu-id="d86f0-110">The **ErrorsCollection** collection provides the following methods and properties, which form developers can use to manage the **ErrorObject** objects that the collection contains.</span></span> 
  
|<span data-ttu-id="d86f0-111">**Name**</span><span class="sxs-lookup"><span data-stu-id="d86f0-111">**Name**</span></span>|<span data-ttu-id="d86f0-112">**Beschreibung**</span><span class="sxs-lookup"><span data-stu-id="d86f0-112">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="d86f0-113">[Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx)-Methode</span><span class="sxs-lookup"><span data-stu-id="d86f0-113">[Add](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Add.aspx) method</span></span>  <br/> |<span data-ttu-id="d86f0-114">Erstellt ein **ErrorObject**-Objekt und fügt es der Auflistung hinzu.</span><span class="sxs-lookup"><span data-stu-id="d86f0-114">Creates an **ErrorObject** object and adds it to the collection.</span></span>  <br/> |
|<span data-ttu-id="d86f0-115">[Delete](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Delete.aspx)-Methode</span><span class="sxs-lookup"><span data-stu-id="d86f0-115">[Delete](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Delete.aspx) method</span></span>  <br/> |<span data-ttu-id="d86f0-116">Löscht alle **ErrorObject**-Objekte, die dem angegebenen XML-Knoten und Bedingungsnamen zugeordnet sind, mit Ausnahme von benutzerdefinierten Fehlern, die mithilfe der **ReportError**-Methode hinzugefügt wurden.</span><span class="sxs-lookup"><span data-stu-id="d86f0-116">Deletes all **ErrorObject** objects associated with the specified XML node and condition name, except for custom errors added using the **ReportError** method.</span></span>  <br/> |
|<span data-ttu-id="d86f0-117">[DeleteAll-Methode](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.DeleteAll.aspx)</span><span class="sxs-lookup"><span data-stu-id="d86f0-117">[DeleteAll](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.DeleteAll.aspx) method</span></span>  <br/> |<span data-ttu-id="d86f0-118">Löscht alle **ErrorObject**-Objekte, die in der Auflistung enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="d86f0-118">Deletes all **ErrorObject** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="d86f0-119">[Count](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Count.aspx)-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="d86f0-119">[Count](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Count.aspx) property</span></span>  <br/> |<span data-ttu-id="d86f0-120">Ruft die Anzahl der **ErrorObject**-Objekte ab, die in der Auflistung enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="d86f0-120">Gets a count of the number of **ErrorObject** objects contained in the collection.</span></span>  <br/> |
|<span data-ttu-id="d86f0-121">[Item](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Item.aspx)-Eigenschaft</span><span class="sxs-lookup"><span data-stu-id="d86f0-121">[Item](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Errors.Item.aspx) property</span></span>  <br/> |<span data-ttu-id="d86f0-122">Ruft einen Verweis auf ein **ErrorObject**-Objekt basierend auf der angegebenen Indexnummer ab.</span><span class="sxs-lookup"><span data-stu-id="d86f0-122">Gets a reference to an **ErrorObject** object based on the specified index number.</span></span>  <br/> |
   
## <a name="overview-of-the-errorobject-object"></a><span data-ttu-id="d86f0-123">Übersicht über das ErrorObject-Objekt</span><span class="sxs-lookup"><span data-stu-id="d86f0-123">Overview of the ErrorObject Object</span></span>

<span data-ttu-id="d86f0-124">Das **ErrorObject**-Objekt stellt die folgenden Eigenschaften bereit, über die Formularentwickler auf Informationen zu dem ausgelösten Fehler zugreifen können.</span><span class="sxs-lookup"><span data-stu-id="d86f0-124">The **ErrorObject** object provides the following properties, which form developers can use to access information about the error that was raised.</span></span> 
  
|<span data-ttu-id="d86f0-125">**Name**</span><span class="sxs-lookup"><span data-stu-id="d86f0-125">**Name**</span></span>|<span data-ttu-id="d86f0-126">**Beschreibung**</span><span class="sxs-lookup"><span data-stu-id="d86f0-126">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="d86f0-127">[ConditionName-Eigenschaft](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ConditionName.aspx)</span><span class="sxs-lookup"><span data-stu-id="d86f0-127">[ConditionName](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ConditionName.aspx) property</span></span>  <br/> |<span data-ttu-id="d86f0-128">Ruft in Abhängigkeit vom Typ des **ErrorObject**-Objekts den Namen der Fehlerbedingung ab oder gibt **null** zurück.</span><span class="sxs-lookup"><span data-stu-id="d86f0-128">Gets the name of the error condition, or returns **null**, depending on the type of **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="d86f0-129">[DetailedErrorMessage-Eigenschaft](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.DetailedErrorMessage.aspx)</span><span class="sxs-lookup"><span data-stu-id="d86f0-129">[DetailedErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.DetailedErrorMessage.aspx) property</span></span>  <br/> |<span data-ttu-id="d86f0-130">Ruft die ausführliche Fehlermeldung des **ErrorObject**-Objekts ab oder legt sie fest.</span><span class="sxs-lookup"><span data-stu-id="d86f0-130">Gets or sets the detailed error message of the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="d86f0-131">[ErrorCode-Eigenschaft](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorCode.aspx)</span><span class="sxs-lookup"><span data-stu-id="d86f0-131">[ErrorCode](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorCode.aspx) property</span></span>  <br/> |<span data-ttu-id="d86f0-132">Ruft den Fehlercode des **ErrorObject**-Objekts ab oder legt ihn fest.</span><span class="sxs-lookup"><span data-stu-id="d86f0-132">Gets or sets the error code of the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="d86f0-133">[Node-Eigenschaft](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.Node.aspx)</span><span class="sxs-lookup"><span data-stu-id="d86f0-133">[Node](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.Node.aspx) property</span></span>  <br/> |<span data-ttu-id="d86f0-134">Ruft einen Verweis auf den XML-Knoten ab, der dem **ErrorObject**-Objekt zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="d86f0-134">Gets a reference to the XML node associated with the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="d86f0-135">[ShortErrorMessage-Eigenschaft](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ShortErrorMessage.aspx)</span><span class="sxs-lookup"><span data-stu-id="d86f0-135">[ShortErrorMessage](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ShortErrorMessage.aspx) property</span></span>  <br/> |<span data-ttu-id="d86f0-136">Ruft die kurze Fehlermeldung des **ErrorObject**-Objekts ab oder legt sie fest.</span><span class="sxs-lookup"><span data-stu-id="d86f0-136">Gets or sets the short error message of the **ErrorObject** object.</span></span>  <br/> |
|<span data-ttu-id="d86f0-137">[ErrorType-Eigenschaft](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorType.aspx)</span><span class="sxs-lookup"><span data-stu-id="d86f0-137">[ErrorType](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.Error.ErrorType.aspx) property</span></span>  <br/> |<span data-ttu-id="d86f0-138">Ruft den Typ des **ErrorObject**-Objekts ab.</span><span class="sxs-lookup"><span data-stu-id="d86f0-138">Gets the type of the **ErrorObject** object.</span></span>  <br/> |
   
## <a name="using-the-errorscollection-and-errorobject"></a><span data-ttu-id="d86f0-139">Verwenden der ErrorsCollection-Auflistung und des ErrorObject-Objekts</span><span class="sxs-lookup"><span data-stu-id="d86f0-139">Using the ErrorsCollection and ErrorObject</span></span>

<span data-ttu-id="d86f0-140">Auf **die ErrorsCollection-Auflistung** wird über die [Errors-Eigenschaft](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument.Errors.aspx) des [XDocument-Objekts](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) zugegriffen.</span><span class="sxs-lookup"><span data-stu-id="d86f0-140">The **ErrorsCollection** collection is accessed through the [Errors](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._XDocument.Errors.aspx) property of the [XDocument](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.XDocument.aspx) object.</span></span> <span data-ttu-id="d86f0-141">Die **ErrorsCollection**-Auflistung ist dem einem Formular zugrunde liegenden XML-Dokument zugeordnet; falls ein Fehler auftritt, tritt er daher innerhalb des XML-Dokuments auf.</span><span class="sxs-lookup"><span data-stu-id="d86f0-141">The **ErrorsCollection** collection is associated with a form's underlying XML document so that when an error occurs, it occurs within the XML document.</span></span> <span data-ttu-id="d86f0-142">Das folgende Beispiel zeigt, wie eine in Visual C# geschriebene **foreach**-Schleife verwendet werden kann, um die Fehler zu überprüfen, die in dem einem Formular zugrunde liegenden XML-Dokument vorhanden sein könnten.</span><span class="sxs-lookup"><span data-stu-id="d86f0-142">The following example demonstrates how a Visual C# **foreach** loop can be used to check the errors that may exist in a form's underlying XML document.</span></span> <span data-ttu-id="d86f0-143">Falls Fehler gefunden werden, durchläuft die Funktion jeden dieser Fehler und zeigt mithilfe der **ShortErrorMessage**-Eigenschaft des **ErrorObject**-Objekts ein Meldungsfeld für den Benutzer an.</span><span class="sxs-lookup"><span data-stu-id="d86f0-143">If there are errors, the function loops through each of them, and, using the **ShortErrorMessage** property of the **ErrorObject** object, displays a message box to the user.</span></span> 
  
```cs
public void CheckErrors(IXMLDOMNode xmlNode)
{
   foreach(ErrorObject err in thisXDocument.Errors)
   {
      if(xmlNode==err.Node)
         thisXDocument.UI.Alert("The following error has occured: "
             + err.ShortErrorMessage + ".");
   }
}
```

<span data-ttu-id="d86f0-144">Die vorangegangene Funktion kann von einem der Datenüberprüfungs-Ereignishandler des Formulars aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="d86f0-144">The preceding function could be called from one of the form's data validation event handlers.</span></span> <span data-ttu-id="d86f0-145">Wenn sie beispielsweise im [OnAfterChange-Ereignishandler](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx) für ein Feld im Formular verwendet wird, würde der Aufruf der Funktion das Argument XML-Knoten mit der [Site-Eigenschaft](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.Site.aspx) des [DataDOMEventObject-Objekts](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) wie folgt übergeben.</span><span class="sxs-lookup"><span data-stu-id="d86f0-145">For example, when used in the [OnAfterChange](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust._DataDOMEventSink_Event.OnAfterChange.aspx) event handler for a field in the form, the call to the function would pass the XML node argument using the [Site](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEvent.Site.aspx) property of the [DataDOMEventObject](https://msdn.microsoft.com/library/Microsoft.Office.Interop.InfoPath.SemiTrust.DataDOMEventObject.aspx) object as follows.</span></span> 
  
```cs
CheckErrors(e.Site);
```

<span data-ttu-id="d86f0-p105">Neben der Behandlung von Fehlern, die durch InfoPath generiert werden, können Formularentwickler mithilfe der **ReportError**-Methode des **DataDOMEventObject**-Objekts oder mithilfe der **Add**-Methode der **ErrorsCollection**-Auflistung auch benutzerdefinierte Fehler generieren. Informationen zur Verwendung der Methoden **ReportError** und **Add** erhalten Sie, indem Sie am Anfang des Themas auf die entsprechende Methode klicken.</span><span class="sxs-lookup"><span data-stu-id="d86f0-p105">In addition to handling errors generated by InfoPath, form developers can also generate custom errors by using the **ReportError** method of the **DataDOMEventObject** object, or by using the **Add** method of the **ErrorsCollection** collection. For information about using the **ReportError** or **Add** methods, click the methods at the beginning of this topic.</span></span> 
  
## <a name="handling-managed-code-exceptions"></a><span data-ttu-id="d86f0-148">Behandlung von Ausnahmen im verwalteten Code</span><span class="sxs-lookup"><span data-stu-id="d86f0-148">Handling Managed-Code Exceptions</span></span>

<span data-ttu-id="d86f0-149">Sie können die try-catch-Ausnahmebehandlung zum Behandeln von Ausnahmen verwenden, die in Formularvorlagen mit verwaltetem Code ausgelöst wurden. Dies wird im folgenden Codebeispiel gezeigt.</span><span class="sxs-lookup"><span data-stu-id="d86f0-149">You can use try-catch exception handling to handle exceptions raised in managed-code form template as shown in the following code example.</span></span>
  
```cs
DataAdapters dataAdapters;
dataAdapters = thisXDocument.DataAdapters; 
XMLFileAdapterObject queryXMLFile = 
   (XMLFileAdapterObject)dataAdapters["form1"];
// Perform the query.
try
{
   queryXMLFile.Query();
}
catch (Exception ex)
{
   thisXDocument.UI.Alert("Failed to query.\n\n" + ex.Message);
}
// Perform the submit.
try
{
   queryXMLFile.Submit();
}
catch (Exception ex)
{
   thisXDocument.UI.Alert("Failed to submit.\n\n" + ex.Message);
}
```

<span data-ttu-id="d86f0-150">Wenn Sie im Formularcode keine try-catch-Ausnahmebehandlung verwenden, zeigt InfoPath beim Debuggen und Anzeigen der Vorschau Informationen zu unbehandelten Ausnahmen im Dialogfeld für InfoPath-Fehler an.</span><span class="sxs-lookup"><span data-stu-id="d86f0-150">If you do not use try-catch exception handling in your form code, InfoPath will display information about unhandled exceptions in the InfoPath error dialog box while debugging and previewing.</span></span> 
  

