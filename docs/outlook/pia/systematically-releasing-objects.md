---
title: Systematisches Freigeben von Objekten
TOCTitle: Systematically releasing objects
ms:assetid: d4cd1d8e-aae6-483b-a4d8-1656171e838d
ms:mtpsurl: https://msdn.microsoft.com/library/Bb623945(v=office.15)
ms:contentKeyID: 55119785
ms.date: 07/24/2014
mtps_version: v=office.15
localization_priority: Normal
ms.openlocfilehash: 5d71ffbdbd10657832a319e1e669f38f311ad99f
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "32319243"
---
# <a name="systematically-releasing-objects"></a><span data-ttu-id="f516d-102">Systematisches Freigeben von Objekten</span><span class="sxs-lookup"><span data-stu-id="f516d-102">Systematically releasing objects</span></span>

<span data-ttu-id="f516d-103">In diesem Thema finden Sie eine Zusammenfassung der Empfehlungen für das Herunterfahren von Add-Ins für Add-In-Entwickler und IT-Administratoren, die Outlook verwenden.</span><span class="sxs-lookup"><span data-stu-id="f516d-103">This topic summarizes add-in shutdown recommendations for add-in developers and IT administrators that use Outlook.</span></span> <span data-ttu-id="f516d-104">Weitere Informationen finden Sie unter [Änderungen beim Herunterfahren für Outlook 2010](https://msdn.microsoft.com/library/ee720183\(v=office.15\)).</span><span class="sxs-lookup"><span data-stu-id="f516d-104">For more information, see [Shutdown Changes for Outlook 2010](https://msdn.microsoft.com/library/ee720183\(v=office.15\)).</span></span>

## <a name="add-in-shutdown-changes-in-outlook"></a><span data-ttu-id="f516d-105">Änderungen beim Herunterfahren von Add-Ins in Outlook</span><span class="sxs-lookup"><span data-stu-id="f516d-105">Add-in shutdown changes in Outlook</span></span>

<span data-ttu-id="f516d-106">Ab Outlook 2010 signalisiert Outlook standardmäßig nicht, dass Add-Ins heruntergefahren werden.</span><span class="sxs-lookup"><span data-stu-id="f516d-106">Starting in Outlook 2010, Outlook, by default, does not signal add-ins that it is shutting down.</span></span> <span data-ttu-id="f516d-107">Insbesondere ruft Outlook die **OnBeginShutdown(Array)**- und **OnDisconnection (ext\_DisconnectMode, Array)**-Methoden der **IDTExtensibility2**-Schnittstelle beim schnellen Herunterfahren nicht mehr auf.</span><span class="sxs-lookup"><span data-stu-id="f516d-107">Specifically, Outlook no longer calls the **OnBeginShutdown(Array)** and **OnDisconnection(ext\_DisconnectMode, Array)** methods of the **IDTExtensibility2** interface during fast shutdown.</span></span> <span data-ttu-id="f516d-108">Ebenso ruft ein Outlook-Add-In, das mit Office-Entwicklungstools in Visual Studio 2010 oder höher geschrieben wurde, die ThisAddin\_Shutdown-Methode nicht mehr auf, wenn Outlook beendet wird.</span><span class="sxs-lookup"><span data-stu-id="f516d-108">Similarly, an Outlook add-in, written with Office development tools in Visual Studio 2010 or a later version, no longer calls the ThisAddin\_Shutdown method when Outlook is shutting down.</span></span> 

<span data-ttu-id="f516d-109">Der Grund dafür, dass diese Methoden nicht länger aufgerufen werden, liegt darin, dass während einige Add-Ins einfache Aufgaben wie das Freigeben von Referenzen während dieser Ereignisse durchführen, andere Add-Ins Webdienstaufrufe oder andere lange andauernde Vorgänge gleichzeitig ausführen, was zu erheblichen Verzögerungen beim Beenden von Outlook führte.</span><span class="sxs-lookup"><span data-stu-id="f516d-109">The reason to stop calling these methods is that while a majority of add-ins perform simple tasks like releasing references, some add-ins make Web service calls or other long-running operations synchronously during these events, significantly delaying Outlook from shutting down.</span></span> <span data-ttu-id="f516d-110">Aufgrund dieser Änderung funktioniert Outlook nun besser als in der Vergangenheit beim Herunterfahren.</span><span class="sxs-lookup"><span data-stu-id="f516d-110">As a result of this change, Outlook works better than it has in the past when shutting down.</span></span>

## <a name="recommendations-for-add-in-shutdown-for-developers"></a><span data-ttu-id="f516d-111">Empfehlungen für das Herunterfahren von Add-Ins für Entwickler</span><span class="sxs-lookup"><span data-stu-id="f516d-111">Recommendations for add-in shutdown for developers</span></span>

<span data-ttu-id="f516d-112">Es ist wichtig, dass Entwickler sich an die folgenden Empfehlungen für das Herunterfahren von Add-Ins halten, damit die Endbenutzer weiterhin Outlook schnell herunterfahren können.</span><span class="sxs-lookup"><span data-stu-id="f516d-112">It is important that developers observe the following recommendations for add-in shutdown to ensure that end users continue to benefit from a fast and responsive Outlook shutdown experience.</span></span>

- <span data-ttu-id="f516d-113">Add-Ins sollten weiterhin die OnBeginShutdown- und die OnDisconnection-Methode oder ThisAddin\_Shutdown implementieren, um Verweise und reservierten Arbeitsspeicher freizugeben, weil Administratoren in bestimmten Szenarien vielleicht auf das langsame Herunterfahren über eine Gruppenrichtlinie zurückgreifen, oder weil der Benutzer das Add-In manuell über das Dialogfeld **COM-Add-Ins** trennen möchte.</span><span class="sxs-lookup"><span data-stu-id="f516d-113">Add-ins should continue to implement the OnBeginShutdown and OnDisconnection methods or ThisAddin\_Shutdown to release references and allocated memory, because there are scenarios in which administrators might revert to slow shutdown through group policy, or the user might manually disconnect your add-in through the **COM Add-ins** dialog box.</span></span>

- <span data-ttu-id="f516d-114">Add-In-Entwickler sollten nur Aufgaben ausführen, die unbedingt beim Herunterfahren erfolgen müssen.</span><span class="sxs-lookup"><span data-stu-id="f516d-114">Add-in developers should only perform tasks that absolutely must take place during shutdown.</span></span>

- <span data-ttu-id="f516d-115">Add-In-Entwickler sollten die Leistung der Add-Ins in verschiedenen Szenarien und bei unterschiedlichen Windows-Registrierungseinstellungen zur Steuerung des Herunterfahrens von Outlook testen. Die Add-Ins sollten proaktiv für das Zusammenspiel mit Outlook angepasst werden.</span><span class="sxs-lookup"><span data-stu-id="f516d-115">Add-in developers should evaluate the performance of their add-ins in various scenarios and under different Windows registry settings that control Outlook shutdown, and proactively modify their add-ins to work with Outlook.</span></span>

## <a name="recommendations-for-add-in-shutdown-for-it-administrators"></a><span data-ttu-id="f516d-116">Empfehlungen für das Herunterfahren von Add-Ins für IT-Administratoren</span><span class="sxs-lookup"><span data-stu-id="f516d-116">Recommendations for add-in shutdown for IT administrators</span></span>

<span data-ttu-id="f516d-117">Wenn Add-Ins bereits in einem Unternehmen bereitgestellt sind und nicht geupgradet werden können, um Kompatibilität mit dem neuen Mechanismus zum Herunterfahren von Outlook herzustellen, können IT-Administratoren eine Reihe von Windows-Registrierungseinstellungen verwenden, um auf das langsame Herunterfahren umzusteigen.</span><span class="sxs-lookup"><span data-stu-id="f516d-117">For IT administrators, if there are add-ins that are already deployed in an enterprise and cannot be upgraded to become compatible with the new shutdown Outlook mechanism, IT administrators can resort to a couple of Windows registry settings to revert to the slow shutdown behavior.</span></span>

### <a name="individual-add-in-setting"></a><span data-ttu-id="f516d-118">Einstellung für ein einzelnes Add-In</span><span class="sxs-lookup"><span data-stu-id="f516d-118">Individual add-in setting</span></span>

<span data-ttu-id="f516d-p104">IT-Administratoren können Benachrichtigungen für das Herunterfahren an einzelne Outlook-Add-Ins als Teil der Add-In-Bereitstellung aktivieren. Das ist zwar nicht über eine Gruppenrichtlinie möglich, doch empfiehlt es sich, Abwärtskompatibilität für bestimmte Add-Ins zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="f516d-p104">IT administrators can enable shutdown notifications to individual Outlook add-ins as part of the add-in deployment. Although you cannot do this through group policy, it is useful if you have backward-compatibility requirements for specific add-ins.</span></span>

<span data-ttu-id="f516d-p105">Konfigurieren Sie diese Einstellung für jedes Add-In über die Add-In-Registrierung in der HKCU- oder HKLM-Registrierungsstruktur, indem Sie der Add-In-Registrierung einen zusätzlichen Wert hinzufügen. Geben Sie den folgenden Text als eine einzige Zeile ein:</span><span class="sxs-lookup"><span data-stu-id="f516d-p105">Configure this setting for each add-in through the add-in registration in the HKCU or the HKLM registry hives, by adding an additional value to the add-in registration. Type the following text as a single line:</span></span>

`HKCU\Software\Microsoft\Office\Outlook\Add-ins\<ProgID>[RequireShutdownNotification]=dword:0x1`

<span data-ttu-id="f516d-123">Wenn dieser Wert auf „0x1“ festgelegt wird, kann das Add-In blockierte Rückrufe beim Beenden von Outlook empfangen.</span><span class="sxs-lookup"><span data-stu-id="f516d-123">Setting this value to 0x1 enables the add-in to receive blocked callbacks during Outlook shutdown.</span></span> <span data-ttu-id="f516d-124">Dies hat einen Einfluss auf die Leistung von Outlook beim Herunterfahren und sollte als Teil einer Bereitstellung erwogen werden.</span><span class="sxs-lookup"><span data-stu-id="f516d-124">This has an impact on the performance of Outlook shutdown and should be evaluated as part of a deployment.</span></span> <span data-ttu-id="f516d-125">Diese Einstellung sollte nur, verwendet werden, wenn ein Add-In erhebliche Kompatibilitätsprobleme mit den neuen Mechanismen beim Herunterfahren aufweist.</span><span class="sxs-lookup"><span data-stu-id="f516d-125">This setting should be used only if an add-in has significant compatibility issues with the new shutdown mechanism.</span></span> <span data-ttu-id="f516d-126">Wenn Sie den Wert auf 0x0 festlegen, wird das Standardverhalten von Outlook angewendet.</span><span class="sxs-lookup"><span data-stu-id="f516d-126">Setting the value to 0x0 uses the default behavior of Outlook.</span></span>

### <a name="global-setting"></a><span data-ttu-id="f516d-127">Globale Einstellung</span><span class="sxs-lookup"><span data-stu-id="f516d-127">Global setting</span></span>

<span data-ttu-id="f516d-128">IT-Administratoren können Benachrichtigungen zum Herunterfahren global für alle Add-Ins mithilfe der Gruppenrichtlinie aktivieren.</span><span class="sxs-lookup"><span data-stu-id="f516d-128">IT administrators can enable shutdown notifications globally for all add-ins through group policy.</span></span> <span data-ttu-id="f516d-129">Dies empfiehlt sich für Organisationen mit einer großen Anzahl von internen Lösungen oder Desktops, für die diese Einstellung bereitgestellt werden muss, damit während eines Rollouts von Outlook die Kompatibilität gewährleistet ist.</span><span class="sxs-lookup"><span data-stu-id="f516d-129">This is recommended for organizations that have a large number of internal solutions or desktops that need to deploy this setting to ensure compatibility during a rollout of Outlook.</span></span>

<span data-ttu-id="f516d-130">Mit dieser Einstellung können Sie den Mechanismus für das Herunterfahren auf den von Outlook 2007 verwendeten umstellen.</span><span class="sxs-lookup"><span data-stu-id="f516d-130">Use this setting to change the shutdown mechanism to match that used by Outlook 2007.</span></span> <span data-ttu-id="f516d-131">Sie können die Einstellung über die Gruppenrichtlinie entweder pro Benutzer oder pro Computer bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="f516d-131">You can deploy the setting through group policy, either per user or per computer.</span></span> <span data-ttu-id="f516d-132">Geben Sie den folgenden Text als einzelne Zeile ein:</span><span class="sxs-lookup"><span data-stu-id="f516d-132">Type the following text as a single line:</span></span>

`HKCU\Policies\Microsoft\Office\Outlook\15.0\Options\Shutdown[AddinFastShutdownBehavior]=dword:0x1`

<span data-ttu-id="f516d-133">Wenn Sie AddinFastShutdownBehavior auf „0x1“ festlegen, werden Benachrichtigungen für das Herunterfahren für alle Add-Ins aktiviert. Wenn Sie den Wert auf „0x0“ festlegen, wird das Standardverhalten von Outlook angewendet.</span><span class="sxs-lookup"><span data-stu-id="f516d-133">Setting AddinFastShutdownBehavior to 0x1 enables shutdown notifications for all add-ins. Setting the value to 0x0 uses the default behavior of Outlook.</span></span>

