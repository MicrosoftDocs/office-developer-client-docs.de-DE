---
title: Anmelden bei MAPI
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 05bafe43-a78a-4659-92f0-0b4fe444c64f
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: cce43301ac73a5646e263b2ab92700e57804637d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33419709"
---
# <a name="logging-on-to-mapi"></a><span data-ttu-id="18f46-103">Anmelden bei MAPI</span><span class="sxs-lookup"><span data-stu-id="18f46-103">Logging on to MAPI</span></span>
 
<span data-ttu-id="18f46-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="18f46-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="18f46-105">Clientanwendungen melden sich beim MAPI-Subsystem an, indem sie die **MAPILogonEx-Funktion** aufrufen.</span><span class="sxs-lookup"><span data-stu-id="18f46-105">Client applications log on to the MAPI subsystem by calling the **MAPILogonEx** function.</span></span> <span data-ttu-id="18f46-106">Weitere Informationen finden Sie unter [MAPILogonEx](mapilogonex.md).</span><span class="sxs-lookup"><span data-stu-id="18f46-106">For more information, see [MAPILogonEx](mapilogonex.md).</span></span> <span data-ttu-id="18f46-107">**MAPILogonEx** überprüft die Profilauswahl und die Konfiguration der einzelnen Dienstanbieter im Profil.</span><span class="sxs-lookup"><span data-stu-id="18f46-107">**MAPILogonEx** validates the profile selection and the configuration of each service provider in the profile.</span></span> <span data-ttu-id="18f46-108">Nach der Konfiguration startet MAPI die Adressbuchanbieter, bevor die Nachrichtenspeicheranbieter gestartet werden.</span><span class="sxs-lookup"><span data-stu-id="18f46-108">Once configured, MAPI starts the address book providers before starting the message store providers.</span></span> <span data-ttu-id="18f46-109">Transportanbieter werden gestartet, wenn ihre Dienste zum ersten Mal benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="18f46-109">Transport providers are started when their services are first required.</span></span> 
  
## <a name="choose-a-profile"></a><span data-ttu-id="18f46-110">Auswählen eines Profils</span><span class="sxs-lookup"><span data-stu-id="18f46-110">Choose a profile</span></span>
  
- <span data-ttu-id="18f46-111">Übergeben Sie eine Zeichenzeichenfolge, die den Namen des Profils im  _lpszProfileName-Parameter_ an **MAPILogonEx** darstellt, oder...</span><span class="sxs-lookup"><span data-stu-id="18f46-111">Pass in a character string that represents the name of the profile in the  _lpszProfileName_ parameter to **MAPILogonEx**, or...</span></span>
    
- <span data-ttu-id="18f46-112">Zulassen, dass der Benutzer das Profil durch Übergeben von NULL im  _lpszProfileName-Parameter_ und Festlegen des MAPI_LOGON_UI oder...</span><span class="sxs-lookup"><span data-stu-id="18f46-112">Allow the user to specify the profile by passing NULL in the  _lpszProfileName_ parameter and setting the MAPI_LOGON_UI flag, or...</span></span> 

- <span data-ttu-id="18f46-113">Wählen Sie das Standardprofil aus, indem Sie NULL im  _lpszProfileName-Parameter_ übergeben und MAPI_USE_DEFAULT festlegen.</span><span class="sxs-lookup"><span data-stu-id="18f46-113">Select the default profile by passing NULL in the  _lpszProfileName_ parameter and setting the MAPI_USE_DEFAULT flag.</span></span> 
    
<span data-ttu-id="18f46-114">Wenn Sie ein anderes profil als das Standardprofil benötigen, müssen Sie den Namen in Ihrer eigenen Konfigurationsdatenbank speichern oder eine bestimmte Benennungskonvention verwenden.</span><span class="sxs-lookup"><span data-stu-id="18f46-114">If you require a specific profile other than the default profile, you must save its name in your own configuration database or use a specific naming convention.</span></span> <span data-ttu-id="18f46-115">MAPI macht keine anderen Profilattribute als den Namen und das Standardflag in der Profiltabelle verfügbar, und das Standardprofilflag ist für Messagingclients und verwandte IPM-Anwendungen reserviert.</span><span class="sxs-lookup"><span data-stu-id="18f46-115">MAPI does not expose any profile attributes other than the name and default flag in the profile table, and the default profile flag is reserved for messaging client and related IPM applications.</span></span>
  
<span data-ttu-id="18f46-116">Clients, die **MAPILogonEx** Teilprofil- oder Anbieterkonfigurationsinformationen zur Verfügung stellen, müssen den Benutzer zur Eingabe zusätzlicher Daten aufgefordert, indem sie die Anzeige eines Dialogfelds zulassen.</span><span class="sxs-lookup"><span data-stu-id="18f46-116">Clients that supply partial profile or provider configuration information to **MAPILogonEx** must prompt the user for the additional data by allowing a dialog box to be displayed.</span></span> <span data-ttu-id="18f46-117">Wenn Informationen fehlen und **MAPILogonEx** den Benutzer nicht zur Eingabe anforderen kann, schlägt die Anmeldung fehl.</span><span class="sxs-lookup"><span data-stu-id="18f46-117">If information is missing and **MAPILogonEx** cannot prompt the user to supply it, the logon fails.</span></span> <span data-ttu-id="18f46-118">Clients, die keine Benutzereingabe benötigen, können die Anzeige des Dialogfelds unterdrücken.</span><span class="sxs-lookup"><span data-stu-id="18f46-118">Clients that do not need user input can suppress the dialog box display.</span></span> 
  
<span data-ttu-id="18f46-119">Die Flags, die **MAPILogonEx** zum Aktivieren einer Benutzeroberfläche verwendet, schließen sich gegenseitig aus. es kann nur eins festgelegt werden.</span><span class="sxs-lookup"><span data-stu-id="18f46-119">The flags that **MAPILogonEx** uses to enable a user interface are mutually exclusive; only one can be set.</span></span> <span data-ttu-id="18f46-120">Wenn diese Flags nicht markiert werden, wird die Anzeige einer Benutzeroberfläche unterdrückt, sodass **MAPILogonEx** fehlschlagen kann, wenn erforderliche Informationen fehlen.</span><span class="sxs-lookup"><span data-stu-id="18f46-120">Leaving these flags unset suppresses the display of a user interface, causing **MAPILogonEx** to fail if necessary information is missing.</span></span> <span data-ttu-id="18f46-121">Wenn Sie also die Benutzeroberfläche deaktivieren und NULL für den  _lpszProfileName-Parameter_ übergeben und das MAPI_USE_DEFAULT-Flag nicht festlegen, kann **MAPILogonEx** keinen Profilnamen abrufen.</span><span class="sxs-lookup"><span data-stu-id="18f46-121">That is, if you disable the user interface and pass NULL for the  _lpszProfileName_ parameter and do not set the MAPI_USE_DEFAULT flag, **MAPILogonEx** will fail because it cannot retrieve a profile name.</span></span> 
  
<span data-ttu-id="18f46-122">Die von **MAPILogonEx** einrichtende Sitzung kann eine einzelne Messagingsitzung, eine freigegebene Messagingsitzung oder eine Nichtmessagingsitzung sein.</span><span class="sxs-lookup"><span data-stu-id="18f46-122">The session that **MAPILogonEx** establishes can be an individual messaging session, a shared messaging session, or a nonmessaging session.</span></span> <span data-ttu-id="18f46-123">Einzelne Messagingsitzungen sind private Verbindungen zwischen Ihrem Client und dem MAPI-Subsystem und können durch Festlegen des MAPI_NEW_SESSION im Aufruf von **MAPILogonEx eingerichtet werden.**</span><span class="sxs-lookup"><span data-stu-id="18f46-123">Individual messaging sessions are private connections between your client and the MAPI subsystem and can be established by setting the MAPI_NEW_SESSION flag in the call to **MAPILogonEx**.</span></span>
  
<span data-ttu-id="18f46-124">Freigegebene Messagingsitzungen sind Verbindungen, die von mehreren Messagingclients verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="18f46-124">Shared messaging sessions are connections that multiple messaging clients can use.</span></span> <span data-ttu-id="18f46-125">Freigegebene Sitzungen werden in der Regel für Clients eingerichtet, die dasselbe Profil verwenden.</span><span class="sxs-lookup"><span data-stu-id="18f46-125">Shared sessions are typically established for clients use the same profile.</span></span> <span data-ttu-id="18f46-126">Um eine neue Sitzung als freigegebene Sitzung zu erstellen, legen Sie das MAPI_ALLOW_OTHERS fest.</span><span class="sxs-lookup"><span data-stu-id="18f46-126">To establish a new session as a shared session, set the MAPI_ALLOW_OTHERS flag.</span></span> 
  
## <a name="use-an-existing-shared-session"></a><span data-ttu-id="18f46-127">Verwenden einer vorhandenen freigegebenen Sitzung</span><span class="sxs-lookup"><span data-stu-id="18f46-127">Use an existing shared session</span></span>
  
- <span data-ttu-id="18f46-128">Legen Sie das Flag MAPI_NEW_SESSION.</span><span class="sxs-lookup"><span data-stu-id="18f46-128">Do not set the MAPI_NEW_SESSION flag.</span></span>
    
- <span data-ttu-id="18f46-129">Legen Sie das Flag MAPI_ALLOW_OTHERS.</span><span class="sxs-lookup"><span data-stu-id="18f46-129">Do not set the MAPI_ALLOW_OTHERS flag.</span></span>
    
- <span data-ttu-id="18f46-130">Übergeben Sie NULL für den _lpszProfileName-Parameter._</span><span class="sxs-lookup"><span data-stu-id="18f46-130">Pass NULL for the  _lpszProfileName_ parameter.</span></span> 
    
- <span data-ttu-id="18f46-131">Übergeben Sie NULL für den _lpszPassword-Parameter._</span><span class="sxs-lookup"><span data-stu-id="18f46-131">Pass NULL for the  _lpszPassword_ parameter.</span></span> 
    
<span data-ttu-id="18f46-132">Nichtmessing-Sitzungen ermöglichen Clients den Zugriff auf das MAPI-Subsystem, aber nicht das Senden oder Empfangen von Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="18f46-132">Nonmessaging sessions allow clients to access the MAPI subsystem, but do not allow messages to be sent or received.</span></span> <span data-ttu-id="18f46-133">Konfigurations- oder Verwaltungsanwendungen sind Beispiele für Clients, die möglicherweise Nichtmessagingsitzungen einrichten müssen.</span><span class="sxs-lookup"><span data-stu-id="18f46-133">Configuration or administration applications are examples of clients that might need to establish nonmessaging sessions.</span></span> <span data-ttu-id="18f46-134">Legen Sie zum Anfordern einer Nichtmessaging-Sitzung das MAPI_NO_MAIL ein.</span><span class="sxs-lookup"><span data-stu-id="18f46-134">To request a nonmessaging session, set the MAPI_NO_MAIL flag.</span></span> <span data-ttu-id="18f46-135">Durch Festlegen dieses Kennzeichens wird der Client protokolliert, ohne den MAPI-Spooler zu informieren.</span><span class="sxs-lookup"><span data-stu-id="18f46-135">Setting this flag logs your client on without informing the MAPI spooler.</span></span> <span data-ttu-id="18f46-136">Clients, die sich bei MAPI mit diesem Flag anmelden, können nicht erwarten, dass sie jemals Lesestatusberichte erhalten.</span><span class="sxs-lookup"><span data-stu-id="18f46-136">Clients that log on to MAPI with this flag cannot expect to ever receive read status reports.</span></span>
  
<span data-ttu-id="18f46-137">Das MAPI_NO_MAIL flag sollte nur festgelegt werden:</span><span class="sxs-lookup"><span data-stu-id="18f46-137">The MAPI_NO_MAIL flag should only be set:</span></span>
  
- <span data-ttu-id="18f46-138">Wenn Ihr Client während der Sitzung keine Nachrichten sendet oder erhält.</span><span class="sxs-lookup"><span data-stu-id="18f46-138">If your client will not send or receive messages during the session.</span></span>
    
- <span data-ttu-id="18f46-139">Wenn Ihr Client die vollständige Kontrolle über den Inhalt des Profils hat und Nachrichten mit eng gekoppelten Nachrichtenspeicher- und Transportanbietern, wie z. B. microsoft Exchange empfangen werden.</span><span class="sxs-lookup"><span data-stu-id="18f46-139">If your client has complete control over the contents of the profile and messages are sent and received using tightly coupled message store and transport providers, such as the Microsoft Exchange providers.</span></span>
    
<span data-ttu-id="18f46-140">Ein Messagingclient kann eine Sitzung für einen nichtmessing-Client freigeben.</span><span class="sxs-lookup"><span data-stu-id="18f46-140">A messaging client can share a session with a nonmessaging client.</span></span> <span data-ttu-id="18f46-141">Die Merkmale eines Mitglieds einer freigegebenen Sitzung werden nicht von den Merkmalen anderer Mitglieder beeinflusst.</span><span class="sxs-lookup"><span data-stu-id="18f46-141">The characteristics of one member of a shared session are not affected by the characteristics of other members.</span></span> <span data-ttu-id="18f46-142">Das heißt, wenn Sie sich mit den festgelegten MAPI_NO_MAIL- und MAPI_ALLOW_OTHERS-Flags anmelden, hat die Anmeldung eines Messagingclients bei Ihrer Sitzung keine Auswirkungen auf den Clientbetrieb und umgekehrt.</span><span class="sxs-lookup"><span data-stu-id="18f46-142">That is, if you log on with the MAPI_NO_MAIL and MAPI_ALLOW_OTHERS flags set, a messaging client logging on to your session has no affect on the operation of your client and vice versa.</span></span> <span data-ttu-id="18f46-143">Der Messagingclient kann weiterhin Nachrichten senden und empfangen, der Client nicht.</span><span class="sxs-lookup"><span data-stu-id="18f46-143">The messaging client will still be able to send and receive messages and your client will not.</span></span>
  
<span data-ttu-id="18f46-144">**MAPILogonEx** definiert einige weitere Flags, die Sie festlegen können:</span><span class="sxs-lookup"><span data-stu-id="18f46-144">**MAPILogonEx** defines a few other flags that you can set:</span></span> 
  
- <span data-ttu-id="18f46-145">MAPI_FORCE_DOWNLOAD gibt an, dass eingehende Nachrichten heruntergeladen werden sollen, bevor **MAPILogonEx zurückgegeben** wird.</span><span class="sxs-lookup"><span data-stu-id="18f46-145">MAPI_FORCE_DOWNLOAD indicates that incoming messages should be downloaded before **MAPILogonEx** returns.</span></span> <span data-ttu-id="18f46-146">Wenn Sie dieses Kennzeichen nicht festlegen, werden Nachrichten zu einem späteren Zeitpunkt im Hintergrund heruntergeladen.</span><span class="sxs-lookup"><span data-stu-id="18f46-146">Not setting this flag causes messages to be downloaded in the background at a later time.</span></span> 
    
- <span data-ttu-id="18f46-147">MAPI_SERVICE_UI_ALWAYS, dass für jeden Nachrichtendienst im Profil ein Konfigurationsdialogfeld angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="18f46-147">MAPI_SERVICE_UI_ALWAYS requests that every message service in the profile display a configuration dialog box.</span></span>
    
- <span data-ttu-id="18f46-148">MAPI_NT_SERVICE gibt an, dass Ihr Client als Dienst Windows ist.</span><span class="sxs-lookup"><span data-stu-id="18f46-148">MAPI_NT_SERVICE indicates that your client is implemented as a Windows service.</span></span> <span data-ttu-id="18f46-149">Dieses Flag muss festgelegt werden, wenn Ihr Client ein Dienst ist.</span><span class="sxs-lookup"><span data-stu-id="18f46-149">This flag must be set if your client is a service.</span></span>
    
<span data-ttu-id="18f46-150">Bei jeder erfolgreichen Anmeldung gibt **MAPILogonEx einen** Zeiger auf eine MAPI-Sitzung zurück.</span><span class="sxs-lookup"><span data-stu-id="18f46-150">With every successful logon, **MAPILogonEx** returns a pointer to a MAPI session.</span></span> <span data-ttu-id="18f46-151">Mit diesem Zeiger können Sie die Methoden der **IMAPISession-Schnittstelle** aufrufen.</span><span class="sxs-lookup"><span data-stu-id="18f46-151">You can use this pointer to call the methods of the **IMAPISession** interface.</span></span> <span data-ttu-id="18f46-152">Weitere Informationen finden Sie unter [IMAPISession : IUnknown](imapisessioniunknown.md).</span><span class="sxs-lookup"><span data-stu-id="18f46-152">For more information, see [IMAPISession : IUnknown](imapisessioniunknown.md).</span></span> <span data-ttu-id="18f46-153">Sitzungszeiger sind unabhängig vom Sitzungstyp für die Clients, die sie empfangen, eindeutig und sind aufgabenübergreifend ungültig.</span><span class="sxs-lookup"><span data-stu-id="18f46-153">Session pointers, regardless of the type of session, are unique to the clients that receive them and are not valid across tasks.</span></span>
  

