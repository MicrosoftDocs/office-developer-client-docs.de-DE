---
title: IXPProviderTransportLogon
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
ms.topic: reference
ms.prod: office-online-server
localization_priority: Normal
api_name:
- IXPProvider.TransportLogon
api_type:
- COM
ms.assetid: 534929f2-36a2-463d-8c4c-d86060cde127
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 53b2733dbf38d680027dc00ecf5513f384e46660
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33417308"
---
# <a name="ixpprovidertransportlogon"></a><span data-ttu-id="66746-103">IXPProvider::TransportLogon</span><span class="sxs-lookup"><span data-stu-id="66746-103">IXPProvider::TransportLogon</span></span>

<span data-ttu-id="66746-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="66746-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="66746-105">Richtet eine Sitzung ein, in der sich eine Clientanwendung bei einem Transportanbieter anmeldet.</span><span class="sxs-lookup"><span data-stu-id="66746-105">Establishes a session in which a client application logs on to a transport provider.</span></span> 
  
```cpp
HRESULT TransportLogon(
  LPMAPISUP lpMAPISup,
  ULONG_PTR ulUIParam,
  LPSTR lpszProfileName,
  ULONG FAR * lpulFlags,
  LPMAPIERROR FAR * lppMAPIError,
  LPXPLOGON FAR * lppXPLogon
);
```

## <a name="parameters"></a><span data-ttu-id="66746-106">Parameter</span><span class="sxs-lookup"><span data-stu-id="66746-106">Parameters</span></span>

<span data-ttu-id="66746-107">_lpMAPISup_: [in] Zeiger auf das Supportobjekt des Transportanbieters für Rückruffunktionen innerhalb von MAPI für diese Sitzung.</span><span class="sxs-lookup"><span data-stu-id="66746-107">_lpMAPISup_: [in] Pointer to the transport provider's support object for callback functions within MAPI for this session.</span></span> <span data-ttu-id="66746-108">Dieses Objekt bleibt gültig, bis es vom Transportanbieter veröffentlicht wird.</span><span class="sxs-lookup"><span data-stu-id="66746-108">This object remains valid until the transport provider releases it.</span></span>
    
<span data-ttu-id="66746-109">_ulUIParam_: [in] Handle to the parent window of any dialog boxes or windows this method displays.</span><span class="sxs-lookup"><span data-stu-id="66746-109">_ulUIParam_: [in] Handle to the parent window of any dialog boxes or windows this method displays.</span></span> <span data-ttu-id="66746-110">Der  _ulUIParam-Parameter_ kann nicht null sein, z. B. wenn das LOGON_SETUP im  _lpulFlags-Parameter festgelegt_ ist.</span><span class="sxs-lookup"><span data-stu-id="66746-110">The  _ulUIParam_ parameter can be non-null, for example when the LOGON_SETUP flag is set in the  _lpulFlags_ parameter.</span></span> 
    
<span data-ttu-id="66746-111">_lpszProfileName_: [in] Zeiger auf den Profilnamen des Benutzers.</span><span class="sxs-lookup"><span data-stu-id="66746-111">_lpszProfileName_: [in] Pointer to the profile name of the user.</span></span> <span data-ttu-id="66746-112">Der  _lpszProfileName-Parameter_ wird hauptsächlich verwendet, wenn ein Dialogfeld angezeigt werden muss.</span><span class="sxs-lookup"><span data-stu-id="66746-112">The  _lpszProfileName_ parameter is primarily used when a dialog box must be presented.</span></span> 
    
<span data-ttu-id="66746-113">_lpulFlags_: [in, out] Bitmaske von Flags, die steuert, wie die Anmeldesitzung eingerichtet wird.</span><span class="sxs-lookup"><span data-stu-id="66746-113">_lpulFlags_: [in, out] Bitmask of flags that controls how the logon session is established.</span></span> <span data-ttu-id="66746-114">Die folgenden Flags können für die Eingabe durch den MAPI-Spooler festgelegt werden:</span><span class="sxs-lookup"><span data-stu-id="66746-114">The following flags can be set on input by the MAPI spooler:</span></span>
    
  - <span data-ttu-id="66746-115">LOGON_NO_CONNECT: Das Benutzerkonto hat sich bei diesem Transportanbieter für andere Zwecke als die Übertragung und den Empfang von Nachrichten anmelden.</span><span class="sxs-lookup"><span data-stu-id="66746-115">LOGON_NO_CONNECT: The user account is logging on to this transport provider for purposes other than transmission and reception of messages.</span></span> <span data-ttu-id="66746-116">Der Transportanbieter sollte nicht versuchen, Verbindungen mit anderen Messagingsystemen herzustellen.</span><span class="sxs-lookup"><span data-stu-id="66746-116">The transport provider should not attempt to make any connections to other messaging systems.</span></span>
        
  - <span data-ttu-id="66746-117">LOGON_NO_DIALOG: Es sollte kein Dialogfeld angezeigt werden, auch wenn die aktuell gespeicherten Benutzeranmeldeinformationen ungültig oder für die Anmeldung nicht ausreichend sind.</span><span class="sxs-lookup"><span data-stu-id="66746-117">LOGON_NO_DIALOG: No dialog box should be displayed even if the currently saved user credentials are invalid or insufficient for logon.</span></span>
        
  - <span data-ttu-id="66746-118">LOGON_NO_INBOUND: Der Transportanbieter muss nicht für den Empfang von Nachrichten initialisieren und sollte keine eingehenden Nachrichten akzeptieren.</span><span class="sxs-lookup"><span data-stu-id="66746-118">LOGON_NO_INBOUND: The transport provider does not have to initialize for reception of messages and should not accept incoming messages.</span></span> <span data-ttu-id="66746-119">Der MAPI-Spooler kann später die [IXPLogon::TransportNotify-Methode](ixplogon-transportnotify.md) verwenden, um den Transportanbieter zu signalisieren, die Verarbeitung eingehender Nachrichten zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="66746-119">The MAPI spooler can use the [IXPLogon::TransportNotify](ixplogon-transportnotify.md) method later to signal the transport provider to enable incoming message processing.</span></span> 
        
  - <span data-ttu-id="66746-120">LOGON_NO_OUTBOUND: Der Transportanbieter muss nicht für das Senden von Nachrichten initialisieren, da der MAPI-Spooler keine zur Verfügung stellt.</span><span class="sxs-lookup"><span data-stu-id="66746-120">LOGON_NO_OUTBOUND: The transport provider does not have to initialize for sending messages, as the MAPI spooler does not provide any.</span></span> <span data-ttu-id="66746-121">Wenn eine Clientanwendung während der Komposition einer Nachricht eine Verbindung mit einem Remoteanbieter benötigt, damit sie [IXPLogon::AddressTypes-Methodenaufrufe](ixplogon-addresstypes.md) erstellen kann, sollte der Transportanbieter die Verbindung herstellen.</span><span class="sxs-lookup"><span data-stu-id="66746-121">If a client application requires a connection to a remote provider during the composition of a message so that it can make [IXPLogon::AddressTypes](ixplogon-addresstypes.md) method calls, the transport provider should make the connection.</span></span> <span data-ttu-id="66746-122">Der MAPI-Spooler kann **TransportNotify** verwenden, um den Transportanbieter zu signalisieren, wenn ausgehende Vorgänge beginnen können.</span><span class="sxs-lookup"><span data-stu-id="66746-122">The MAPI spooler can use **TransportNotify** to signal the transport provider when outgoing operations can begin.</span></span> 
      
  - <span data-ttu-id="66746-123">MAPI_UNICODE: Die übergebene Zeichenfolge für den Profilnamen ist im Unicode-Format.</span><span class="sxs-lookup"><span data-stu-id="66746-123">MAPI_UNICODE: The passed-in string for the profile name is in Unicode format.</span></span> <span data-ttu-id="66746-124">Wenn das \_ MAPI-UNICODE-Flag nicht festgelegt ist, hat die Zeichenfolge das ANSI-Format.</span><span class="sxs-lookup"><span data-stu-id="66746-124">If the MAPI\_UNICODE flag is not set, the string is in ANSI format.</span></span>
      
    <span data-ttu-id="66746-125">Die folgenden Flags können für die Ausgabe durch den Transportanbieter festgelegt werden:</span><span class="sxs-lookup"><span data-stu-id="66746-125">The following flags can be set on output by the transport provider:</span></span>
      
  - <span data-ttu-id="66746-126">LOGON_SP_IDLE: Fordert an, dass der MAPI-Spooler häufig die [IXPLogon::Idle-Methode](ixplogon-idle.md) des Transportanbieters für die Leerlaufzeitverarbeitung aufruft.</span><span class="sxs-lookup"><span data-stu-id="66746-126">LOGON_SP_IDLE: Requests that the MAPI spooler frequently call the transport provider's [IXPLogon::Idle](ixplogon-idle.md) method for idle-time processing.</span></span> 
      
  - <span data-ttu-id="66746-127">LOGON_SP_POLL: Fordert an, dass der MAPI-Spooler häufig die [IXPLogon::P oll-Methode](ixplogon-poll.md) für das zurückgegebene Anmeldeobjekt aufruft, um nach neuen Nachrichten zu suchen.</span><span class="sxs-lookup"><span data-stu-id="66746-127">LOGON_SP_POLL: Requests that the MAPI spooler frequently call the [IXPLogon::Poll](ixplogon-poll.md) method on the returned logon object to check for new messages.</span></span> <span data-ttu-id="66746-128">Wenn dieses Flag nicht festgelegt ist, überprüft der MAPI-Spooler nur auf neue Nachrichten, wenn der Transportanbieter die [IMAPISupport::SpoolerNotify-Methode](imapisupport-spoolernotify.md) verwendet, um den Spooler zu benachrichtigen, dass neue Nachrichten zu verarbeiten sind.</span><span class="sxs-lookup"><span data-stu-id="66746-128">If this flag is not set, the MAPI spooler only checks for new messages when the transport provider uses the [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) method to notify the spooler that there are new messages to process.</span></span> <span data-ttu-id="66746-129">Ein Transportanbieter wird tatsächlich nur gesendet, indem er dieses Flag nicht festlegen und den MAPI-Spooler nicht über den Nachrichteneingang informiert.</span><span class="sxs-lookup"><span data-stu-id="66746-129">A transport provider effectively becomes send-only by not setting this flag and by not notifying the MAPI spooler of message receipt.</span></span> 
      
  - <span data-ttu-id="66746-130">LOGON_SP_RESOLVE: Fordert an, dass der MAPI-Spooler alle Nachrichtenadressen für Empfänger, die von diesem Transportanbieter nicht unterstützt werden, vollständig adressiert.</span><span class="sxs-lookup"><span data-stu-id="66746-130">LOGON_SP_RESOLVE: Requests that the MAPI spooler resolve to full addresses all message addresses for recipients not supported by this transport provider.</span></span> <span data-ttu-id="66746-131">Daher kann der Transportanbieter einen Antwortpfad für alle Empfänger erstellen.</span><span class="sxs-lookup"><span data-stu-id="66746-131">Therefore that the transport provider can construct a reply path for all recipients.</span></span>
      
  - <span data-ttu-id="66746-132">MAPI_UNICODE: Die zurückgegebenen Zeichenfolgen in der [MAPIERROR-Struktur](mapierror.md) sind im Unicode-Format.</span><span class="sxs-lookup"><span data-stu-id="66746-132">MAPI_UNICODE: The returned strings in the [MAPIERROR](mapierror.md) structure, if any, are in Unicode format.</span></span> <span data-ttu-id="66746-133">Wenn das MAPI_UNICODE nicht festgelegt ist, befinden sich die Zeichenfolgen im ANSI-Format.</span><span class="sxs-lookup"><span data-stu-id="66746-133">If the MAPI_UNICODE flag is not set, the strings are in ANSI format.</span></span> 
    
<span data-ttu-id="66746-134">_lppMAPIError_: [out] Zeiger auf einen Zeiger auf die zurückgegebene **MAPIERROR-Struktur,** sofern erforderlich, die Versions-, Komponenten- und Kontextinformationen für den Fehler enthält.</span><span class="sxs-lookup"><span data-stu-id="66746-134">_lppMAPIError_: [out] Pointer to a pointer to the returned **MAPIERROR** structure, if any, that contains version, component, and context information for the error.</span></span> <span data-ttu-id="66746-135">Der  _Parameter lppMAPIError_ kann auf NULL festgelegt werden, wenn keine **MAPIERROR-Struktur** zurückgegeben werden soll.</span><span class="sxs-lookup"><span data-stu-id="66746-135">The  _lppMAPIError_ parameter can be set to NULL if there is no **MAPIERROR** structure to return.</span></span> 
    
<span data-ttu-id="66746-136">_lppXPLogon_: [out] Zeiger auf den Zeiger auf das zurückgegebene Anmeldeobjekt des Transportanbieters.</span><span class="sxs-lookup"><span data-stu-id="66746-136">_lppXPLogon_: [out] Pointer to the pointer to the returned transport provider logon object.</span></span>
    
## <a name="return-value"></a><span data-ttu-id="66746-137">Rückgabewert</span><span class="sxs-lookup"><span data-stu-id="66746-137">Return value</span></span>

<span data-ttu-id="66746-138">S_OK: Der Aufruf ist erfolgreich und hat den erwarteten Wert oder die erwarteten Werte zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="66746-138">S_OK: The call succeeded and has returned the expected value or values.</span></span>
    
<span data-ttu-id="66746-139">MAPI_E_FAILONEPROVIDER: Dieser Anbieter kann sich nicht anmelden, aber dieser Fehler sollte den Dienst nicht deaktivieren.</span><span class="sxs-lookup"><span data-stu-id="66746-139">MAPI_E_FAILONEPROVIDER: This provider cannot log on, but this error should not disable the service.</span></span> 
    
<span data-ttu-id="66746-140">MAPI_E_UNCONFIGURED: Das Profil enthält nicht genügend Informationen, damit die Anmeldung abgeschlossen werden kann.</span><span class="sxs-lookup"><span data-stu-id="66746-140">MAPI_E_UNCONFIGURED: The profile does not contain enough information for the logon to be completed.</span></span> <span data-ttu-id="66746-141">MAPI ruft die Nachrichtendienst-Einstiegspunktfunktion des Anbieters auf.</span><span class="sxs-lookup"><span data-stu-id="66746-141">MAPI calls the provider's message service entry point function.</span></span>
    
<span data-ttu-id="66746-142">MAPI_E_UNKNOWN_CPID: Der Anbieter kann die Codeseite des Clients nicht unterstützen.</span><span class="sxs-lookup"><span data-stu-id="66746-142">MAPI_E_UNKNOWN_CPID: The provider cannot support the client's code page.</span></span>
    
<span data-ttu-id="66746-143">MAPI_E_UNKNOWN_LCID: Der Anbieter kann die Locale-Informationen des Clients nicht unterstützen.</span><span class="sxs-lookup"><span data-stu-id="66746-143">MAPI_E_UNKNOWN_LCID: The provider cannot support the client's locale information.</span></span>
    
<span data-ttu-id="66746-144">MAPI_E_USER_CANCEL: Der Benutzer hat den Vorgang abgebrochen, in der Regel durch Klicken auf die **Schaltfläche** Abbrechen in einem Dialogfeld.</span><span class="sxs-lookup"><span data-stu-id="66746-144">MAPI_E_USER_CANCEL: The user canceled the operation, typically by clicking the **Cancel** button in a dialog box.</span></span> 
    
## <a name="remarks"></a><span data-ttu-id="66746-145">Hinweise</span><span class="sxs-lookup"><span data-stu-id="66746-145">Remarks</span></span>

<span data-ttu-id="66746-146">Der MAPI-Spooler ruft die **IXPProvider::TransportLogon-Methode auf,** um eine Anmeldesitzung für einen Benutzer zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="66746-146">The MAPI spooler calls the **IXPProvider::TransportLogon** method to establish a logon session for a user.</span></span> 
  
<span data-ttu-id="66746-147">Die meisten Transportanbieter verwenden die [IMAPISupport::OpenProfileSection-Methode,](imapisupport-openprofilesection.md) die mit dem Supportobjekt bereitgestellt wird, auf das der  _lpMAPISup-Parameter_ verweist, zum Speichern und Abrufen von Benutzeridentitätsinformationen, Serveradressen und Anmeldeinformationen.</span><span class="sxs-lookup"><span data-stu-id="66746-147">Most transport providers use the [IMAPISupport::OpenProfileSection](imapisupport-openprofilesection.md) method provided with the support object pointed to by the  _lpMAPISup_ parameter for saving and retrieving user identity information, server addresses, and credentials.</span></span> <span data-ttu-id="66746-148">Mithilfe von **OpenProfileSection** kann ein Transportanbieter beliebige Informationen speichern und einer bestimmten Ressource einer Anmeldung zuordnen.</span><span class="sxs-lookup"><span data-stu-id="66746-148">By using **OpenProfileSection**, a transport provider can save arbitrary information and associate it with a logon to a particular resource.</span></span> <span data-ttu-id="66746-149">Beispielsweise kann ein Anbieter **OpenProfileSection** verwenden, um den Kontonamen und das Kennwort zu speichern, die einer bestimmten Sitzung zugeordnet sind, sowie alle Servernamen oder andere erforderliche Informationen, die für den Zugriff auf Ressourcen für diese Sitzung erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="66746-149">For example, a provider can use **OpenProfileSection** to save the account name and password associated with a particular session and any server names or other necessary information that are required to access resources for that session.</span></span> <span data-ttu-id="66746-150">MAPI blendet Informationen, die einer Ressource zugeordnet sind, vor dem Zugriff außerhalb des Zugriffs aus.</span><span class="sxs-lookup"><span data-stu-id="66746-150">MAPI hides information associated with a resource from outside access.</span></span> <span data-ttu-id="66746-151">Der über  _lpMAPISup_ zur Verfügung stellende Profilabschnitt wird vom MAPI-Spooler verwaltet, sodass daten im Zusammenhang mit diesem Benutzerkontext von Daten für andere Kontexte getrennt werden.</span><span class="sxs-lookup"><span data-stu-id="66746-151">The profile section made available through  _lpMAPISup_ is managed by the MAPI spooler so data related to this user context is separated from data for other contexts.</span></span> 
  
<span data-ttu-id="66746-152">Der Transportanbieter muss die **IUnknown::AddRef-Methode** für das Supportobjekt aufrufen und eine Kopie des Zeigers auf dieses Objekt als Teil des Anbieteranmeldeobjekts behalten.</span><span class="sxs-lookup"><span data-stu-id="66746-152">The transport provider must call the **IUnknown::AddRef** method on the support object and keep a copy of the pointer to this object as part of the provider logon object.</span></span> 
  
<span data-ttu-id="66746-153">Der Profilanzeigename in  _lpszProfileName_ wird bereitgestellt, damit der Transportanbieter ihn in Fehlermeldungen oder Anmeldedialogfeldern verwenden kann.</span><span class="sxs-lookup"><span data-stu-id="66746-153">The profile display name in  _lpszProfileName_ is provided so the transport provider can use it in error messages or logon dialog boxes.</span></span> <span data-ttu-id="66746-154">Wenn der Anbieter diesen Namen behält, muss er in den vom Anbieter zugewiesenen Speicher kopiert werden.</span><span class="sxs-lookup"><span data-stu-id="66746-154">If the provider retains this name, it must be copied to storage allocated by the provider.</span></span> 
  
<span data-ttu-id="66746-155">Transportanbieter, die eng mit anderen Dienstanbietern gekoppelt sind, müssen bei der Anmeldung möglicherweise zusätzliche Arbeit tun, um die guten Anmeldeinformationen zu erstellen, die für Vorgänge zwischen Begleitanbietern erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="66746-155">Transport providers that are tightly coupled with other service providers may have to do additional work at logon to establish the good credentials required for operations between companion providers.</span></span>
  
<span data-ttu-id="66746-156">In der Regel werden Transportanbieter geöffnet, wenn sich der Benutzer zum ersten Mal bei einem Profil anmeldet.</span><span class="sxs-lookup"><span data-stu-id="66746-156">Usually, transport providers are opened when the user first logs on to a profile.</span></span> <span data-ttu-id="66746-157">Da die erste Anmeldung bei einem Profil daher in der Regel vor der Anmeldung bei einem Beliebigen Nachrichtenspeicher erfolgt, ruft der MAPI-Spooler **transportLogon** in der Regel mit den in  _lpulFlags_ festgelegten LOGON_NO_INBOUND- und LOGON_NO_OUTBOUND-Flags auf.</span><span class="sxs-lookup"><span data-stu-id="66746-157">Because the first logon to a profile therefore generally comes before logon to any message store, the MAPI spooler usually calls **TransportLogon** with both the LOGON_NO_INBOUND and LOGON_NO_OUTBOUND flags set in  _lpulFlags_.</span></span> <span data-ttu-id="66746-158">Wenn später die entsprechenden Nachrichtenspeicher in der Profilsitzung verfügbar sind, ruft der MAPI-Spooler **TransportNotify** auf, um eingehende und ausgehende Vorgänge für den Transportanbieter zu initiieren.</span><span class="sxs-lookup"><span data-stu-id="66746-158">Later, when the appropriate message stores are available in the profile session, the MAPI spooler calls **TransportNotify** to initiate incoming and outgoing operations for the transport provider.</span></span> 
  
<span data-ttu-id="66746-159">Das Übergeben LOGON_NO_CONNECT in  _lpulFlags_ signalisiert den Offlinebetrieb des Transportanbieters.</span><span class="sxs-lookup"><span data-stu-id="66746-159">Passing the LOGON_NO_CONNECT flag in  _lpulFlags_ signals offline operation of the transport provider.</span></span> <span data-ttu-id="66746-160">Dieses Flag gibt an, dass keine externen Verbindungen hergestellt werden sollen. Wenn der Transportanbieter keine Sitzung ohne externe Verbindung einrichten kann, sollte er einen Fehlerwert für die Anmeldung zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="66746-160">This flag indicates no external connections should be made; if the transport provider cannot establish a session without an external connection, it should return an error value for the logon.</span></span> 
  
<span data-ttu-id="66746-161">Ein Transportanbieter sollte das LOGON_SP_IDLE in  _lpulFlags_ zur Initialisierungszeit festlegen, wenn es für die Verwendung von Zeit konzipiert ist, die das System ansonsten im Leerlauf verbringt.</span><span class="sxs-lookup"><span data-stu-id="66746-161">A transport provider should set the LOGON_SP_IDLE flag in  _lpulFlags_ at initialization time if it is designed to use time that the system otherwise spends idle.</span></span> <span data-ttu-id="66746-162">Diese Zeit wird häufig zum Verarbeiten automatischer Vorgänge verwendet, z. B. zum automatischen Herunterladen von Nachrichten, zum Herunterladen von Zeitnachrichten oder zum Senden von Zeitnachrichten.</span><span class="sxs-lookup"><span data-stu-id="66746-162">Such time is often used to handle automatic operations, such as automatic message downloading, timed message downloading, or timed message submission.</span></span> <span data-ttu-id="66746-163">Wenn dieses Flag festgelegt ist, ruft der MAPI-Spooler **Idle** auf, wenn die Systemlaufzeit zum Initiieren solcher Vorgänge auftritt.</span><span class="sxs-lookup"><span data-stu-id="66746-163">If this flag is set, the MAPI spooler calls **Idle** when system idle time occurs to initiate such operations.</span></span> <span data-ttu-id="66746-164">Der #A0 aufruft **idle** nicht in festgelegten Intervallen. stattdessen wird sie nur während der echten Leerlaufzeit aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="66746-164">The MAPI spooler does not call **Idle** at set intervals; rather, it is called only during true idle time.</span></span> <span data-ttu-id="66746-165">Daher sollten Anbieter nicht davon ausgehen, wie häufig ihre **Idle-Methoden** aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="66746-165">Therefore, providers should not work on any assumption about how frequently their **Idle** methods will be called.</span></span> <span data-ttu-id="66746-166">Anbieter, die Leerlaufzeitvorgänge unterstützen, sollten eine Konfigurationsbenutzeroberfläche dafür im Eigenschaftenblatt des Anbieters zur Verfügung stehen.</span><span class="sxs-lookup"><span data-stu-id="66746-166">Providers that support idle-time operations should supply a configuration user interface for it in their provider property sheet.</span></span> 
  
<span data-ttu-id="66746-167">Wenn die Anmeldung des Transportanbieters erfolgreich ist, sollte der Anbieter im  _lppXPLogon-Parameter_ einen Zeiger auf ein Anmeldeobjekt zurückgeben.</span><span class="sxs-lookup"><span data-stu-id="66746-167">If the transport provider logon succeeds, the provider should return in the  _lppXPLogon_ parameter a pointer to a logon object.</span></span> <span data-ttu-id="66746-168">Der MAPI-Spooler verwendet dieses Objekt für zusätzlichen Anbieterzugriff.</span><span class="sxs-lookup"><span data-stu-id="66746-168">The MAPI spooler will use this object for additional provider access.</span></span> <span data-ttu-id="66746-169">Wenn **TransportLogon** ein Anmeldedialogfeld anzeigt und der Benutzer die  Anmeldung in der Regel abbricht, indem er im Dialogfeld auf die Schaltfläche Abbrechen klickt, sollte der Anbieter MAPI_E_USER_CANCEL.</span><span class="sxs-lookup"><span data-stu-id="66746-169">If **TransportLogon** displays a logon dialog box and the user cancels logon typically by clicking the **Cancel** button in the dialog box the provider should return MAPI_E_USER_CANCEL.</span></span> 
  
<span data-ttu-id="66746-170">Bei den meisten von **TransportLogon** zurückgegebenen Fehlerwerten deaktiviert MAPI die Nachrichtendienste, zu denen der Anbieter gehört.</span><span class="sxs-lookup"><span data-stu-id="66746-170">For most error values returned from **TransportLogon**, MAPI disables the message services to which the provider belongs.</span></span> <span data-ttu-id="66746-171">MAPI wird für die restliche MAPI-Sitzung keine Anbieter aufrufen, die zu diesem Dienst gehören.</span><span class="sxs-lookup"><span data-stu-id="66746-171">MAPI will not call any providers that belong to that service for the rest of the MAPI session.</span></span> <span data-ttu-id="66746-172">Wenn **TransportLogon** hingegen den MAPI_E_FAILONEPROVIDER der Anmeldung zurückgibt, deaktiviert MAPI nicht den Nachrichtendienst, zu dem der Anbieter gehört.</span><span class="sxs-lookup"><span data-stu-id="66746-172">In contrast, when **TransportLogon** returns the MAPI_E_FAILONEPROVIDER error value from its logon, MAPI does not disable the message service to which the provider belongs.</span></span> <span data-ttu-id="66746-173">**TransportLogon** sollte MAPI_E_FAILONEPROVIDER, wenn ein Fehler auftritt, der keine Deaktivierung des Diensts für den Rest der Sitzung rechtfertigen würde.</span><span class="sxs-lookup"><span data-stu-id="66746-173">**TransportLogon** should return MAPI_E_FAILONEPROVIDER if it encounters an error that does not warrant disabling the service for the rest of the session.</span></span> 
  
<span data-ttu-id="66746-174">Wenn ein Anbieter MAPI_E_UNCONFIGURED der Anmeldung zurückgibt, wird die Nachrichtendiensteintragsfunktion des Anbieters von MAPI aufruft und dann die Anmeldung erneut wiederholen.</span><span class="sxs-lookup"><span data-stu-id="66746-174">If a provider returns MAPI_E_UNCONFIGURED from its logon, MAPI will call the provider's message service entry function and then retry the logon.</span></span> <span data-ttu-id="66746-175">MAPI übergibt MSG_SERVICE_CONFIGURE als Kontext, um dem Dienst die Möglichkeit zu geben, sich selbst zu konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="66746-175">MAPI passes MSG_SERVICE_CONFIGURE as the context, to give the service a chance to configure itself.</span></span> <span data-ttu-id="66746-176">Wenn der Client eine Benutzeroberfläche für die Anmeldung zulassen hat, kann der Dienst sein Konfigurationseigenschaftsblatt präsentieren, damit der Benutzer Konfigurationsinformationen eingeben kann.</span><span class="sxs-lookup"><span data-stu-id="66746-176">If the client has chosen to allow a user interface on the logon, the service can present its configuration property sheet so that the user can enter configuration information.</span></span> 
  
<span data-ttu-id="66746-177">Wenn der Anbieter findet, dass nicht alle erforderlichen Informationen im Profil enthalten sind, sollte er MAPI_E_UNCONFIGURED zurück, damit MAPI die Einstiegspunktfunktion des Anbieters aufruft.</span><span class="sxs-lookup"><span data-stu-id="66746-177">If the provider finds that all the required information is not in the profile, it should return MAPI_E_UNCONFIGURED so that MAPI calls the provider's message service entry point function.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="66746-178">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="66746-178">See also</span></span>

- [<span data-ttu-id="66746-179">IXPProvider : IUnknown</span><span class="sxs-lookup"><span data-stu-id="66746-179">IXPProvider : IUnknown</span></span>](ixpprovideriunknown.md)  
- [<span data-ttu-id="66746-180">IMAPISupport::OpenProfileSection</span><span class="sxs-lookup"><span data-stu-id="66746-180">IMAPISupport::OpenProfileSection</span></span>](imapisupport-openprofilesection.md)  
- [<span data-ttu-id="66746-181">IMAPISupport::SpoolerNotify</span><span class="sxs-lookup"><span data-stu-id="66746-181">IMAPISupport::SpoolerNotify</span></span>](imapisupport-spoolernotify.md)  
- [<span data-ttu-id="66746-182">IXPLogon::AddressTypes</span><span class="sxs-lookup"><span data-stu-id="66746-182">IXPLogon::AddressTypes</span></span>](ixplogon-addresstypes.md)  
- [<span data-ttu-id="66746-183">IXPLogon::Idle</span><span class="sxs-lookup"><span data-stu-id="66746-183">IXPLogon::Idle</span></span>](ixplogon-idle.md)  
- [<span data-ttu-id="66746-184">IXPLogon::Poll</span><span class="sxs-lookup"><span data-stu-id="66746-184">IXPLogon::Poll</span></span>](ixplogon-poll.md)  
- [<span data-ttu-id="66746-185">IXPLogon::TransportNotify</span><span class="sxs-lookup"><span data-stu-id="66746-185">IXPLogon::TransportNotify</span></span>](ixplogon-transportnotify.md) 
- [<span data-ttu-id="66746-186">MAPIERROR</span><span class="sxs-lookup"><span data-stu-id="66746-186">MAPIERROR</span></span>](mapierror.md)

