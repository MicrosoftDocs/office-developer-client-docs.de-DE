---
title: Senden oder Empfangen einer Nachricht nach Bedarf
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 479404c5-4926-402a-aa12-75dd23276d75
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 15b9c8c5a56b6f37464d2469bd1d7b3e24596502
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33436370"
---
# <a name="sending-or-receiving-a-message-on-demand"></a><span data-ttu-id="7f972-103">Senden oder Empfangen einer Nachricht nach Bedarf</span><span class="sxs-lookup"><span data-stu-id="7f972-103">Sending or receiving a message on demand</span></span>
  
<span data-ttu-id="7f972-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="7f972-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="7f972-105">Clients verwenden in der Regel das MAPI-Subsystem – den MAPI-Spooler und die Dienstanbieter –, um den Zeitpunkt der Nachrichtenübermittlung und des Empfangs zu verarbeiten.</span><span class="sxs-lookup"><span data-stu-id="7f972-105">Clients typically rely on the MAPI subsystem — the MAPI spooler and the service providers — to handle the timing of message transmission and reception.</span></span> <span data-ttu-id="7f972-106">Sie können diese Zeitplanung jedoch ändern, indem Sie das Statusobjekt des MAPI-Spoolers oder eines Transportanbieters verwenden.</span><span class="sxs-lookup"><span data-stu-id="7f972-106">However, you can alter this timing by using the status object of either the MAPI spooler or a transport provider.</span></span>
  
<span data-ttu-id="7f972-107">Die [IMAPIStatus::FlushQueues-Methode](imapistatus-flushqueues.md) entfernt alle Nachrichten aus den ein- oder ausgehenden Warteschlangen eines oder mehreren Transportanbieters.</span><span class="sxs-lookup"><span data-stu-id="7f972-107">The [IMAPIStatus::FlushQueues](imapistatus-flushqueues.md) method removes all messages from one or more transport provider's incoming or outgoing queues.</span></span> <span data-ttu-id="7f972-108">In den folgenden Verfahren werden zwei Techniken zum Senden oder Empfangen von Nachrichten bei Bedarf beschrieben.</span><span class="sxs-lookup"><span data-stu-id="7f972-108">The following procedures describe two techniques for sending or receiving messages on demand.</span></span> <span data-ttu-id="7f972-109">Bei der ersten Prozedur wird das Statusobjekt des #A0 verwendet, um die Warteschlangen aller Transportanbieter im Profil zu leeren. Beim zweiten Verfahren wird die Warteschlange eines einzelnen Transportanbieters geleert.</span><span class="sxs-lookup"><span data-stu-id="7f972-109">The first procedure uses the MAPI spooler's status object to flush the queues of every transport provider in the profile; the second procedure flushes the queue of a single transport provider.</span></span> 
  
### <a name="to-flush-all-incoming-or-outgoing-queues-in-a-single-operation"></a><span data-ttu-id="7f972-110">So leeren Sie alle eingehenden oder ausgehenden Warteschlangen in einem einzelnen Vorgang</span><span class="sxs-lookup"><span data-stu-id="7f972-110">To flush all incoming or outgoing queues in a single operation</span></span>
  
1. <span data-ttu-id="7f972-111">Rufen [Sie IMAPISession::GetStatusTable auf,](imapisession-getstatustable.md) um auf die Statustabelle zu zugreifen.</span><span class="sxs-lookup"><span data-stu-id="7f972-111">Call [IMAPISession::GetStatusTable](imapisession-getstatustable.md) to access the status table.</span></span> 
    
2. <span data-ttu-id="7f972-112">Rufen Sie die [IMAPITable::SetColumns-Methode](imapitable-setcolumns.md) der Statustabelle auf, um den Spaltensatz auf **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) und **PR_RESOURCE_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md)) zu beschränken.</span><span class="sxs-lookup"><span data-stu-id="7f972-112">Call the status table's [IMAPITable::SetColumns](imapitable-setcolumns.md) method to limit the column set to **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) and **PR_RESOURCE_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md)).</span></span>
    
3. <span data-ttu-id="7f972-113">Erstellen Sie eine Eigenschaftseinschränkung mithilfe einer [SPropertyRestriction-Struktur,](spropertyrestriction.md) um PR_RESOURCE_TYPE **mit** MAPI_SPOOLER.</span><span class="sxs-lookup"><span data-stu-id="7f972-113">Build a property restriction using an [SPropertyRestriction](spropertyrestriction.md) structure to match **PR_RESOURCE_TYPE** with MAPI_SPOOLER.</span></span> 
    
4. <span data-ttu-id="7f972-114">Rufen [Sie HrQueryAllRows auf,](hrqueryallrows.md)und übergeben Sie die **SPropertyRestriction-Struktur,** um die Zeile abzurufen, die den Status des MAPI-Spoolers darstellt.</span><span class="sxs-lookup"><span data-stu-id="7f972-114">Call [HrQueryAllRows](hrqueryallrows.md), passing in the **SPropertyRestriction** structure, to retrieve the row that represents the status of the MAPI spooler.</span></span> 
    
5. <span data-ttu-id="7f972-115">Übergeben Sie **PR_ENTRYID-Spalte** [an IMAPISession::OpenEntry,](imapisession-openentry.md) um das Statusobjekt des MAPI-Spoolers zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="7f972-115">Pass the **PR_ENTRYID** column to [IMAPISession::OpenEntry](imapisession-openentry.md) to open the MAPI spooler's status object.</span></span> 
    
6. <span data-ttu-id="7f972-116">Rufen Sie die [IMAPIStatus::FlushQueues-Methode](imapistatus-flushqueues.md) des MAPI-Spoolers auf, übergeben Sie das FLUSH_NO_UI-Flag, um die Benutzeroberfläche zu unterdrücken, und entweder das flag FLUSH_DOWNLOAD oder FLUSH_UPLOAD, um die ausgehenden oder eingehenden Warteschlangen zu leeren.</span><span class="sxs-lookup"><span data-stu-id="7f972-116">Call the MAPI spooler's [IMAPIStatus::FlushQueues](imapistatus-flushqueues.md) method, passing the FLUSH_NO_UI flag to suppress the user interface and either the FLUSH_DOWNLOAD or FLUSH_UPLOAD flag to flush the outgoing or incoming queues.</span></span> 
    
7. <span data-ttu-id="7f972-117">Geben Sie das Statusobjekt und die Statustabelle sowie die [SRowSet-Struktur](srowset.md) frei, die der Tabelle zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="7f972-117">Release the status object and the status table, as well as the [SRowSet](srowset.md) structure that is allocated for the table.</span></span> 
    
### <a name="to-flush-incoming-or-outgoing-queues-individually-by-transport-provider"></a><span data-ttu-id="7f972-118">So leeren Sie eingehende oder ausgehende Warteschlangen einzeln nach Transportanbieter</span><span class="sxs-lookup"><span data-stu-id="7f972-118">To flush incoming or outgoing queues individually by transport provider</span></span>
  
1. <span data-ttu-id="7f972-119">Rufen [Sie IMAPISession::GetStatusTable auf,](imapisession-getstatustable.md) um auf die Statustabelle zu zugreifen.</span><span class="sxs-lookup"><span data-stu-id="7f972-119">Call [IMAPISession::GetStatusTable](imapisession-getstatustable.md) to access the status table.</span></span> 
    
2. <span data-ttu-id="7f972-120">Rufen Sie die [IMAPITable::SetColumns-Methode](imapitable-setcolumns.md) der Statustabelle auf, um den Spaltensatz auf PR_ENTRYID **und** **PR_RESOURCE_TYPE.**</span><span class="sxs-lookup"><span data-stu-id="7f972-120">Call the status table's [IMAPITable::SetColumns](imapitable-setcolumns.md) method to limit the column set to **PR_ENTRYID** and **PR_RESOURCE_TYPE**.</span></span>
    
3. <span data-ttu-id="7f972-121">Erstellen Sie eine Eigenschaftseinschränkung mithilfe einer [SPropertyRestriction-Struktur,](spropertyrestriction.md) um PR_RESOURCE_TYPE **mit** MAPI_TRANSPORT_PROVIDER.</span><span class="sxs-lookup"><span data-stu-id="7f972-121">Build a property restriction using an [SPropertyRestriction](spropertyrestriction.md) structure to match **PR_RESOURCE_TYPE** with MAPI_TRANSPORT_PROVIDER.</span></span> 
    
4. <span data-ttu-id="7f972-122">Rufen [Sie HrQueryAllRows auf,](hrqueryallrows.md)und übergeben Sie die **SPropertyRestriction-Struktur,** um die Zeilen abzurufen, die von Transportanbietern bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="7f972-122">Call [HrQueryAllRows](hrqueryallrows.md), passing in the **SPropertyRestriction** structure, to retrieve the rows that are supplied by transport providers.</span></span> 
    
5. <span data-ttu-id="7f972-123">Für jede Zeile, die von **HrQueryAllRows zurückgegeben wird:**</span><span class="sxs-lookup"><span data-stu-id="7f972-123">For each row returned from **HrQueryAllRows**:</span></span>
    
    1. <span data-ttu-id="7f972-124">Übergeben Sie **PR_ENTRYID-Spalte** an [IMAPISession::OpenEntry,](imapisession-openentry.md) um das Statusobjekt des Transportanbieters zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="7f972-124">Pass the **PR_ENTRYID** column to [IMAPISession::OpenEntry](imapisession-openentry.md) to open the transport provider's status object.</span></span> 
        
    2. <span data-ttu-id="7f972-125">Überprüfen Sie, ob das Transportstatusobjekt die **FlushQueues-Methode** **unterstützt,** indem Sie überprüfen, ob die PR_RESOURCE_METHODS ([PidTagResourceMethods](pidtagresourcemethods-canonical-property.md)) -Eigenschaft über die STATUS_FLUSH_QUEUES verfügt.</span><span class="sxs-lookup"><span data-stu-id="7f972-125">Check that the transport status object supports the **FlushQueues** method by checking that its **PR_RESOURCE_METHODS** ([PidTagResourceMethods](pidtagresourcemethods-canonical-property.md)) property has the STATUS_FLUSH_QUEUES flag set.</span></span> 
        
    3. <span data-ttu-id="7f972-126">Wenn unterstützt, rufen Sie [IMAPIStatus::FlushQueues auf.](imapistatus-flushqueues.md)</span><span class="sxs-lookup"><span data-stu-id="7f972-126">If supported, call [IMAPIStatus::FlushQueues](imapistatus-flushqueues.md).</span></span> <span data-ttu-id="7f972-127">Wenn dies nicht unterstützt wird, rufen Sie die **IMAPIStatus::FlushQueues-Methode** des MAPI-Spoolers auf, und übergeben Sie den Eintragsbezeichner des Transports im _lpTargetTransport-Parameter._</span><span class="sxs-lookup"><span data-stu-id="7f972-127">If unsupported, call the MAPI spooler's **IMAPIStatus::FlushQueues** method, passing the entry identifier of the transport in the  _lpTargetTransport_ parameter.</span></span> <span data-ttu-id="7f972-128">Anweisungen zum Zugriff auf das Statusobjekt des MAPI-Spoolers finden Sie im vorherigen Verfahren.</span><span class="sxs-lookup"><span data-stu-id="7f972-128">See the preceding procedure for instructions on accessing the MAPI spooler's status object.</span></span> <span data-ttu-id="7f972-129">Legen Sie das FLUSH_DOWNLOAD, um die ausgehenden Warteschlangen oder das FLUSH_UPLOAD zu leeren, um die eingehenden Warteschlangen zu leeren.</span><span class="sxs-lookup"><span data-stu-id="7f972-129">Set the FLUSH_DOWNLOAD flag to flush the outgoing queues or the FLUSH_UPLOAD flag to flush the incoming queues.</span></span> 
        
    4. <span data-ttu-id="7f972-130">Geben Sie das Statusobjekt und die Statustabelle sowie die [SRowSet-Struktur](srowset.md) frei, die der Tabelle zugeordnet ist.</span><span class="sxs-lookup"><span data-stu-id="7f972-130">Release the status object and the status table, as well as the [SRowSet](srowset.md) structure that is allocated for the table.</span></span> 
    
<span data-ttu-id="7f972-131">Der MAPI-Spooler berücksichtigt das FLUSH_NO_UI wie die meisten LAN-Transportanbieter.</span><span class="sxs-lookup"><span data-stu-id="7f972-131">The MAPI spooler honors the FLUSH_NO_UI flag as do most LAN transport providers.</span></span> <span data-ttu-id="7f972-132">Diese Kennzeichnung wird jedoch nicht von allen Transportanbietern berücksichtigt, insbesondere denen, die explizit ein Modem verwenden, und dem Remotezugriffsdienst (RAS).</span><span class="sxs-lookup"><span data-stu-id="7f972-132">However, not all transport providers honor this flag, particularly those that use a modem explicitly and the Remote Access Service (RAS).</span></span> <span data-ttu-id="7f972-133">RAS wurde nicht so konzipiert, dass Clients die Benutzeroberfläche unterdrücken können.</span><span class="sxs-lookup"><span data-stu-id="7f972-133">RAS was not designed to allow clients to suppress the user interface.</span></span> <span data-ttu-id="7f972-134">Es ist möglich, dass ein Client so konfiguriert wird, dass er eine Verbindung herstellen kann, ohne dass die Interaktion eines Benutzers erforderlich ist. Dies ist jedoch schwierig und erfordert intime Kenntnisse der Nachrichtendienste des Clients.</span><span class="sxs-lookup"><span data-stu-id="7f972-134">It is possible for a client to be configured so that it can connect without requiring the interaction of a user, but it is difficult and requires intimate knowledge of the client's message services.</span></span>
  

