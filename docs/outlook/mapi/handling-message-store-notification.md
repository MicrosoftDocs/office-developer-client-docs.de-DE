---
title: Behandeln von Nachrichtenspeicherbenachrichtigungen
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 3e0cc2f9-a88d-4cec-bef5-b60f2ec80f1c
description: 'Letzte Änderung: Montag, 9. März 2015'
ms.openlocfilehash: d370603dc7cfc015fe7b2757d1cf0525b3092c5e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33428025"
---
# <a name="handling-message-store-notification"></a><span data-ttu-id="05d1c-103">Behandeln von Nachrichtenspeicherbenachrichtigungen</span><span class="sxs-lookup"><span data-stu-id="05d1c-103">Handling message store notification</span></span>
  
<span data-ttu-id="05d1c-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="05d1c-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="05d1c-105">Rufen Sie zum Registrieren für Nachrichtenspeicherbenachrichtigungen entweder die [IMAPISession::Advise-](imapisession-advise.md) oder [die IMsgStore::Advise-Methode](imsgstore-advise.md) auf, und geben Sie im Inhalt des  _lpEntryID-Parameters_ einen Nachrichtenspeicher, einen Ordner oder einen Nachrichteneintragsbezeichner an.</span><span class="sxs-lookup"><span data-stu-id="05d1c-105">To register for message store notifications, call either the [IMAPISession::Advise](imapisession-advise.md) or [IMsgStore::Advise](imsgstore-advise.md) method and specify a message store, folder, or message entry identifier in the contents of the  _lpEntryID_ parameter.</span></span> <span data-ttu-id="05d1c-106">Nachrichtenspeicheranbieter unterstützen Objekt- und Tabellenbenachrichtigungen.</span><span class="sxs-lookup"><span data-stu-id="05d1c-106">Message store providers support both object and table notifications.</span></span> <span data-ttu-id="05d1c-107">Ob Sie sich bei bestimmten Nachrichtenspeicherobjekten registrieren, mit der Ordnerhierarchie und den Inhaltstabellen, die diese Objekte beschreiben, oder mit Objekten und Tabellen, hängt von den Benachrichtigungen ab, die Sie erwarten, den Aufrufen, die Sie zum Ausführen von Vorgängen ausführen, und davon, wie der Nachrichtenspeicheranbieter die Benachrichtigung unterstützt.</span><span class="sxs-lookup"><span data-stu-id="05d1c-107">Whether you register with particular message store objects, with the folder hierarchy and contents tables that describe these objects, or with both objects and tables depends on the notifications you expect to see, the calls you make to perform operations, and how the message store provider supports notification.</span></span> 
  
<span data-ttu-id="05d1c-108">Da MAPI Flexibilität bei der Unterstützung von Benachrichtigungen durch Anbieter zulässt, sollten Sie beachten, dass Sie nicht immer dieselbe Art von Benachrichtigung als Reaktion auf ein bestimmtes Ereignis von allen Nachrichtenspeicheranbietern erhalten.</span><span class="sxs-lookup"><span data-stu-id="05d1c-108">Because MAPI allows flexibility in how providers support notifications, be aware that you will not always receive the same type of notification in response to a particular event from all message store providers.</span></span> <span data-ttu-id="05d1c-109">Einige Nachrichtenspeicheranbieter unterstützen keine Benachrichtigungen.</span><span class="sxs-lookup"><span data-stu-id="05d1c-109">Some message store providers do not support notifications at all.</span></span> <span data-ttu-id="05d1c-110">Um zu ermitteln, ob der von Ihnen verwendete Nachrichtenspeicher eine Benachrichtigung unterstützt, suchen Sie in der STORE_NOTIFY_OK -Bit in der **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) -Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="05d1c-110">To determine if the message store you are using supports notification, look for the STORE_NOTIFY_OK bit in its **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property.</span></span>
  
<span data-ttu-id="05d1c-111">An einem Ende des Spektrums der Nachrichtenspeicheranbieter, die Benachrichtigungen unterstützen, sind die Anbieter, die "umfangreiche" Benachrichtigungen generieren. Diese Anbieter senden beschreibende Benachrichtigungen für alle registrierten Ratgeberquellen.</span><span class="sxs-lookup"><span data-stu-id="05d1c-111">At one end of the spectrum of message store providers that support notification are the providers that generate "rich" notifications; these providers send descriptive notifications for all registered advise sources.</span></span> <span data-ttu-id="05d1c-112">Am anderen Ende befinden sich die Nachrichtenspeicheranbieter, die eingeschränkte Benachrichtigungen unterstützen. Diese Anbieter senden allgemeine Benachrichtigungen für eine eingeschränkte Anzahl von Ratgeberquellen.</span><span class="sxs-lookup"><span data-stu-id="05d1c-112">At the other end are the message store providers that support limited notifications; these providers send general notifications for a restricted number of advise sources.</span></span> 
  
<span data-ttu-id="05d1c-113">Wenn Sie z. B. eine Nachricht in einen Ordner kopieren, in dem Sie sich registriert haben, um sowohl objektkopierte als auch objekt verschobene Benachrichtigungen zu erhalten, erhalten Sie möglicherweise die objektkopierte Benachrichtigung.</span><span class="sxs-lookup"><span data-stu-id="05d1c-113">For example, if you copy a message to a folder with which you have registered to receive both object copied and object moved notifications, you may or may not receive the object copied notification.</span></span> <span data-ttu-id="05d1c-114">Ob Sie sie erhalten, hängt von den</span><span class="sxs-lookup"><span data-stu-id="05d1c-114">Whether or not you receive it depends on:</span></span>
  
- <span data-ttu-id="05d1c-115">Die Methode, die Sie zum Ausführen der Kopie aufgerufen haben.</span><span class="sxs-lookup"><span data-stu-id="05d1c-115">The method that you called to perform the copy.</span></span> <span data-ttu-id="05d1c-116">Dies kann [IMAPIFolder::CopyMessages](imapifolder-copymessages.md), [IMAPIProp::CopyTo](imapiprop-copyto.md)oder [IMAPIProp::CopyProps sein.](imapiprop-copyprops.md)</span><span class="sxs-lookup"><span data-stu-id="05d1c-116">This could be [IMAPIFolder::CopyMessages](imapifolder-copymessages.md), [IMAPIProp::CopyTo](imapiprop-copyto.md), or [IMAPIProp::CopyProps](imapiprop-copyprops.md).</span></span>
    
- <span data-ttu-id="05d1c-117">Implementierung der Kopiermethode durch den Nachrichtenspeicheranbieter.</span><span class="sxs-lookup"><span data-stu-id="05d1c-117">How the message store provider implements the copy method.</span></span>
    
- <span data-ttu-id="05d1c-118">Gibt an, ob der Nachrichtenspeicheranbieter objekt kopierte Benachrichtigungen in Ordnern unterstützt.</span><span class="sxs-lookup"><span data-stu-id="05d1c-118">Whether or not the message store provider supports object copied notifications on folders.</span></span>
    
<span data-ttu-id="05d1c-119">Da es keine strengen Richtlinien gibt, die beschreiben, wie Ereignisbenachrichtigungen für Nachrichtenspeicheranbieter implementiert werden, können Clients kein konsistentes Verhalten erwarten.</span><span class="sxs-lookup"><span data-stu-id="05d1c-119">Because there are no strict guidelines that describe how to implement event notification for message store providers, clients cannot expect consistent behavior.</span></span> <span data-ttu-id="05d1c-120">MAPI gibt Empfehlungen zur Implementierung von Ereignisbenachrichtigungen durch Nachrichtenspeicheranbieter, und in der folgenden Tabelle werden diese Empfehlungen aufgeführt.</span><span class="sxs-lookup"><span data-stu-id="05d1c-120">MAPI does make recommendations as to how message store providers implement event notification and the following table outlines these recommendations.</span></span> <span data-ttu-id="05d1c-121">Lesen Sie die Tabelle wie folgt: Nachdem Sie den Vorgang in der ersten Spalte ausführen, erwarten Sie, dass sie eine Benachrichtigung des Typs erhalten, der in der zweiten Spalte aufgeführt ist, wenn Sie sich für diesen Typ mit dem in der dritten Spalte aufgeführten Objekt registriert haben.</span><span class="sxs-lookup"><span data-stu-id="05d1c-121">Read the table as follows: after you perform the operation in the first column, expect to receive a notification of the type listed in the second column if you have registered for that type with the object listed in the third column.</span></span> <span data-ttu-id="05d1c-122">Nachdem Sie beispielsweise einen Ordner erstellt haben, erhalten Sie eine  _fnevObjectCreated-Benachrichtigung_ nur, wenn Sie sich beim Nachrichtenspeicher für  _fnevObjectCreated-Benachrichtigungen_ registriert haben.</span><span class="sxs-lookup"><span data-stu-id="05d1c-122">For example, after you have created a folder, you will receive an  _fnevObjectCreated_ notification only if you have registered for  _fnevObjectCreated_ notifications with the message store.</span></span> 
  
|<span data-ttu-id="05d1c-123">**Vorgang**</span><span class="sxs-lookup"><span data-stu-id="05d1c-123">**Operation**</span></span>|<span data-ttu-id="05d1c-124">**Ereignistyp**</span><span class="sxs-lookup"><span data-stu-id="05d1c-124">**Event type**</span></span>|<span data-ttu-id="05d1c-125">**Quelle "Beraten"**</span><span class="sxs-lookup"><span data-stu-id="05d1c-125">**Advise source**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="05d1c-126">Erstellen eines Ordners</span><span class="sxs-lookup"><span data-stu-id="05d1c-126">Create a folder</span></span>  <br/> | <span data-ttu-id="05d1c-127">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="05d1c-127">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="05d1c-128">Nachrichtenspeicher</span><span class="sxs-lookup"><span data-stu-id="05d1c-128">Message store</span></span>  <br/> |
|<span data-ttu-id="05d1c-129">Löschen eines Ordners</span><span class="sxs-lookup"><span data-stu-id="05d1c-129">Delete a folder</span></span>  <br/> | <span data-ttu-id="05d1c-130">_fnevObjectDeleted_</span><span class="sxs-lookup"><span data-stu-id="05d1c-130">_fnevObjectDeleted_</span></span> <br/> |<span data-ttu-id="05d1c-131">Nachrichtenspeicher Gelöschter Ordner</span><span class="sxs-lookup"><span data-stu-id="05d1c-131">Message store Deleted folder</span></span>  <br/> |
|<span data-ttu-id="05d1c-132">Verschieben eines Ordners von einem Ordner in einen anderen</span><span class="sxs-lookup"><span data-stu-id="05d1c-132">Move a folder from one folder to another</span></span>  <br/> | <span data-ttu-id="05d1c-133">_fnevObjectMoved_</span><span class="sxs-lookup"><span data-stu-id="05d1c-133">_fnevObjectMoved_</span></span> <br/> |<span data-ttu-id="05d1c-134">Ordner "Nachrichtenspeicher verschoben"</span><span class="sxs-lookup"><span data-stu-id="05d1c-134">Message store Moved folder</span></span>  <br/> |
|<span data-ttu-id="05d1c-135">Kopieren eines Ordners aus einem Ordner in einen anderen</span><span class="sxs-lookup"><span data-stu-id="05d1c-135">Copy a folder from one folder to another</span></span>  <br/> | <span data-ttu-id="05d1c-136">_fnevObjectCopied_</span><span class="sxs-lookup"><span data-stu-id="05d1c-136">_fnevObjectCopied_</span></span> <br/> |<span data-ttu-id="05d1c-137">Nachrichtenspeicher und kopierter Ordner (keine  _fnevObjectCreated-Benachrichtigung_ für die neue Kopie des Ordners gesendet)</span><span class="sxs-lookup"><span data-stu-id="05d1c-137">Message store and copied folder (no  _fnevObjectCreated_ notification sent for the new copy of the folder)</span></span>  <br/> |
|<span data-ttu-id="05d1c-138">Ändern in einer berechneten Ordnereigenschaft (**PR_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md)), **PR_CONTENT_UNREAD** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md)), **PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="05d1c-138">Change in a computed folder property (**PR_SUBFOLDERS** ([PidTagSubfolders](pidtagsubfolders-canonical-property.md)), **PR_CONTENT_UNREAD** ([PidTagContentUnreadCount](pidtagcontentunreadcount-canonical-property.md)), **PR_CONTENT_COUNT** ([PidTagContentCount](pidtagcontentcount-canonical-property.md))</span></span>  <br/> | <span data-ttu-id="05d1c-139">_fnevObjectModified_</span><span class="sxs-lookup"><span data-stu-id="05d1c-139">_fnevObjectModified_</span></span> <br/> |<span data-ttu-id="05d1c-140">Nachrichtenspeicher Geänderter Ordner (Keine Benachrichtigung an übergeordneten Ordner)</span><span class="sxs-lookup"><span data-stu-id="05d1c-140">Message store Changed folder (No notification to parent folder)</span></span>  <br/> |
|<span data-ttu-id="05d1c-141">Erstellen einer Nachricht</span><span class="sxs-lookup"><span data-stu-id="05d1c-141">Create a message</span></span>  <br/> | <span data-ttu-id="05d1c-142">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="05d1c-142">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="05d1c-143">Nachrichtenspeicher</span><span class="sxs-lookup"><span data-stu-id="05d1c-143">Message store</span></span>  <br/> |
|<span data-ttu-id="05d1c-144">Löschen einer Nachricht, wodurch eine Änderung der Eigenschaft des übergeordneten Ordners **PR_CONTENT_COUNT** wird</span><span class="sxs-lookup"><span data-stu-id="05d1c-144">Delete a message, causing a change in the parent folder's **PR_CONTENT_COUNT** property</span></span>  <br/> | <span data-ttu-id="05d1c-145">_fnevObjectDeleted_</span><span class="sxs-lookup"><span data-stu-id="05d1c-145">_fnevObjectDeleted_</span></span> <br/> |<span data-ttu-id="05d1c-146">Nachrichtenspeicher Gelöschte Nachricht</span><span class="sxs-lookup"><span data-stu-id="05d1c-146">Message store Deleted message</span></span>  <br/> |
|<span data-ttu-id="05d1c-147">Verschieben einer Nachricht aus einem Ordner in einen anderen</span><span class="sxs-lookup"><span data-stu-id="05d1c-147">Move a message from one folder to another</span></span>  <br/> | <span data-ttu-id="05d1c-148">_fnevObjectMoved_</span><span class="sxs-lookup"><span data-stu-id="05d1c-148">_fnevObjectMoved_</span></span> <br/> |<span data-ttu-id="05d1c-149">Nachrichtenspeicher Verschobene Nachricht</span><span class="sxs-lookup"><span data-stu-id="05d1c-149">Message store Moved message</span></span>  <br/> |
|<span data-ttu-id="05d1c-150">Kopieren einer Nachricht aus einem Ordner in einen anderen</span><span class="sxs-lookup"><span data-stu-id="05d1c-150">Copy a message from one folder to another</span></span>  <br/> | <span data-ttu-id="05d1c-151">_fnevObjectCopied_</span><span class="sxs-lookup"><span data-stu-id="05d1c-151">_fnevObjectCopied_</span></span> <br/> |<span data-ttu-id="05d1c-152">Nachrichtenspeicher Kopierte Nachricht (Keine  _fnevObjectCreated-Benachrichtigung_ für neue Kopie der Nachricht)</span><span class="sxs-lookup"><span data-stu-id="05d1c-152">Message store Copied message (No  _fnevObjectCreated_ notification for new copy of the message)</span></span>  <br/> |
|<span data-ttu-id="05d1c-153">Speichern einer Nachricht, wodurch eine Änderung der Eigenschaft des übergeordneten Ordners **PR_CONTENT_COUNT** wird</span><span class="sxs-lookup"><span data-stu-id="05d1c-153">Save a message, causing a change in the parent folder's **PR_CONTENT_COUNT** property</span></span>  <br/> | <span data-ttu-id="05d1c-154">_fnevObjectCreated_</span><span class="sxs-lookup"><span data-stu-id="05d1c-154">_fnevObjectCreated_</span></span> <br/> |<span data-ttu-id="05d1c-155">Nachrichtenspeicher nur beim ersten Speichern</span><span class="sxs-lookup"><span data-stu-id="05d1c-155">Message store on first save only</span></span>  <br/> |
|<span data-ttu-id="05d1c-156">Speichern einer Nachricht</span><span class="sxs-lookup"><span data-stu-id="05d1c-156">Save a message</span></span>  <br/> | <span data-ttu-id="05d1c-157">_fnevObjectModified_</span><span class="sxs-lookup"><span data-stu-id="05d1c-157">_fnevObjectModified_</span></span> <br/> |<span data-ttu-id="05d1c-158">Nachrichtenspeicher bei speichert nach dem ersten Speichern Geänderte Nachricht (Keine Benachrichtigung an übergeordneten Ordner)</span><span class="sxs-lookup"><span data-stu-id="05d1c-158">Message store on saves after the first save Changed message (No notification to parent folder)</span></span>  <br/> |
|<span data-ttu-id="05d1c-159">Abschließen eines Suchvorgangs</span><span class="sxs-lookup"><span data-stu-id="05d1c-159">Complete a search operation</span></span>  <br/> | <span data-ttu-id="05d1c-160">_fnevSearchComplete_</span><span class="sxs-lookup"><span data-stu-id="05d1c-160">_fnevSearchComplete_</span></span> <br/> |<span data-ttu-id="05d1c-161">Suchordner des Nachrichtenspeichers</span><span class="sxs-lookup"><span data-stu-id="05d1c-161">Message store Search folder</span></span>  <br/> |
|<span data-ttu-id="05d1c-162">Neue Nachricht</span><span class="sxs-lookup"><span data-stu-id="05d1c-162">New message</span></span>  <br/> | <span data-ttu-id="05d1c-163">_fnevNewMail_</span><span class="sxs-lookup"><span data-stu-id="05d1c-163">_fnevNewMail_</span></span> <br/> |<span data-ttu-id="05d1c-164">Nachrichtenspeicher</span><span class="sxs-lookup"><span data-stu-id="05d1c-164">Message store</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="05d1c-165">Wenn Sie eine Benachrichtigung zum Ändern eines Objekts [](object_notification.md) erhalten, denken Sie daran, dass der Arrayteil des Eigenschaftstags der OBJECT_NOTIFICATION-Struktur, auf den der _lpNotifications-Parameter_ im **OnNotify-Aufruf** verweist, null sein kann oder nicht.</span><span class="sxs-lookup"><span data-stu-id="05d1c-165">When you receive an object modified notification, remember that the property tag array portion of the [OBJECT_NOTIFICATION](object_notification.md) structure pointed to by the  _lpNotifications_ parameter in the **OnNotify** call may or may not be NULL.</span></span> <span data-ttu-id="05d1c-166">Nachrichtenspeicheranbieter müssen keine Eigenschafteninformationen in dieses Array einfügen, die meisten nicht.</span><span class="sxs-lookup"><span data-stu-id="05d1c-166">Message store providers are not required to insert property information in this array and most do not.</span></span> <span data-ttu-id="05d1c-167">Stellen Sie sicher, dass **ihre OnNotify-Methode** den Fall behandeln kann, bei dem  _der lpPropTagArray-Zeiger_ NULL ist.</span><span class="sxs-lookup"><span data-stu-id="05d1c-167">Make sure your **OnNotify** method can handle the case where the  _lpPropTagArray_ pointer is NULL.</span></span> 
  
<span data-ttu-id="05d1c-168">Aktualisieren Sie für die meisten, wenn nicht alle Objektbenachrichtigungen die Ansicht des betroffenen Ordners oder Ordners.</span><span class="sxs-lookup"><span data-stu-id="05d1c-168">For most, if not all object notifications, update the view of the affected folder or folders.</span></span>
  

