---
title: Behandeln von eingehenden Nachrichten
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: d45d5ed9-41cd-4aaf-91d2-1e4a27bb16d4
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: f3fbe34793e3520b26b984f4bd6b14fbcab7a951
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33438981"
---
# <a name="handling-an-incoming-message"></a><span data-ttu-id="05ce7-103">Behandeln von eingehenden Nachrichten</span><span class="sxs-lookup"><span data-stu-id="05ce7-103">Handling an incoming message</span></span>

<span data-ttu-id="05ce7-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="05ce7-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="05ce7-105">Eine eingehende Nachricht ist eine Nachricht, die über ein oder mehrere Messagingsysteme gesendet wurde.</span><span class="sxs-lookup"><span data-stu-id="05ce7-105">An incoming message is a message that has been sent across one or more messaging systems.</span></span> <span data-ttu-id="05ce7-106">Es wurde möglicherweise nur an Sie oder an viele andere Empfänger gesendet.</span><span class="sxs-lookup"><span data-stu-id="05ce7-106">It may have been sent only to you or to many other recipients.</span></span> <span data-ttu-id="05ce7-107">Eingehende Nachrichten werden in einem Empfangsordner platziert, der für Nachrichten einer bestimmten Klasse bestimmt ist.</span><span class="sxs-lookup"><span data-stu-id="05ce7-107">Incoming messages are placed in a receive folder designated to hold messages of a particular class.</span></span> <span data-ttu-id="05ce7-108">Sie können einen anderen Empfangsordner für jede Nachrichtenklasse einrichten, die Sie verarbeiten oder einen Ordner für alle Klassen verwenden.</span><span class="sxs-lookup"><span data-stu-id="05ce7-108">You can set up a different receive folder for each message class that you handle or use one folder for all of the classes.</span></span>
  
<span data-ttu-id="05ce7-109">Wenn Sie sich beim Nachrichtenspeicher für neue E-Mail-Benachrichtigungen registriert haben, werden Sie benachrichtigt, wenn eine Nachricht in einem Empfangsordner platziert wird.</span><span class="sxs-lookup"><span data-stu-id="05ce7-109">If you have registered for new mail notifications with the message store, you will be notified whenever a message is placed in a receive folder.</span></span> <span data-ttu-id="05ce7-110">Wenn Sie sich nicht für neue E-Mail-Benachrichtigungen registriert haben, müssen Sie den entsprechenden Empfangsordner regelmäßig öffnen, um manuell nach dem Eintreffen neuer Nachrichten zu suchen.</span><span class="sxs-lookup"><span data-stu-id="05ce7-110">If you have not registered for new mail notifications, you must open the appropriate receive folder periodically to manually check for the arrival of new messages.</span></span>
  
<span data-ttu-id="05ce7-111">Clients registrieren sich für neue E-Mail-Benachrichtigungen, indem sie die Parameter auf [IMsgStore::Advise wie](imsgstore-advise.md) folgt festlegen:</span><span class="sxs-lookup"><span data-stu-id="05ce7-111">Clients register for new mail notifications by setting the parameters to [IMsgStore::Advise](imsgstore-advise.md) as follows:</span></span> 
  
- <span data-ttu-id="05ce7-112">Legen  _Sie cbEntryID_ auf 0.</span><span class="sxs-lookup"><span data-stu-id="05ce7-112">Set  _cbEntryID_ to 0.</span></span> 
    
- <span data-ttu-id="05ce7-113">Legen  _Sie lpEntryID auf_ NULL.</span><span class="sxs-lookup"><span data-stu-id="05ce7-113">Set  _lpEntryID_ to NULL.</span></span> 
    
- <span data-ttu-id="05ce7-114">Legen  _Sie ulEventMask auf_ fnevNewMail.</span><span class="sxs-lookup"><span data-stu-id="05ce7-114">Set  _ulEventMask_ to fnevNewMail.</span></span> 
    
<span data-ttu-id="05ce7-115">Der _lpNotifications-Parameter_ im Aufruf ihrer **IMAPIAdviseSink::OnNotify-Methode** verweist auf eine **NEWMAIL \_** NOTIFICATION-Struktur, die Informationen zur eingehenden Nachricht enthält, z. B. die Nachrichtenklasse, die Eintrags-ID, die Eintrags-ID des übergeordneten Ordners und den Inhalt der **PR_MESSAGE_FLAGS-Eigenschaft.**</span><span class="sxs-lookup"><span data-stu-id="05ce7-115">The  _lpNotifications_ parameter in the call to your **IMAPIAdviseSink::OnNotify** method points to a **NEWMAIL\_NOTIFICATION** structure that contains information about the incoming message, such as its message class, its entry identifier, the entry identifier of its parent folder, and the contents of its **PR_MESSAGE_FLAGS** property.</span></span> <span data-ttu-id="05ce7-116">Weitere Informationen zum Registrieren und Behandeln von Benachrichtigungen finden Sie unter [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md), [NEWMAIL_NOTIFICATION](newmail_notification.md), **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)) und [Handling Notifications](handling-notifications.md).</span><span class="sxs-lookup"><span data-stu-id="05ce7-116">For more information about registering for and handling notifications, see [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md), [NEWMAIL_NOTIFICATION](newmail_notification.md), **PR_MESSAGE_FLAGS** ([PidTagMessageFlags](pidtagmessageflags-canonical-property.md)), and [Handling Notifications](handling-notifications.md).</span></span> 
  
<span data-ttu-id="05ce7-117">Ermitteln Sie vor dem Anzeigen einer eingehenden Nachricht für einen Benutzer, ob es sich bei der Nachrichtenklasse um eine Klasse handelt, die vom Client unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="05ce7-117">Before displaying an incoming message to a user, determine if its message class is a class that your client supports.</span></span> <span data-ttu-id="05ce7-118">Wenn nicht, ignorieren Sie die Nachricht.</span><span class="sxs-lookup"><span data-stu-id="05ce7-118">If not, ignore the message.</span></span> <span data-ttu-id="05ce7-119">Wenn es sich bei der Klasse um eine klasse handelt, die Sie unterstützen, können Sie die Nachricht mit einem Formular öffnen und anzeigen, das für die Nachrichtenklasse der Nachricht geeignet ist.</span><span class="sxs-lookup"><span data-stu-id="05ce7-119">If the class is one that you support, you can open and display the message with a form that is appropriate for the message class of the message.</span></span> <span data-ttu-id="05ce7-120">Die Auswahl der Formulare basiert auf der Nachrichtenklasse.</span><span class="sxs-lookup"><span data-stu-id="05ce7-120">The choice of forms is based on message class.</span></span> <span data-ttu-id="05ce7-121">Nachrichten, die zur IPM-Klasse gehören, verwenden ein von MAPI implementiertes Standardformular.</span><span class="sxs-lookup"><span data-stu-id="05ce7-121">Messages that belong to the IPM class use a default form implemented by MAPI.</span></span> <span data-ttu-id="05ce7-122">Nachrichten, die zu benutzerdefinierten Klassen gehören, die von Clients definiert werden, können entweder clientdefinierte spezielle Formulare oder das MAPI-Standardformular verwenden.</span><span class="sxs-lookup"><span data-stu-id="05ce7-122">Messages that belong to custom classes defined by clients can use either client-defined specialized forms or the MAPI default form.</span></span>
  
## <a name="open-and-display-an-incoming-message"></a><span data-ttu-id="05ce7-123">Öffnen und Anzeigen einer eingehenden Nachricht</span><span class="sxs-lookup"><span data-stu-id="05ce7-123">Open and display an incoming message</span></span>
  
1. <span data-ttu-id="05ce7-124">Rufen **Sie IMsgStore::GetReceiveFolder** auf, um die Eintrags-ID des Empfangsordners für die Nachrichtenklasse der Nachricht abzurufen, und übergeben Sie diesen Eintragsbezeichner an **IMsgStore::OpenEntry,** um den Ordner zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="05ce7-124">Call **IMsgStore::GetReceiveFolder** to retrieve the entry identifier of the receive folder for the message class of the message and pass this entry identifier to **IMsgStore::OpenEntry** to open the folder.</span></span> <span data-ttu-id="05ce7-125">Weitere Informationen finden Sie unter [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md), [IMsgStore::OpenEntry](imsgstore-openentry.md)und [Opening a Message Store Folder](opening-a-message-store-folder.md).</span><span class="sxs-lookup"><span data-stu-id="05ce7-125">For more information, see [IMsgStore::GetReceiveFolder](imsgstore-getreceivefolder.md), [IMsgStore::OpenEntry](imsgstore-openentry.md), and [Opening a Message Store Folder](opening-a-message-store-folder.md).</span></span>
    
2. <span data-ttu-id="05ce7-126">Rufen Sie die **IMAPIContainer::GetContentsTable-Methode** des Empfangsordners auf, um die Inhaltstabelle abzurufen.</span><span class="sxs-lookup"><span data-stu-id="05ce7-126">Call the receive folder's **IMAPIContainer::GetContentsTable** method to retrieve its contents table.</span></span> <span data-ttu-id="05ce7-127">Weitere Informationen finden Sie unter [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md).</span><span class="sxs-lookup"><span data-stu-id="05ce7-127">For more information, see [IMAPIContainer::GetContentsTable](imapicontainer-getcontentstable.md).</span></span> <span data-ttu-id="05ce7-128">Rufen Sie die **IMAPITable::QueryRows-Methode** der Tabelle auf, um alle Zeilen in der Tabelle abzurufen.</span><span class="sxs-lookup"><span data-stu-id="05ce7-128">Call the table's **IMAPITable::QueryRows** method to retrieve all the rows in the table.</span></span> <span data-ttu-id="05ce7-129">Weitere Informationen finden Sie unter [IMAPITable::QueryRows](imapitable-queryrows.md) and [Contents Tables](contents-tables.md).</span><span class="sxs-lookup"><span data-stu-id="05ce7-129">For more information see [IMAPITable::QueryRows](imapitable-queryrows.md) and [Contents Tables](contents-tables.md).</span></span> <span data-ttu-id="05ce7-130">Weitere Informationen zum Anzeigen einer Inhaltstabelle finden Sie unter [Displaying a Folder Contents Table](displaying-a-folder-contents-table.md).</span><span class="sxs-lookup"><span data-stu-id="05ce7-130">For more information about displaying a contents table, see [Displaying a Folder Contents Table](displaying-a-folder-contents-table.md).</span></span>
    
3. <span data-ttu-id="05ce7-131">Wenn Ihr Client interaktiv ist, können Sie dem Benutzer erlauben, eine Nachricht aus der Tabelle auszuwählen und das Formular zu bestimmen, das zum Anzeigen dieser Nachricht verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="05ce7-131">If your client is interactive, allow the user to select a message from the table and determine the form to be used to display that message.</span></span> <span data-ttu-id="05ce7-132">Clients können das von MAPI oder einem benutzerdefinierten Formular bereitgestellte Standardformular verwenden.</span><span class="sxs-lookup"><span data-stu-id="05ce7-132">Clients can use the default form provided by MAPI or a custom form.</span></span> <span data-ttu-id="05ce7-133">Weitere Informationen finden Sie unter [Handling MAPI Forms](handling-mapi-forms.md).</span><span class="sxs-lookup"><span data-stu-id="05ce7-133">For more information, see [Handling MAPI Forms](handling-mapi-forms.md).</span></span>
    
4. <span data-ttu-id="05ce7-134">Rufen **Sie IMsgStore::OpenEntry auf,** um die Nachricht zu öffnen.</span><span class="sxs-lookup"><span data-stu-id="05ce7-134">Call **IMsgStore::OpenEntry** to open the message.</span></span> <span data-ttu-id="05ce7-135">Weitere Informationen finden Sie unter [Öffnen einer Nachricht](opening-a-message.md).</span><span class="sxs-lookup"><span data-stu-id="05ce7-135">For more information, see [Opening a Message](opening-a-message.md).</span></span>
    
5. <span data-ttu-id="05ce7-136">Verarbeiten des Nachrichtentexts.</span><span class="sxs-lookup"><span data-stu-id="05ce7-136">Process the message text.</span></span> <span data-ttu-id="05ce7-137">Weitere Informationen finden Sie unter [Opening Message Text](opening-message-text.md).</span><span class="sxs-lookup"><span data-stu-id="05ce7-137">For more information, see [Opening Message Text](opening-message-text.md).</span></span>
    
6. <span data-ttu-id="05ce7-138">Rendern Sie jede der Nachrichtenanlagen.</span><span class="sxs-lookup"><span data-stu-id="05ce7-138">Render each of the message attachments.</span></span> <span data-ttu-id="05ce7-139">Weitere Informationen finden Sie unter [Rendering an Attachment in Plain Text](rendering-an-attachment-in-plain-text.md) oder Rendering an Attachment in [RTF Text](rendering-an-attachment-in-rtf-text.md).</span><span class="sxs-lookup"><span data-stu-id="05ce7-139">For more information, see [Rendering an Attachment in Plain Text](rendering-an-attachment-in-plain-text.md) or [Rendering an Attachment in RTF Text](rendering-an-attachment-in-rtf-text.md).</span></span>
    
7. <span data-ttu-id="05ce7-140">Öffnen Sie bei Bedarf eine Anlage.</span><span class="sxs-lookup"><span data-stu-id="05ce7-140">Open an attachment if desired.</span></span> <span data-ttu-id="05ce7-141">Weitere Informationen finden Sie [unter Öffnen einer Anlage](opening-an-attachment.md).</span><span class="sxs-lookup"><span data-stu-id="05ce7-141">For more information see [Opening an Attachment](opening-an-attachment.md).</span></span>
    
## <a name="in-this-section"></a><span data-ttu-id="05ce7-142">Inhalt dieses Abschnitts</span><span class="sxs-lookup"><span data-stu-id="05ce7-142">In this section</span></span>

- <span data-ttu-id="05ce7-143">[Öffnen von Nachrichtentext](opening-message-text.md): Beschreibt, wie der Nachrichtentext geöffnet wird.</span><span class="sxs-lookup"><span data-stu-id="05ce7-143">[Opening Message Text](opening-message-text.md): Describes how to open the message text.</span></span>
    
- <span data-ttu-id="05ce7-144">[Rendern einer Anlage in Nur-Text:](rendering-an-attachment-in-plain-text.md)Beschreibt, wie eine Anlage in Nur-Text gerendert wird.</span><span class="sxs-lookup"><span data-stu-id="05ce7-144">[Rendering an Attachment in Plain Text](rendering-an-attachment-in-plain-text.md): Describes how to render an attachment in plain text.</span></span>
    
- <span data-ttu-id="05ce7-145">[Rendern einer Anlage in RTF Text](rendering-an-attachment-in-rtf-text.md): Beschreibt, wie eine Anlage in formatierten Text gerendert wird.</span><span class="sxs-lookup"><span data-stu-id="05ce7-145">[Rendering an Attachment in RTF Text](rendering-an-attachment-in-rtf-text.md): Describes how to render an attachment in formatted text.</span></span>
    
- <span data-ttu-id="05ce7-146">[Öffnen einer Anlage](opening-an-attachment.md): Beschreibt das Öffnen einer Anlage.</span><span class="sxs-lookup"><span data-stu-id="05ce7-146">[Opening an Attachment](opening-an-attachment.md): Describes how to open an attachment.</span></span>
    

