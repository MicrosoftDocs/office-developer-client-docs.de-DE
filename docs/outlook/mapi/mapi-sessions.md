---
title: MAPI-Sitzungen
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: c5a7c137-393e-40ff-a2b9-afe02da2435a
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 3dd55d8ee3cb2751fb27184f0069ae831e2164ee
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33435873"
---
# <a name="mapi-sessions"></a><span data-ttu-id="ea5c4-103">MAPI-Sitzungen</span><span class="sxs-lookup"><span data-stu-id="ea5c4-103">MAPI sessions</span></span>

<span data-ttu-id="ea5c4-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="ea5c4-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="ea5c4-105">Bevor der Clientanwendung aus eine zugrunde liegenden messaging-System aufrufen kann, m�ssen sie eine Sitzung oder bei einer Verbindung mit der MAPI-Subsystems einrichten.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-105">Before the client application can call an underlying messaging system, it must establish a session, or connection, with the MAPI subsystem.</span></span>
  
<span data-ttu-id="ea5c4-p101">Sessions are initiated when a user logs on, a process that accesses a valid profile and validates the messaging system and the message service credentials. Then, the process ensures that all of the profile's message services are correctly configured. The client interface you use determines the logon call. MAPI clients call the [MAPILogonEx](mapilogonex.md) function.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-p101">Sessions are initiated when a user logs on, a process that accesses a valid profile and validates the messaging system and the message service credentials. Then, the process ensures that all of the profile's message services are correctly configured. The client interface you use determines the logon call. MAPI clients call the [MAPILogonEx](mapilogonex.md) function.</span></span> 
  
<span data-ttu-id="ea5c4-110">Die Konfiguration des Nachrichtendienstes ist einer der wichtigsten Bestandteile des Anmeldevorgangs.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-110">Message service configuration is one of the most important parts of the logon process.</span></span> <span data-ttu-id="ea5c4-111">Das Profil ist die erste Quelle für Konfigurationsinformationen.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-111">The profile is the initial source for configuration information.</span></span> <span data-ttu-id="ea5c4-112">Wenn Informationen für einen bestimmten Nachrichtendienst fehlen, versucht der Anmeldeprozess, den Benutzer zur Bereitstellung aufzufordern.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-112">If information for a particular message service is missing, the logon process tries to prompt the user to supply it.</span></span> <span data-ttu-id="ea5c4-113">Dies ist aus zwei Gründen nicht immer erfolgreich: Erstens erfordert die Aufforderung des Benutzers die Anzeige eines Dialogfelds.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-113">This is not always successful for two reasons: First, prompting the user requires the display of a dialog box.</span></span> <span data-ttu-id="ea5c4-114">Es ist möglich, dass Clients die Anzeige einer Benutzeroberfläche nicht zulassen, indem sie ein Flag an den Anmeldeaufruf übergeben.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-114">It is possible for clients to disallow the display of a user interface by passing a flag into the logon call.</span></span> <span data-ttu-id="ea5c4-115">Zweitens kann der Benutzer das Dialogfeld abbrechen, bevor die erforderlichen Informationen hinzugefügt werden können.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-115">Second, the user could cancel the dialog box before the needed information can be added.</span></span>
  
<span data-ttu-id="ea5c4-116">Wenn ein Anmeldevorgang einmal fehlschlägt, wird der Benutzer über den Fehler informiert und erhält die Möglichkeit, die Fehlerbedingung erneut zu versuchen oder zu korrigieren.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-116">When a logon process fails one time, the user is informed of the failure and given the chance to retry or correct the error condition.</span></span> <span data-ttu-id="ea5c4-117">Erneut wird eine Benutzeroberfläche angezeigt, wenn der Client dies zulässt, und der Benutzer wird aufgefordert, die fehlenden Daten einzugeben.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-117">Once again, a user interface will be displayed, if the client allows it, and the user will be prompted to enter whatever data is missing.</span></span> <span data-ttu-id="ea5c4-118">Wenn dieser zweite Versuch fehlschlägt, deaktiviert MAPI alle Dienstanbieter im Nachrichtendienst für die Dauer der Sitzung.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-118">If this second try is unsuccessful, MAPI disables all service providers in the message service for the duration of the session.</span></span> <span data-ttu-id="ea5c4-119">Tatsächlich ist der gesamte Nachrichtendienst deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-119">In effect, the whole message service is disabled.</span></span> <span data-ttu-id="ea5c4-120">Dies bedeutet, dass keiner der Dienstanbieter im Nachrichtendienst funktionieren kann.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-120">This means that none of the service providers in the message service can work.</span></span> <span data-ttu-id="ea5c4-121">Dies geschieht, da bei einem Fehler bei der Anmeldung eines Anbieters in der Regel auch die anderen Anbieter ausfallen.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-121">This is done because if one provider fails logon, the other providers usually also fail.</span></span> <span data-ttu-id="ea5c4-122">Der Anmeldeprozess kann aufgrund eines ungültigen Pfads für eine erforderliche Ressource, einer inkompatiblen MAPI-Version, eines nicht verfügbaren Messagingservers oder einer Datenbeschädigung fehlschlagen.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-122">The logon process can fail due to an invalid path for a necessary resource, an incompatible version of MAPI, an unavailable messaging server, or data corruption.</span></span> 
  
<span data-ttu-id="ea5c4-123">Clients können eine von zwei Arten von Sitzungen angeben, die im Anmeldeaufruf eingerichtet werden sollen: eine einzelne Sitzung oder eine freigegebene Sitzung.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-123">Clients can specify one of two types of sessions to be established in the logon call: an individual session or a shared session.</span></span> <span data-ttu-id="ea5c4-124">Einzelne Sitzungen sind private Verbindungen; Zwischen einer Clientanwendung und der von ihr verwendeten Sitzung besteht eine 1:1-Beziehung.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-124">Individual sessions are private connections; there is a one-to-one relationship between a client application and the session it is using.</span></span> <span data-ttu-id="ea5c4-125">Infolgedessen teilen Clientanwendungen, die eine Sitzung gemeinsam nutzen, auch ein Profil.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-125">As a consequence, client applications that share a session also share a profile.</span></span> <span data-ttu-id="ea5c4-126">Freigegebene Sitzungen werden einmal eingerichtet, können jedoch von anderen Clientanwendungen verwendet werden, die sie verwenden müssen.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-126">Shared sessions are established once but can be used by other client applications that need to use them.</span></span> <span data-ttu-id="ea5c4-127">Das Profil und die Anmeldeinformationen werden nur mit der ersten Anmeldung angegeben.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-127">The profile and credentials are specified only with the initial logon.</span></span> 
  
<span data-ttu-id="ea5c4-128">Clients können sich mehrmals als derselbe Benutzer oder als mehrere Benutzer anmelden.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-128">Clients can log on multiple times as the same user or as multiple users.</span></span> <span data-ttu-id="ea5c4-129">MAPI verhindert dies nicht.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-129">MAPI does not prevent this.</span></span> <span data-ttu-id="ea5c4-130">Einige Dienstanbieter sind jedoch möglicherweise nicht so flexibel, da der Fehlerwert MAPI_E_SESSION_LIMIT bei nachfolgenden Anmeldeversuchen zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-130">Some service providers, however, might not be as flexible, returning the error value MAPI_E_SESSION_LIMIT on subsequent logon attempts.</span></span> <span data-ttu-id="ea5c4-131">Dienstanbieter mit zugrunde liegenden Hardwareeinschränkungen können erforderlich sein, um ein Sitzungslimit zu erzwingen.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-131">Service providers with underlying hardware limitations can be required to enforce a session limit.</span></span>
  
<span data-ttu-id="ea5c4-132">Die Funktionsaufrufe zum Einrichten einer Sitzung verfügen über eine Sammlung von Flags und Parametern, die steuern, wie die Sitzung erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-132">The function calls for establishing a session have a collection of flags and parameters that control how the session is created.</span></span> <span data-ttu-id="ea5c4-133">Der Client gibt einen optionalen Profilnamen und ein Fensterhandle an, das als übergeordnetes Fenster für alle angezeigten Dialogfelder fungiert.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-133">The client specifies an optional profile name and a window handle that acts as the parent window for any dialog boxes that are displayed.</span></span> <span data-ttu-id="ea5c4-134">Die Flags enthalten MAPI_NEW_SESSION, die die Einrichtung einer neuen, individuellen Sitzung (anstelle einer freigegebenen Sitzung) und das MAPI_LOGON_UI-Benutzeroberflächenflagfordert.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-134">The flags include MAPI_NEW_SESSION, which requests that a new, individual session (rather than a shared session) be established, and the MAPI_LOGON_UI user interface flag.</span></span> <span data-ttu-id="ea5c4-135">Das Benutzeroberflächenflag wird so festgelegt, dass ein Anmeldedialogfeld anfordert.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-135">The user interface flag is set to request a logon dialog box.</span></span>
  
<span data-ttu-id="ea5c4-136">Die folgende Abbildung zeigt, wie diese verschiedenen Parameter und Flags eine MAPI-Sitzung einrichten.</span><span class="sxs-lookup"><span data-stu-id="ea5c4-136">The following illustration shows how these various parameters and flags establish a MAPI session.</span></span>
  
<span data-ttu-id="ea5c4-137">**Flussdiagramm für MAPI-Sitzung**</span><span class="sxs-lookup"><span data-stu-id="ea5c4-137">**MAPI session flowchart**</span></span>
  
<span data-ttu-id="ea5c4-138">![MAPI-Sitzungsflussdiagramm](media/amapi_47.gif "MAPI-Sitzungsflussdiagramm")</span><span class="sxs-lookup"><span data-stu-id="ea5c4-138">![MAPI session flowchart](media/amapi_47.gif "MAPI session flowchart")</span></span>
  
<span data-ttu-id="ea5c4-139">Informationen zum Behandeln von Sitzungen innerhalb einer Clientanwendung finden Sie unter [MAPI Session Handling](mapi-session-handling.md)</span><span class="sxs-lookup"><span data-stu-id="ea5c4-139">For information about handling sessions from within a client application, see [MAPI Session Handling](mapi-session-handling.md)</span></span>
  
## <a name="see-also"></a><span data-ttu-id="ea5c4-140">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="ea5c4-140">See also</span></span>

- [<span data-ttu-id="ea5c4-141">MAPILogonEx</span><span class="sxs-lookup"><span data-stu-id="ea5c4-141">MAPILogonEx</span></span>](mapilogonex.md)  
- [<span data-ttu-id="ea5c4-142">IMAPISession : IUnknown</span><span class="sxs-lookup"><span data-stu-id="ea5c4-142">IMAPISession : IUnknown</span></span>](imapisessioniunknown.md)
- [<span data-ttu-id="ea5c4-143">MAPI-Sitzungsbehandlung</span><span class="sxs-lookup"><span data-stu-id="ea5c4-143">MAPI Session Handling</span></span>](mapi-session-handling.md)  
- [<span data-ttu-id="ea5c4-144">Übersicht über die MAPI-Programmierung</span><span class="sxs-lookup"><span data-stu-id="ea5c4-144">MAPI Programming Overview</span></span>](mapi-programming-overview.md)

