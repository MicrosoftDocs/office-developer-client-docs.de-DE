---
title: Interagieren mit dem MAPI-Spooler
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 5cc1d0a8-ad23-4173-b220-b7c0169073fa
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: da94347dcb47e5fdbd4a6c1d404b795f4f7938ab
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33432149"
---
# <a name="interacting-with-the-mapi-spooler"></a><span data-ttu-id="45955-103">Interagieren mit dem MAPI-Spooler</span><span class="sxs-lookup"><span data-stu-id="45955-103">Interacting with the MAPI Spooler</span></span>

  
  
<span data-ttu-id="45955-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="45955-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="45955-105">Die Methoden in [der IXPLogon : IUnknown-Schnittstelle](ixplogoniunknown.md) werden vom MAPI-Spooler beim Aufrufen des Transportanbieters verwendet.</span><span class="sxs-lookup"><span data-stu-id="45955-105">The methods in the [IXPLogon : IUnknown](ixplogoniunknown.md) interface are used by the MAPI spooler when calling the transport provider.</span></span> <span data-ttu-id="45955-106">Die meisten Arten von Transportanbietern sollten die meisten dieser Methoden implementieren können, damit sie schnell zurückkehren.</span><span class="sxs-lookup"><span data-stu-id="45955-106">It should be possible for most types of transport providers to implement most of these methods so that they return quickly.</span></span> <span data-ttu-id="45955-107">Dies ist wünschenswert, da eine Methode, die lange dauert, um zurückzukehren, durch Aufrufe an den MAPI-Spooler aufgebrochen werden sollte, um die CPU für andere Aufgaben frei zu geben.</span><span class="sxs-lookup"><span data-stu-id="45955-107">This is desirable because if a method takes a long time to return then it should be broken up with calls back to the MAPI spooler to release the CPU for other tasks.</span></span> 
  
<span data-ttu-id="45955-108">Der MAPI-Spooler führt seine Arbeit aus und ruft Transportanbieter auf, wenn sich Vordergrundanwendungen im Leerlauf befinden.</span><span class="sxs-lookup"><span data-stu-id="45955-108">The MAPI spooler does its work and makes its calls to transport providers when foreground applications are idle.</span></span> <span data-ttu-id="45955-109">Nach der optionalen Anzeige von Dialogfeldern, wenn der Transportanbieter zum ersten Mal angemeldet ist (geregelt durch Flags, die von MAPI an den Transportanbieter übergeben werden), arbeiten Transportanbieter im Hintergrund, es sei denn, der Client wird zum Leeren von Sende- und Empfangswarteschlangen aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="45955-109">After optionally displaying dialog boxes when the transport provider is first logged on (governed by flags passed from MAPI to the transport provider), transport providers operate in the background unless called by the client to flush send and receive queues.</span></span> <span data-ttu-id="45955-110">Das Leeren von Warteschlangen ist der einzige Zeitpunkt, zu dem ein Transportanbieter die CPU nicht los lassen muss, und dann nur, wenn der Benutzer darüber informiert wird, dass eine potenziell lange Aktion ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="45955-110">Flushing queues is the only time that a transport provider need not release the CPU, and then only if the user is informed that a potentially long action is in progress.</span></span> <span data-ttu-id="45955-111">Der MAPI-Spooler fordert in der Regel an, dass ein Transportanbieter seine Warteschlangen als Reaktion auf eine Benutzeraktion leert, sodass der Transportanbieter in der Regel nichts tun muss, um sicherzustellen, dass der Benutzer informiert wird.</span><span class="sxs-lookup"><span data-stu-id="45955-111">The MAPI spooler typically requests that a transport provider flush its queues in response to a user action, so the transport provider typically does not need to do anything to ensure that the user is informed.</span></span>
  
<span data-ttu-id="45955-112">Ein Transportanbieter kann unabhängig entscheiden, eine Warteschlange zu leeren und die **STATUS_INBOUND_FLUSH-** und STATUS_OUTBOUND_FLUSH-Bits in der PR_STATUS_CODE ([PidTagStatusCode](pidtagstatuscode-canonical-property.md))-Eigenschaft seiner Statuszeile zu verwenden, um den #A0 darüber zu informieren, dass er Aufmerksamkeit möchte, damit er den Auftrag erledigen kann.</span><span class="sxs-lookup"><span data-stu-id="45955-112">A transport provider can independently decide to flush a queue and use the STATUS_INBOUND_FLUSH and STATUS_OUTBOUND_FLUSH bits in the **PR_STATUS_CODE** ([PidTagStatusCode](pidtagstatuscode-canonical-property.md)) property of its status row to inform the MAPI spooler that it wants attention so that it can get the job done.</span></span> <span data-ttu-id="45955-113">Die Statuszeile wird mithilfe der [IMAPISupport::ModifyStatusRow-Methode](imapisupport-modifystatusrow.md) aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="45955-113">The status row is updated using the [IMAPISupport::ModifyStatusRow](imapisupport-modifystatusrow.md) method.</span></span> <span data-ttu-id="45955-114">In diesem Fall sollte der Transportanbieter wahrscheinlich eine Statusanzeige oder eine andere Schnittstelle anzeigen, um den Benutzer darüber zu informieren, dass eine lange Aktion ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="45955-114">In this case the transport provider should probably display a progress indicator or other interface to inform the user that a long action is occuring.</span></span> 
  
<span data-ttu-id="45955-115">Da netzwerkaktivität häufig länger als 0,2 Sekunden dauert, sollten Transportanbieter nach Möglichkeit asynchrone Netzwerkanforderungen verwenden.</span><span class="sxs-lookup"><span data-stu-id="45955-115">Since network activity often takes more than 0.2 seconds, transport providers should, whenever possible, use asynchronous network requests.</span></span> <span data-ttu-id="45955-116">Auf diese Weise können sie eine Anforderung initiieren, die CPU los, indem sie den MAPI-Spooler aufrufen und wenn der MAPI-Spooler ihnen erneut die Kontrolle übergibt, um zu überprüfen, ob ihre Netzwerkanforderung abgeschlossen wurde.</span><span class="sxs-lookup"><span data-stu-id="45955-116">This enables them to initiate a request, release the CPU by calling back to the MAPI spooler, and when the MAPI spooler again gives them control, to check to see if their network request has completed.</span></span> <span data-ttu-id="45955-117">Wenn sie noch nicht abgeschlossen ist, geben sie die CPU erneut frei, indem sie den MAPI-Spooler mit der [IMAPISupport::SpoolerYield-Methode](imapisupport-spooleryield.md) aufrufen.</span><span class="sxs-lookup"><span data-stu-id="45955-117">If it has not yet completed, they again release the CPU by calling back to the MAPI spooler with the [IMAPISupport::SpoolerYield](imapisupport-spooleryield.md) method.</span></span> 
  
<span data-ttu-id="45955-118">Während der Nachrichtenverarbeitung zwischen [IXPLogon::SubmitMessage](ixplogon-submitmessage.md) und [IXPLogon::EndMessage](ixplogon-endmessage.md) und [während IXPLogon::StartMessage](ixplogon-startmessage.md)ruft der Transportanbieter in der Regel viele Objekte auf, die vom MAPI-Spooler verfügbar gemacht werden.</span><span class="sxs-lookup"><span data-stu-id="45955-118">During message processing, between [IXPLogon::SubmitMessage](ixplogon-submitmessage.md) and [IXPLogon::EndMessage](ixplogon-endmessage.md) and during [IXPLogon::StartMessage](ixplogon-startmessage.md), the transport provider typically makes many calls on objects exposed to it by the MAPI spooler.</span></span> <span data-ttu-id="45955-119">Im Rahmen der Behandlung dieser Objekte hilft der MAPI-Spooler dem Transportanbieter dabei, sich entsprechend als Hintergrundprozess zu verhalten, indem er bei entsprechender Verwendung eigene Ergebnisse liefert.</span><span class="sxs-lookup"><span data-stu-id="45955-119">As part of its handling of these objects, the MAPI spooler helps the transport provider behave appropriately as a background process by yielding on its own when appropriate.</span></span> <span data-ttu-id="45955-120">Ein Transportanbieter, der eine zeitkritische Verarbeitung erfordert, kann einen kritischen Abschnitt für den MAPI-Spooler mithilfe der [IMAPISupport::SpoolerNotify-Supportobjektmethode](imapisupport-spoolernotify.md) deklarieren.</span><span class="sxs-lookup"><span data-stu-id="45955-120">A transport provider requiring time-critical processing can declare a critical section to the MAPI spooler using the [IMAPISupport::SpoolerNotify](imapisupport-spoolernotify.md) support object method.</span></span> <span data-ttu-id="45955-121">In diesem Fall wird die CPU nur für explizite **SpoolerYield-Aufrufe** des Transportanbieters freigegeben, bis der Transportanbieter die Kritische Abschnittsverarbeitung mit einem anderen Aufruf von **SpoolerNotify beendet.**</span><span class="sxs-lookup"><span data-stu-id="45955-121">In this case, the CPU is released only on explicit **SpoolerYield** calls by the transport provider until the transport provider ends critical section processing with another call to **SpoolerNotify**.</span></span>
  
> [!NOTE]
> <span data-ttu-id="45955-122">Dies ist nicht identisch mit einem kritischen Win32-Abschnitt.</span><span class="sxs-lookup"><span data-stu-id="45955-122">This is not the same as a Win32 critical section.</span></span> <span data-ttu-id="45955-123">Dies sollte nur erfolgen, wenn der Transportanbieter die Echtzeitkontrolle externer Ressourcen benötigt, z. B. das Lesen eingehender Daten aus einer Faxleitung.</span><span class="sxs-lookup"><span data-stu-id="45955-123">This should only be done when the transport provider needs real-time control of external resources such as reading incoming data from a fax line.</span></span> <span data-ttu-id="45955-124">Da dies die Priorität des MAPI-Spoolerprozesses erhöht und dazu führen kann, dass die Arbeitsstation für die Dauer des Vorgangs nicht reagiert, sollten Sie den Benutzer benachrichtigen, dass eine potenziell lange Aktion ausgeführt wird, und nach Möglichkeit einen Fortschrittsindikator bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="45955-124">Since this raises the priority of the MAPI spooler process and can cause the workstation to be unresponsive for the duration of the operation, it is a good idea to notify the user that a potentially long action is underway and provide a progress indicator if possible.</span></span> 
  

