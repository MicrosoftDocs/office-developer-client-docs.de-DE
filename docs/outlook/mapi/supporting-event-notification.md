---
title: Unterstützende Ereignisbenachrichtigung
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a1e3e49c-8d1d-4f7e-ba5a-be441f0f10ae
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 83c102c25b17b6769c0c676bbadd874224f75cf6
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "32327426"
---
# <a name="supporting-event-notification"></a><span data-ttu-id="1d98c-103">Unterstützende Ereignisbenachrichtigung</span><span class="sxs-lookup"><span data-stu-id="1d98c-103">Supporting Event Notification</span></span>

  
  
<span data-ttu-id="1d98c-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="1d98c-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="1d98c-105">Da die Unterstützung der Ereignisbenachrichtigung kompliziert sein kann, stellt MAPI drei Unterstützungsobjektmethoden zur Verfügung, die die schwierigsten Teile des Prozesses implementieren.</span><span class="sxs-lookup"><span data-stu-id="1d98c-105">Because supporting event notification can be complicated, MAPI supplies three support object methods that implement the most difficult parts of the process.</span></span> <span data-ttu-id="1d98c-106">Diese Methoden funktionieren als Einheit, und ein Anbieter muss alle drei oder keine davon verwenden.</span><span class="sxs-lookup"><span data-stu-id="1d98c-106">These methods work as a unit, and a provider must use all three or none of them.</span></span>
  
<span data-ttu-id="1d98c-107">Die MAPI-Supportmethoden verwenden Benachrichtigungsschlüssel, um die Verbindungen zwischen den Ratensenken und den Objekten zu verwalten, die die Benachrichtigungen generieren.</span><span class="sxs-lookup"><span data-stu-id="1d98c-107">The MAPI support methods use notification keys to manage the connections between the advise sinks and the objects that generate the notifications.</span></span> <span data-ttu-id="1d98c-108">Ein Benachrichtigungsschlüssel ist eine [NOTIFKEY-Struktur,](notifkey.md) die Binärdaten enthält, die ein Objekt prozessübergreifend identifizieren.</span><span class="sxs-lookup"><span data-stu-id="1d98c-108">A notification key is a [NOTIFKEY](notifkey.md) structure that contains binary data that identifies an object across processes.</span></span> <span data-ttu-id="1d98c-109">Ein Benachrichtigungsschlüssel wird in der Regel aus der langfristigen Eintrags-ID des advise-Quellobjekts kopiert.</span><span class="sxs-lookup"><span data-stu-id="1d98c-109">A notification key is typically copied from the long-term entry identifier of the advise source object.</span></span> <span data-ttu-id="1d98c-110">Wenn der Client einen Eintragsbezeichner im Aufruf von **"Advise"** angegeben hat, können Sie ihn für den Benachrichtigungsschlüssel verwenden.</span><span class="sxs-lookup"><span data-stu-id="1d98c-110">If the client has supplied an entry identifier in the call to **Advise**, you can use it for the notification key.</span></span> <span data-ttu-id="1d98c-111">Wenn der _zu empfehlende lpEntryID-Parameter_ NULL ist, verwenden Sie die Eintrags-ID des äußerst möglichen Containerobjekts, z. B. des Nachrichtenspeichers. </span><span class="sxs-lookup"><span data-stu-id="1d98c-111">If the  _lpEntryID_ parameter to **Advise** is NULL, use the entry identifier of the outermost possible container object, such as the message store.</span></span> 
  
<span data-ttu-id="1d98c-112">Um die Supportmethoden zu verwenden, rufen Sie [IMAPISupport::Subscribe](imapisupport-subscribe.md) auf, wenn ein Client Ihre **Advise-Methode** aufruft, um sich für eine Benachrichtigung zu registrieren.</span><span class="sxs-lookup"><span data-stu-id="1d98c-112">To use the support methods, call [IMAPISupport::Subscribe](imapisupport-subscribe.md) whenever a client calls your **Advise** method to register for a notification.</span></span> <span data-ttu-id="1d98c-113">Weisen Sie eine [NOTIFKEY-Struktur](notifkey.md) zu, und erstellen Sie einen eindeutigen Benachrichtigungsschlüssel für Ihr Advise-Quellobjekt.</span><span class="sxs-lookup"><span data-stu-id="1d98c-113">Allocate a [NOTIFKEY](notifkey.md) structure and create a unique notification key for your advise source object.</span></span> <span data-ttu-id="1d98c-114">Beispielsweise erstellt ein Nachrichtenspeicheranbieter, der aufgefordert wird, einen Client zu benachrichtigen, wenn eine Nachricht in einem bestimmten Ordner empfangen wird, einen Benachrichtigungsschlüssel für diesen Ordner.</span><span class="sxs-lookup"><span data-stu-id="1d98c-114">For example, a message store provider that is prompted to notify a client when a message is received into a particular folder creates a notification key for that folder.</span></span> <span data-ttu-id="1d98c-115">Übergeben Sie einen Zeiger auf die **NOTIFKEY-Struktur** im Aufruf von **Subscribe** zusammen mit einem Zeiger auf die Ratensenke des Clients.</span><span class="sxs-lookup"><span data-stu-id="1d98c-115">Pass a pointer to the **NOTIFKEY** structure in the call to **Subscribe** along with a pointer to the client's advise sink.</span></span> <span data-ttu-id="1d98c-116">**Subscribe** ruft die [IUnknown::AddRef-Methode](https://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx) der Hinweissenke auf, um die Referenzanzahl zu erhöhen, und MAPI behält den Zeiger bei, bis die Registrierung abgebrochen wird.</span><span class="sxs-lookup"><span data-stu-id="1d98c-116">**Subscribe** calls the advise sink's [IUnknown::AddRef](https://msdn.microsoft.com/library/b4316efd-73d4-4995-b898-8025a316ba63%28Office.15%29.aspx) method to increment its reference count and MAPI retains the pointer until the registration is canceled.</span></span> 
  
<span data-ttu-id="1d98c-117">Sie können das NOTIFY_SYNC-Flag an **Subscribe** übergeben, um an die Anforderung zu senden, dass **Notify** synchron verhält, und erst dann zurückgeben, wenn alle Aufrufe der [IMAPIAdviseSink::OnNotify-Methoden](imapiadvisesink-onnotify.md) registrierter Hinweissenken ausgeführt wurden.</span><span class="sxs-lookup"><span data-stu-id="1d98c-117">You can pass the NOTIFY_SYNC flag to **Subscribe** to request that **Notify** behave synchronously and not return until it has made all calls to the [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md) methods of registered advise sinks.</span></span> <span data-ttu-id="1d98c-118">Legen Sie dieses Flag nur für Ihre eigene interne Verwendung ein.</span><span class="sxs-lookup"><span data-stu-id="1d98c-118">Set this flag only for your own internal use.</span></span> <span data-ttu-id="1d98c-119">Legen Sie sie nicht auf, wenn Sie auf einen Kundenanruf **mit Raten** antworten.</span><span class="sxs-lookup"><span data-stu-id="1d98c-119">Do not set it when you respond to a client **Advise** call.</span></span> <span data-ttu-id="1d98c-120">Die Ereignisbenachrichtigung zwischen Clients und Anbietern ist immer asynchron.</span><span class="sxs-lookup"><span data-stu-id="1d98c-120">Event notification between clients and providers is always asynchronous.</span></span> <span data-ttu-id="1d98c-121">Das heißt, MAPI garantiert, dass der Aufruf, während dem ein Ereignis eintritt, an den Client zurückzukehren, bevor die **OnNotify-Aufrufe** ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="1d98c-121">That is, MAPI guarantees that the call during which an event happens will return to the client before any of the **OnNotify** calls are made.</span></span> 
  
<span data-ttu-id="1d98c-122">Wenn Sie das NOTIFY_SYNC-Flag festlegen, nehmen Sie keine Änderungen an den Objekten der advise sink vor, und übergeben Sie keine wrapper -Hinweissenke, die von [HrThisThreadAdviseSink](hrthisthreadadvisesink.md) für **Subscribe** erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="1d98c-122">If you set the NOTIFY_SYNC flag, do not make any changes to any of the advise sink objects, and do not pass a wrapper advise sink created by [HrThisThreadAdviseSink](hrthisthreadadvisesink.md) to **Subscribe**.</span></span> <span data-ttu-id="1d98c-123">**HrThisThreadAdviseSink** erstellt eine threadsichere Version einer Ratensenke, die nur mit asynchroner Benachrichtigung verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="1d98c-123">**HrThisThreadAdviseSink** creates a thread-safe version of an advise sink to be used with asynchronous notification only.</span></span> 
  
<span data-ttu-id="1d98c-124">Wenn eine für synchrone Benachrichtigungen registrierte Hinweissenke von **OnNotify** mit dem CALLBACK_DISCONTINUE-Flagsatz zurückgibt, legt [IMAPISupport::Notify](imapisupport-notify.md) das flag NOTIFY_CANCELED fest und gibt zurück, ohne **OnNotify** zu aufrufen.</span><span class="sxs-lookup"><span data-stu-id="1d98c-124">If an advise sink registered for synchronous notification returns from **OnNotify** with the CALLBACK_DISCONTINUE flag set, [IMAPISupport::Notify](imapisupport-notify.md) sets the NOTIFY_CANCELED flag and returns without making any calls to **OnNotify**.</span></span> 
  
<span data-ttu-id="1d98c-125">Nachdem **Subscribe** zurückgegeben wurde, müssen Sie ihre Kopie der Kunden-Ratensenke nicht mehr halten.</span><span class="sxs-lookup"><span data-stu-id="1d98c-125">Once **Subscribe** has returned, you will no longer have any need to hold onto your copy of the client's advise sink.</span></span> <span data-ttu-id="1d98c-126">Rufen Sie die [IUnknown::Release-Methode auf, um](https://msdn.microsoft.com/library/4b494c6f-f0ee-4c35-ae45-ed956f40dc7a%28Office.15%29.aspx) sie frei zu geben.</span><span class="sxs-lookup"><span data-stu-id="1d98c-126">Call its [IUnknown::Release](https://msdn.microsoft.com/library/4b494c6f-f0ee-4c35-ae45-ed956f40dc7a%28Office.15%29.aspx) method to release it.</span></span> <span data-ttu-id="1d98c-127">**Subscribe** gibt eine Verbindungsnummer ungleich Null zurück, die Sie an den Client zurückgeben sollten.</span><span class="sxs-lookup"><span data-stu-id="1d98c-127">**Subscribe** returns a nonzero connection number that you should return to the client.</span></span> <span data-ttu-id="1d98c-128">Die Verbindungsnummer stellt den Link zwischen der Quelle "Advise" und der "Advise"-Senke dar.</span><span class="sxs-lookup"><span data-stu-id="1d98c-128">The connection number represents the link between the advise source and the advise sink.</span></span> <span data-ttu-id="1d98c-129">Er bleibt gültig, bis der Client **unadvise erfolgreich aufruft.**</span><span class="sxs-lookup"><span data-stu-id="1d98c-129">It remains valid until the client makes a successful call to **Unadvise**.</span></span> 
  
<span data-ttu-id="1d98c-130">Wenn der Client bereit ist, eine Registrierung abbricht, ruft er Ihre **Unadvise-Methode** auf.</span><span class="sxs-lookup"><span data-stu-id="1d98c-130">When the client is ready to cancel a registration, it calls your **Unadvise** method.</span></span> <span data-ttu-id="1d98c-131">Übergeben Sie die Verbindungsnummer aus dem **Unadvise-Aufruf** an [IMAPISupport::Unsubscribe](imapisupport-unsubscribe.md).</span><span class="sxs-lookup"><span data-stu-id="1d98c-131">Pass the connection number from the **Unadvise** call to [IMAPISupport::Unsubscribe](imapisupport-unsubscribe.md).</span></span> <span data-ttu-id="1d98c-132">**Unsubscribe** ruft die **IUnknown::Release-Methode der** Ratensenke auf.</span><span class="sxs-lookup"><span data-stu-id="1d98c-132">**Unsubscribe** calls the advise sink's **IUnknown::Release** method.</span></span> <span data-ttu-id="1d98c-133">Wie bei **Advise** und **Unadvise** müssen Anrufe zum **Abonnieren** und **Abmelden** gekoppelt werden.</span><span class="sxs-lookup"><span data-stu-id="1d98c-133">As with **Advise** and **Unadvise**, calls to **Subscribe** and **Unsubscribe** must be paired.</span></span> <span data-ttu-id="1d98c-134">Sie müssen für jeden **Anruf,** der zum Abonnieren erfolgt, einen Aufruf zum Abmelden **von machen.**</span><span class="sxs-lookup"><span data-stu-id="1d98c-134">You must make one call to **Unsubscribe** for every call that is made to **Subscribe**.</span></span> <span data-ttu-id="1d98c-135">Sie müssen jedoch nicht jedes Mal **Abonnieren** aufrufen, wenn Ihre **Advise-Methode** aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="1d98c-135">However, you do not have to call **Subscribe** every time your **Advise** method is called.</span></span> <span data-ttu-id="1d98c-136">Umgekehrt können Sie es zum Einrichten interner Benachrichtigungen aufrufen.</span><span class="sxs-lookup"><span data-stu-id="1d98c-136">Conversely, you can call it for setting up internal notifications.</span></span> 
  
<span data-ttu-id="1d98c-137">Wenn ein Ereignis auftritt, weisen Sie mindestens eine [BENACHRICHTIGUNGsstruktur](notification.md) des für das Ereignis geeigneten Typs zu, und rufen [Sie IMAPISupport::Notify auf.](imapisupport-notify.md)</span><span class="sxs-lookup"><span data-stu-id="1d98c-137">When an event occurs, allocate one or more [NOTIFICATION](notification.md) structures of the type appropriate for the event and call [IMAPISupport::Notify](imapisupport-notify.md).</span></span> <span data-ttu-id="1d98c-138">**Notify** generiert eine Benachrichtigung für jede registrierte Hinweissenke.</span><span class="sxs-lookup"><span data-stu-id="1d98c-138">**Notify** generates a notification for each registered advise sink.</span></span> <span data-ttu-id="1d98c-139">Sie sollten alle nicht verwendeten Elemente der [NOTIFICATION-Struktur](notification.md) auf Null festlegen.</span><span class="sxs-lookup"><span data-stu-id="1d98c-139">You should set all the unused members of the [NOTIFICATION](notification.md) structure to zero.</span></span> <span data-ttu-id="1d98c-140">Diese Technik zum Initialisieren der **NOTIFICATION-Struktur** kann Clients dabei helfen, kleinere, schnellere und weniger fehleranfällige **OnNotify-Implementierungen zu** erstellen.</span><span class="sxs-lookup"><span data-stu-id="1d98c-140">This technique for initializing the **NOTIFICATION** structure can help clients create smaller, faster, and less error-prone **OnNotify** implementations.</span></span> 
  
<span data-ttu-id="1d98c-141">Beachten **Sie,** dass für jedes Ereignis eine separate NOTIFICATION-Struktur erforderlich ist, auch für mehrere Ereignisse desselben Typs.</span><span class="sxs-lookup"><span data-stu-id="1d98c-141">Note that a separate **NOTIFICATION** structure is necessary for each event, even for multiple events of the same type.</span></span> <span data-ttu-id="1d98c-142">Wenn beispielsweise drei Clients für tabellenbenachrichtigungen in einer bestimmten Tabelle registriert sind und  der Tabelle fünf Zeilen hinzugefügt werden, müssen Sie fünf OBJECT_NOTIFICATION für Ihren Notify-Aufruf **erstellen.**</span><span class="sxs-lookup"><span data-stu-id="1d98c-142">For example, if three clients are registered for table notification on a particular table and five rows are added to the table, you must create five **OBJECT_NOTIFICATION** structures for your **Notify** call.</span></span> <span data-ttu-id="1d98c-143">Eine Batchbenachrichtigung wie diese führt zu einer besseren Leistung als das Fünffache des Aufrufs **von Notify.**</span><span class="sxs-lookup"><span data-stu-id="1d98c-143">A batch notification such as this results in better performance than calling **Notify** five times.</span></span> <span data-ttu-id="1d98c-144">Für jeden **Notify-Aufruf** ruft MAPI die [IMAPIAdviseSink::OnNotify-Methode](imapiadvisesink-onnotify.md) jeder registrierten Ratensenke auf.</span><span class="sxs-lookup"><span data-stu-id="1d98c-144">For each **Notify** call, MAPI calls the [IMAPIAdviseSink::OnNotify](imapiadvisesink-onnotify.md) method of every registered advise sink.</span></span> <span data-ttu-id="1d98c-145">Wenn es keine registrierten Ratensenken gibt, ignoriert MAPI den Anruf.</span><span class="sxs-lookup"><span data-stu-id="1d98c-145">If there are no registered advise sinks, MAPI ignores the call.</span></span> 
  
<span data-ttu-id="1d98c-146">Dienstanbieter, die Batchbenachrichtigungen senden, müssen diese so bestellen, dass sie von der ersten bis zur letzten Benachrichtigung interpretiert werden können.</span><span class="sxs-lookup"><span data-stu-id="1d98c-146">Service providers that send batched notifications must order them so that they can be interpreted from the first notification to the last.</span></span> <span data-ttu-id="1d98c-147">Diese Reihenfolge ist besonders erforderlich, wenn ein Benachrichtigungsbatch eine Reihe von Ereignissen enthält, z. B. TABLE_ROW_ADDED mit einem Ereignis, das auf eine vorherige Zeile verweist, die in einem anderen Ereignis im gleichen Batch hinzugefügt wurde.</span><span class="sxs-lookup"><span data-stu-id="1d98c-147">This ordering is especially necessary when a notification batch contains a series of events, such as TABLE_ROW_ADDED with one event that refers to a prior row that was added in another event in the same batch.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="1d98c-148">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="1d98c-148">See also</span></span>



[<span data-ttu-id="1d98c-149">MAPI-Dienstanbieter</span><span class="sxs-lookup"><span data-stu-id="1d98c-149">MAPI Service Providers</span></span>](mapi-service-providers.md)

