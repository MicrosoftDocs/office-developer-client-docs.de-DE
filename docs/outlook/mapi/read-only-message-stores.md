---
title: Read-Only Nachrichtenspeicher
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 752ff2d6-ca64-4507-adf1-4c054c321203
description: 'Letzte �nderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 957a7f92963b97e5421bc801a3b046f098d6a08e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33405338"
---
# <a name="read-only-message-stores"></a><span data-ttu-id="2dec1-103">Read-Only Nachrichtenspeicher</span><span class="sxs-lookup"><span data-stu-id="2dec1-103">Read-Only Message Stores</span></span>

  
  
<span data-ttu-id="2dec1-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="2dec1-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="2dec1-p101">Ein Nachrichtenspeicher schreibgesch�tzt ist eine in die weder der MAPI-Client noch die MAPI-Warteschlange kann erstellen, �ndern oder l�schen Sie die Objekte im Nachrichtenspeicher. Es gibt viele Gr�nde, warum Sie m�glicherweise einen schreibgesch�tzten Nachrichtenspeicher implementieren m�chten. Beispielsweise konnte Credit reporting Firma einen nur-Lese-Speicher verwenden, um die Kunden oder Mitarbeiter finden Sie unter aber nicht �ndern einzelne Credit Berichte zu erm�glichen. Stellen Sie einen schreibgesch�tzten Nachrichtenspeicher Auswahl hat Auswirkungen auf f�r die Struktur des Anbieters und der Store selbst abzurufen. Beispielsweise ein Nachrichtenspeicher schreibgesch�tzt sind keinen Ordner Postausgang, da dann MAPI-Clients w�rde anfordern, dass neue ausgehende Nachrichten in diesem Ordner erstellt werden. In �hnlicher Weise ist es vom Informationsdienst daf�r verantwortlich, die Integrit�t der zugrunde liegende Speichermechanismus sicherzustellen.</span><span class="sxs-lookup"><span data-stu-id="2dec1-p101">A read-only message store is one in which neither the MAPI client nor the MAPI spooler can create, modify, or delete the objects in the message store. There are many reasons why you might want to implement a read-only message store. For example, a credit reporting firm could use a read-only store to allow its customers or employees to see but not change individual credit reports. Choosing to make a read-only message store has implications for the structure of the store provider and for the store itself. For example, a read-only message store cannot have an Outbox folder, because then MAPI clients would request that new outgoing messages be created in that folder. Similarly, it is the store provider's responsibility to ensure the integrity of the underlying storage mechanism.</span></span>
  
<span data-ttu-id="2dec1-111">Es gibt drei Kennzeichen, die in der **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) des Nachrichtenspeichers festgelegt werden können, die unterschiedliche schreibgeschützte Zugriffsebenen unterstützen.</span><span class="sxs-lookup"><span data-stu-id="2dec1-111">There are three flags that can be set in the message store's **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property that support different levels of read-only access.</span></span> <span data-ttu-id="2dec1-112">The STORE_READONLY flag indicates that all [IMAPIProp: IUnknown](imapipropiunknown.md) interfaces on objects in the message store are read-only.</span><span class="sxs-lookup"><span data-stu-id="2dec1-112">The STORE_READONLY flag indicates that all [IMAPIProp : IUnknown](imapipropiunknown.md) interfaces on objects in the message store are read-only.</span></span> <span data-ttu-id="2dec1-113">The STORE_MODIFY_OK flag indicates that existing messages in the message store may be modified, but new folders and messages may not be created.</span><span class="sxs-lookup"><span data-stu-id="2dec1-113">The STORE_MODIFY_OK flag indicates that existing messages in the message store may be modified, but new folders and messages may not be created.</span></span> <span data-ttu-id="2dec1-114">The STORE_CREATE_OK flag indicates that new messages and folders may be created, but indicates nothing about whether existing objects may be modified.</span><span class="sxs-lookup"><span data-stu-id="2dec1-114">The STORE_CREATE_OK flag indicates that new messages and folders may be created, but indicates nothing about whether existing objects may be modified.</span></span> 
  
<span data-ttu-id="2dec1-p103">Die Tatsache, dass MAPI-Clients und die MAPI-Warteschlange nicht m�glich ist, erstellen, �ndern oder L�schen von Objekten im Nachrichtenspeicher bedeutet nicht, dass den Inhalt der zugrunde liegende Speichermechanismus niemals �ndern. Noch bedeutet dies, dass Ihre Speicheranbieter nie Berechtigung in der zugrunde liegende Speichermechanismus zu schreiben muss. In einigen F�llen k�nnen diese beiden Bedingungen anwenden, jedoch nicht im Allgemeinen einer nur-Lese-Nachricht speichern. Die Zugriffsebene, dass ein Speicheranbieter erfordert und ob ein Speicheranbieter jemals Daten in der zugrunde liegende Speichermechanismus �ndert h�ngt im Wesentlichen die Art der einen Speicheranbieter.</span><span class="sxs-lookup"><span data-stu-id="2dec1-p103">The fact that MAPI clients and the MAPI spooler may not be able to create, modify, or delete objects in the message store does not mean that the contents of the underlying storage mechanism never change. Nor does it mean that your store provider never needs write permission to the underlying storage mechanism. In some circumstances those two conditions may apply, but not in the general case of a read-only message store. The level of access that your store provider requires and whether or not your store provider ever changes data in the underlying storage mechanism depends mainly on the specific nature of your store provider.</span></span>
  
<span data-ttu-id="2dec1-p104">Beispielsweise wenn Sie einen Anbieter anmelden, um MAPI-Clients Zugriff auf eine Datenbank auf einem CD-ROM-Ger�t gew�hren schreiben, der zugrunde liegende Speichermechanismus kann nicht ge�ndert werden und ein Speicheranbieter Leseberechtigung daf�r haben kann. Wenn jedoch Sie einen Anbieter anmelden schreiben, um MAPI-Clients schreibgesch�tzten Zugriff auf �ffentliche Ordner-Datenbank zu erm�glichen, Speicheranbieter muss jedoch zum Nachverfolgen von Nachrichten f�r jeden Benutzer, den gelesen/ungelesen Status m�ssen vom Informationsdienst neue Daten in der zugrunde liegende Speichermechanismus zu schreiben. Jedoch ist weder Beispiel Speicheranbieter jemals erforderlich, erstellen, �ndern oder L�schen von Ordnern und Nachrichten an die Anforderung des MAPI-Clients oder die MAPI-Warteschlange.</span><span class="sxs-lookup"><span data-stu-id="2dec1-p104">For example, if you are writing a store provider to give MAPI clients access to a database stored on a CD-ROM device, the underlying storage mechanism cannot change and your store provider can have read-only permission for it. If, however, you are writing a store provider to give MAPI clients read-only access to a public folder database, but the store provider needs to keep track of the read/unread status of messages for each user, the store provider will need to write new data to the underlying storage mechanism. However, in neither example does the store provider ever have to create, modify, or delete folders or messages at the request of MAPI clients or the MAPI spooler.</span></span>
  
<span data-ttu-id="2dec1-122">Die kleine Gruppe von Gr�nde, die ein Anbieter anmelden muss Daten in eine zugrunde liegende Speichermechanismus zu schreiben, die andernfalls schreibgesch�tzt ist, lautet wie folgt:</span><span class="sxs-lookup"><span data-stu-id="2dec1-122">The short list of reasons that a store provider would need to write data to an underlying storage mechanism that is otherwise read-only is as follows:</span></span>
  
- <span data-ttu-id="2dec1-123">Gelesen/ungelesen Status von Nachrichten gespeichert.</span><span class="sxs-lookup"><span data-stu-id="2dec1-123">To store the read/unread status of messages.</span></span>
    
- <span data-ttu-id="2dec1-124">Lese-/Nonread Benachrichtigungen zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="2dec1-124">To implement read/nonread notifications.</span></span> 
    
- <span data-ttu-id="2dec1-125">Zum Speichern von Ansichten.</span><span class="sxs-lookup"><span data-stu-id="2dec1-125">To store views.</span></span>
    
- <span data-ttu-id="2dec1-126">Best�ndige Indizes f�r benutzerdefinierte Ordner Sortierreihenfolgen zwischengespeichert.</span><span class="sxs-lookup"><span data-stu-id="2dec1-126">To cache persistent indexes for user-defined folder sort orders.</span></span>
    
- <span data-ttu-id="2dec1-127">To store the sort order of a folder's contents (supporting [IMAPIFolder::SaveContentsSort](imapifolder-savecontentssort.md)).</span><span class="sxs-lookup"><span data-stu-id="2dec1-127">To store the sort order of a folder's contents (supporting [IMAPIFolder::SaveContentsSort](imapifolder-savecontentssort.md)).</span></span>
    
- <span data-ttu-id="2dec1-128">To store search criteria, search state, and results, if the message store provider supports searches (supporting [IMAPIContainer::SetSearchCriteria](imapicontainer-setsearchcriteria.md)).</span><span class="sxs-lookup"><span data-stu-id="2dec1-128">To store search criteria, search state, and results, if the message store provider supports searches (supporting [IMAPIContainer::SetSearchCriteria](imapicontainer-setsearchcriteria.md)).</span></span>
    
<span data-ttu-id="2dec1-p105">Wenn Ihre Nachricht Speicheranbieter nie Daten in der zugrunde liegende Speichermechanismus schreiben kann, m�ssen sie diese Features mithilfe eines separaten Speichermechanismus au�erhalb der zugrunde liegende Speichermechanismus implementieren. Beispielsweise k�nnte ein Anbieter f�r schreibgesch�tzte Nachricht anmelden gelesen/ungelesen Status von Nachrichten in den Speicher in einer Datei auf dem Computer des Benutzers speichern. Diese Strategie stellt zus�tzliche Schwierigkeiten aber m�glicherweise nur anteilm��ige wie f�r schreibgesch�tzte Nachricht Anbieter einige Funktionen zu implementieren. Halten den Inhalt des separater Speichervolumes Mechanismus mit den Objekten im Nachrichtenspeicher synchronisiert ist beispielsweise schwieriger als das Speichern des gelesen/ungelesen Status direkt in der Nachricht-Store selbst abzurufen.</span><span class="sxs-lookup"><span data-stu-id="2dec1-p105">If your message store provider can never write data to the underlying storage mechanism, it will need to implement these features by using a separate storage mechanism outside of the underlying storage mechanism. For example, a read-only message store provider could store the read/unread status of messages in the store in a file on the user's computer. This strategy presents additional difficulties but may be the only feasable way for read-only message store providers to implement some features. For example, keeping the contents of the separate storage mechanism synchronized with the objects in the message store is more difficult than storing the read/unread status directly in the message store itself.</span></span>
  
<span data-ttu-id="2dec1-133">Suche bietet eine zus�tzliche Schwierigkeit f�r schreibgesch�tzte Nachricht-Anbieter.</span><span class="sxs-lookup"><span data-stu-id="2dec1-133">Searching presents an additional complication for read-only message store providers.</span></span> <span data-ttu-id="2dec1-134">Clients verwenden den Ordner, der in der **PR_FINDER_ENTRYID** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md)) des Nachrichtenspeicherobjekts angegeben ist, um den Ordner zu finden, der für Suchergebnisse verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="2dec1-134">Clients use the folder specified in the message store object's **PR_FINDER_ENTRYID** ([PidTagFinderEntryId](pidtagfinderentryid-canonical-property.md)) property to locate the folder used for search results.</span></span> <span data-ttu-id="2dec1-135">Schreibgesch�tzte Nachricht Anbieter installieren nicht h�ufig einen Ordner permanent Suchergebnisse in die Nachrichtenspeicher.</span><span class="sxs-lookup"><span data-stu-id="2dec1-135">Read-only message store providers often cannot install a permanent search-results folder into the message store.</span></span> <span data-ttu-id="2dec1-136">In diesem Fall sollte der Nachricht Informationsdienst einen Eintrag Bezeichner in der **PR_FINDER_ENTRYID** -Eigenschaft speichern, die es erkennen kann, wenn Clients Ordner �ffnen, sodass es einen Suchergebnisse Ordner anstelle von Lesen aus der zugrunde liegende Speichermechanismus dynamisch erstellen kann.</span><span class="sxs-lookup"><span data-stu-id="2dec1-136">In that situation, the message store provider should store an entry identifier in the **PR_FINDER_ENTRYID** property that it can recognize when clients open folders so that it can dynamically create a search-results folder instead of reading one from the underlying storage mechanism.</span></span> <span data-ttu-id="2dec1-137">Da viele schreibgesch�tzte Nachricht Anbieter dynamisch allen Ordnern zu erstellen, ist dies jedoch in der Regel nicht zu viel in der Regel.</span><span class="sxs-lookup"><span data-stu-id="2dec1-137">However, because many read-only message store providers create all their folders dynamically, this is usually not too much of a burden.</span></span> 
  
<span data-ttu-id="2dec1-p107">In das Store-Anbieter-Objekt **PR_STORE_SUPPORT_MASK** -Eigenschaft ist die Tatsache, dass Ihre Nachricht Speicheranbieter schreibgesch�tzt ist angek�ndigt. Z�hlen Sie jedoch nicht auf Clients ber�cksichtigen diese Eigenschaft; einen Speicheranbieter Code sollte den schreibgesch�tzten Status der zugrunde liegende Speichermechanismus erzwingen.</span><span class="sxs-lookup"><span data-stu-id="2dec1-p107">The fact that your message store provider is read-only is advertised in the store provider object's **PR_STORE_SUPPORT_MASK** property. However, do not count on clients to respect that property; your store provider's code should enforce the read-only status of the underlying storage mechanism.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="2dec1-140">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="2dec1-140">See also</span></span>



[<span data-ttu-id="2dec1-141">Entwickeln eines MAPI-Nachrichtenspeicheranbieters</span><span class="sxs-lookup"><span data-stu-id="2dec1-141">Developing a MAPI Message Store Provider</span></span>](developing-a-mapi-message-store-provider.md)

