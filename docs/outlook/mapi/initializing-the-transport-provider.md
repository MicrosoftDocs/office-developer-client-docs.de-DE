---
title: Initialisieren des Transportanbieters
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 977c18ce-ece5-4ad1-ac97-5a680846ab83
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 474a8085ca8b82d11efd68c9fd4d8719fe239207
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33416601"
---
# <a name="initializing-the-transport-provider"></a><span data-ttu-id="11221-103">Initialisieren des Transportanbieters</span><span class="sxs-lookup"><span data-stu-id="11221-103">Initializing the Transport Provider</span></span>

  
  
<span data-ttu-id="11221-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="11221-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="11221-105">Die Transport-Spooler-Schnittstelle definiert Aufrufe, die der MAPI-Spooler an einen Transportanbieter macht.</span><span class="sxs-lookup"><span data-stu-id="11221-105">The transport-spooler interface defines calls the MAPI spooler makes to a transport provider.</span></span> <span data-ttu-id="11221-106">Transportanbieter implementieren diese Routinen in einer Dynamic Link Library (DLL).</span><span class="sxs-lookup"><span data-stu-id="11221-106">Transport providers implement these routines in a dynamic-link library (DLL).</span></span> <span data-ttu-id="11221-107">Der erste direkte Einstiegspunkt in die DLL, die vom MAPI-Spooler verwendet wird, muss die Initialisierungsfunktion des Transportanbieters [XPProviderInit sein.](xpproviderinit.md)</span><span class="sxs-lookup"><span data-stu-id="11221-107">The first direct entry point into the DLL used by the MAPI spooler must be the transport provider initialization function [XPProviderInit](xpproviderinit.md).</span></span>
  
<span data-ttu-id="11221-108">MAPI verwendet die Routine **GetProcAddress,** um die Adresse der Initialisierungsroutine des Dienstanbieters zu erhalten und diese Routine dann auf aufruft.</span><span class="sxs-lookup"><span data-stu-id="11221-108">MAPI uses the routine **GetProcAddress** to get the address of the service provider's initialization routine and then calls that routine.</span></span> <span data-ttu-id="11221-109">Der Name der Initialisierungsroutine ist **XPProviderInit** für Transportanbieter.</span><span class="sxs-lookup"><span data-stu-id="11221-109">The name of the initialization routine is **XPProviderInit** for transport providers.</span></span> <span data-ttu-id="11221-110">Bei anderen Typen von MAPI-Dienstanbietern ist dies unterschiedlich, sodass eine DLL eine beliebige Kombination von Dienstanbietertypen enthalten kann, jedoch nur einen Dienstanbieter eines bestimmten Typs.</span><span class="sxs-lookup"><span data-stu-id="11221-110">It is different for other types of MAPI service providers so that one DLL can contain any combination of service provider types, but only one service provider of a particular type.</span></span> <span data-ttu-id="11221-111">Ein Dienstanbieter eines bestimmten Typs kann jedoch mehrere Dienste seines Typs implementieren.</span><span class="sxs-lookup"><span data-stu-id="11221-111">However, one service provider of a given type can implement multiple services of its type.</span></span> <span data-ttu-id="11221-112">Beispielsweise kann ein Transportanbieter die Nachrichtentransportfunktionalität in mehrere Nachrichtendienste implementieren.</span><span class="sxs-lookup"><span data-stu-id="11221-112">For example, one transport provider can implement message transport functionality to multiple message services.</span></span> 
  
<span data-ttu-id="11221-113">Die mapispi.h-Headerdatei verfügt über eine Typdefinition für den Funktionsprototyp der Initialisierungsfunktion des Transportanbieters und einen vordefinierten Prozedurnamen dafür.</span><span class="sxs-lookup"><span data-stu-id="11221-113">The mapispi.h header file has a type definition for the function prototype of the transport provider initialization function, and a predefined procedure name for it.</span></span> <span data-ttu-id="11221-114">Indem Sie die Initialisierungsroutinen in Ihren C- und C++-Dateien mit denselben Namen benennen, die von **GetProcAddress** verwendet werden, und mithilfe einer einfachen Exportdeklaration in Ihrer DLL.DEF-Datei erhalten Sie automatisch die Typüberprüfung der Parameter in Ihrer Initialisierungsroutine.</span><span class="sxs-lookup"><span data-stu-id="11221-114">By naming the initialization routines in your C and C++ files with the same names used by **GetProcAddress** and by using a straightforward export declaration in your DLL.DEF file, you automatically get type checking of the parameters on your initialization routine.</span></span> <span data-ttu-id="11221-115">Beispiele finden Sie im Quellcode des Transportanbieters.</span><span class="sxs-lookup"><span data-stu-id="11221-115">See the sample transport provider source code for examples.</span></span> <span data-ttu-id="11221-116">Weitere Informationen finden Sie unter [Transport Provider Sample](transport-provider-sample.md).</span><span class="sxs-lookup"><span data-stu-id="11221-116">For more information, see [Transport Provider Sample](transport-provider-sample.md).</span></span>
  
<span data-ttu-id="11221-117">Wenn der Initialisierungsaufruf eines Dienstanbieters erfolgreich ist, aber eine Versionsnummer der Dienstanbieterschnittstelle zurückgibt, die zu klein ist, damit MAPI verarbeiten kann, ruft MAPI sofort die **Release-Methode** des Dienstanbieterobjekts auf und geht so vor, als wäre der Initialisierungsaufruf mit MAPI_E_VERSION.</span><span class="sxs-lookup"><span data-stu-id="11221-117">If a service provider's initialization call succeeds but returns a service provider interface version number too small for MAPI to handle, MAPI immediately calls the **Release** method of the service provider object and proceeds as if the initialization call had failed with MAPI_E_VERSION.</span></span> <span data-ttu-id="11221-118">Auf diese Weise definieren MAPI und der Dienstanbieter gemeinsam den Bereich der Dienstanbieterschnittstellenversionsnummern, die sie verarbeiten können, und wenn nichts mit dem Dienstanbieter zu tun hat, schlägt das Laden des Dienstanbieters mit einem MAPI_E_VERSION fehl.</span><span class="sxs-lookup"><span data-stu-id="11221-118">This way MAPI and the service provider jointly define the range of service provider interface version numbers they can handle, and if nothing matches then service provider loading fails with a MAPI_E_VERSION return value.</span></span> 
  
<span data-ttu-id="11221-119">Der letzte Schritt für den MAPI-Spooler beim Abrufen des Zugriffs auf Dienstanbieterressourcen besteht in der Anmeldung beim Transportanbieter.</span><span class="sxs-lookup"><span data-stu-id="11221-119">The last step for the MAPI spooler in getting access to service provider resources is to log on to the transport provider.</span></span> <span data-ttu-id="11221-120">Der MAPI-Spooler ruft die [IXPProvider::TransportLogon-Methode](ixpprovider-transportlogon.md) des [IXPProvider : IUnknown-Objekts](ixpprovideriunknown.md) auf, das von **XPProviderInit** zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="11221-120">The MAPI spooler calls the [IXPProvider::TransportLogon](ixpprovider-transportlogon.md) method of the [IXPProvider : IUnknown](ixpprovideriunknown.md) object returned from **XPProviderInit**.</span></span> <span data-ttu-id="11221-121">Dies ist der Aufruf, bei dem Anmeldeinformationen aktiviert werden und Dialogfelder zulässig sind.</span><span class="sxs-lookup"><span data-stu-id="11221-121">This is the call where credentials, if used, are checked and dialog boxes can be allowed.</span></span>
  
<span data-ttu-id="11221-122">Wenn ein Prozess eine zweite Transportsitzung für denselben Transportanbieter und die gleiche MAPI-Sitzung öffnet, sollte die Transportanbieter-DLL kein zweites Anbieterobjekt erstellen.</span><span class="sxs-lookup"><span data-stu-id="11221-122">If a process opens a second transport session on the same transport provider and MAPI session, the transport provider DLL should not create a second provider object.</span></span> <span data-ttu-id="11221-123">Das erste Anbieterobjekt sollte zum Anmelden bei der zweiten Transportsitzung verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="11221-123">The first provider object should be used to log on to the second transport session.</span></span> <span data-ttu-id="11221-124">Ein Transportanbieter sollte so programmiert werden, dass mehrere Transportsitzungen in einem einzelnen Anbieterobjekt unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="11221-124">A transport provider should be programmed to support multiple transport sessions in a single provider object.</span></span> <span data-ttu-id="11221-125">Ein zweites Anbieterobjekt sollte nur erstellt werden, wenn unterschiedliche MAPI-Sitzungen im gleichen Prozess verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="11221-125">A second provider object should only be created if different MAPI sessions are used in the same process.</span></span>
  

