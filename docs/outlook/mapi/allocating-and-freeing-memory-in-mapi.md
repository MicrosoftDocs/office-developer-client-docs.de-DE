---
title: Zuordnen und Freispeichern in MAPI
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: e238f6bc-e9f6-4ea4-a2e4-ff5da2a04bd5
description: 'Letzte Änderung: Montag, 9. März 2015'
ms.openlocfilehash: 68250c5cbeaa366ed4555bb469c4e68d62302f28
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33419667"
---
# <a name="allocating-and-freeing-memory-in-mapi"></a><span data-ttu-id="0bf67-103">Zuordnen und Freispeichern in MAPI</span><span class="sxs-lookup"><span data-stu-id="0bf67-103">Allocating and Freeing Memory in MAPI</span></span>

  
  
<span data-ttu-id="0bf67-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="0bf67-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="0bf67-105">Neben der Angabe, wie Arbeitsspeicher zugewiesen und frei gemacht werden soll, definiert MAPI ein Modell, um zu wissen, wann der zwischen methoden der öffentlichen Schnittstelle und API-Funktionsaufrufen übergebene Arbeitsspeicher frei werden soll.</span><span class="sxs-lookup"><span data-stu-id="0bf67-105">In addition to specifying how to allocate and free memory, MAPI defines a model for knowing when memory passed between public interface method and API function calls should be freed.</span></span> <span data-ttu-id="0bf67-106">Das Modell gilt nur für Denkspeicher, der für Parameter reserviert ist, die keine Zeiger auf Schnittstellen sind, z. B. Zeichenfolgen und Zeiger auf Strukturen.</span><span class="sxs-lookup"><span data-stu-id="0bf67-106">The model applies only to memory allocated for parameters that are not pointers to interfaces, such as strings and pointers to structures.</span></span> <span data-ttu-id="0bf67-107">Schnittstellenzeiger verwenden den Referenzzählmechanismus, der über **IUnknown implementiert wurde.**</span><span class="sxs-lookup"><span data-stu-id="0bf67-107">Interface pointers use the reference counting mechanism implemented through **IUnknown**.</span></span> <span data-ttu-id="0bf67-108">Verwenden Sie beim Zuweisen und Freispeichern von nicht MAPI-bezogenen Arbeitsspeicher intern innerhalb einer Clientanwendung oder eines Dienstanbieters jeden Mechanismus, der sinnvoll ist.</span><span class="sxs-lookup"><span data-stu-id="0bf67-108">When allocating and freeing non-MAPI related memory internally within a client application or service provider, use whatever mechanism makes sense.</span></span> 
  
<span data-ttu-id="0bf67-109">Das Modell definiert Parameter als einen von drei Typen.</span><span class="sxs-lookup"><span data-stu-id="0bf67-109">The model defines parameters as one of three types.</span></span> <span data-ttu-id="0bf67-110">Dies können Eingabeparameter sein, die vom Aufrufer mit Informationen festgelegt werden, die von der aufgerufenen Funktion oder Methode verwendet werden sollen, Ausgabeparameter, die von der aufgerufenen Funktion oder Methode festgelegt und an den Aufrufer zurückgegeben werden, oder Eingabeausgabeparameter, eine Kombination der beiden Typen.</span><span class="sxs-lookup"><span data-stu-id="0bf67-110">They can be input parameters, set by the caller with information to be used by the called function or method, output parameters, set by the called function or method and returned to the caller, or input-output parameters, a combination of the two types.</span></span> <span data-ttu-id="0bf67-111">Ausgabeparameter sind häufig Zeiger auf Daten oder Zeiger auf Zeiger auf Daten.</span><span class="sxs-lookup"><span data-stu-id="0bf67-111">Output parameters are frequently pointers to data or pointers to pointers to data.</span></span> <span data-ttu-id="0bf67-112">Obwohl die aufgerufene Funktion für die Zuordnung der Daten für Ausgabeparameter verantwortlich ist, weist der Aufrufer den Arbeitsspeicher für den Zeiger zu.</span><span class="sxs-lookup"><span data-stu-id="0bf67-112">Although the called function is responsible for allocating the data for output parameters, the caller allocates the memory for the pointer.</span></span> 
  
<span data-ttu-id="0bf67-113">Die Regeln zum Zuordnen und Freigeben von Arbeitsspeicher für diese Parametertypen werden in der folgenden Tabelle erläutert.</span><span class="sxs-lookup"><span data-stu-id="0bf67-113">The rules for allocating and releasing memory for these types of parameters are explained in the following table.</span></span>
  
|<span data-ttu-id="0bf67-114">**Typ**</span><span class="sxs-lookup"><span data-stu-id="0bf67-114">**Type**</span></span>|<span data-ttu-id="0bf67-115">**Speicherzuordnung**</span><span class="sxs-lookup"><span data-stu-id="0bf67-115">**Memory allocation**</span></span>|<span data-ttu-id="0bf67-116">**Speicherversion**</span><span class="sxs-lookup"><span data-stu-id="0bf67-116">**Memory release**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="0bf67-117">Input</span><span class="sxs-lookup"><span data-stu-id="0bf67-117">Input</span></span>  <br/> |<span data-ttu-id="0bf67-118">Der Anrufer ist verantwortlich und kann einen beliebigen Mechanismus verwenden.</span><span class="sxs-lookup"><span data-stu-id="0bf67-118">Caller is responsible and can use any mechanism.</span></span>  <br/> |<span data-ttu-id="0bf67-119">Der Anrufer ist verantwortlich und kann einen beliebigen Mechanismus verwenden.</span><span class="sxs-lookup"><span data-stu-id="0bf67-119">Caller is responsible and can use any mechanism.</span></span>  <br/> |
|<span data-ttu-id="0bf67-120">Ausgabe</span><span class="sxs-lookup"><span data-stu-id="0bf67-120">Output</span></span>  <br/> |<span data-ttu-id="0bf67-121">Die aufgerufene Funktion ist verantwortlich und muss **MAPIAllocateBuffer verwenden.**</span><span class="sxs-lookup"><span data-stu-id="0bf67-121">Called function is responsible and must use **MAPIAllocateBuffer**.</span></span> <span data-ttu-id="0bf67-122">Weitere Informationen finden Sie unter [MAPIAllocateBuffer](mapiallocatebuffer.md).</span><span class="sxs-lookup"><span data-stu-id="0bf67-122">For more information, see [MAPIAllocateBuffer](mapiallocatebuffer.md).</span></span>  <br/> |<span data-ttu-id="0bf67-123">Der Anrufer ist verantwortlich und muss **MAPIFreeBuffer verwenden.**</span><span class="sxs-lookup"><span data-stu-id="0bf67-123">Caller is responsible and must use **MAPIFreeBuffer**.</span></span> <span data-ttu-id="0bf67-124">Weitere Informationen finden Sie unter [MAPIFreeBuffer](mapifreebuffer.md).</span><span class="sxs-lookup"><span data-stu-id="0bf67-124">For more information, see [MAPIFreeBuffer](mapifreebuffer.md).</span></span>  <br/> |
|<span data-ttu-id="0bf67-125">Eingabeausgabe</span><span class="sxs-lookup"><span data-stu-id="0bf67-125">Input-output</span></span>  <br/> |<span data-ttu-id="0bf67-126">Der Aufrufer ist für die anfängliche Zuordnung verantwortlich, und die aufgerufene Funktion kann bei Bedarf mithilfe von **MAPIAllocateBuffer neu zugeordnet werden.**</span><span class="sxs-lookup"><span data-stu-id="0bf67-126">Caller is responsible for the initial allocation and called function can reallocate if necessary using **MAPIAllocateBuffer**.</span></span>  <br/> |<span data-ttu-id="0bf67-127">Die aufgerufene Funktion ist für die anfängliche Freilegung verantwortlich, wenn eine Neuzuordnung erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="0bf67-127">Called function is responsible for initial freeing if reallocation is necessary.</span></span> <span data-ttu-id="0bf67-128">Der Anrufer muss den endgültigen Rückgabewert frei geben.</span><span class="sxs-lookup"><span data-stu-id="0bf67-128">Caller must free the final return value.</span></span>  <br/> |
   
<span data-ttu-id="0bf67-129">Bei Ausfallbedingungen müssen Implementierer von Schnittstellenmethoden auf Ausgabe- und Eingabeausgabeparameter achten, da der Aufrufer in der Regel keine Möglichkeit hat, sie zu bereinigen.</span><span class="sxs-lookup"><span data-stu-id="0bf67-129">During failure conditions, implementers of interface methods need to pay attention to output and input-output parameters because the caller generally has no way to clean them up.</span></span> <span data-ttu-id="0bf67-130">Wenn ein Fehler zurückgegeben wird, muss jeder Ausgabe- oder Eingabeausgabeparameter entweder am vom Aufrufer initialisierten Wert bleiben oder auf einen Wert festgelegt werden, der ohne Aktion des Aufrufers bereinigt werden kann.</span><span class="sxs-lookup"><span data-stu-id="0bf67-130">If an error is returned, then each output or input-output parameter must either be left at the value initialized by the caller or set to a value that can be cleaned up without any action on the part of the caller.</span></span> <span data-ttu-id="0bf67-131">Beispielsweise muss ein Ausgabezeigerparameter von wie bei der Eingabe links bleiben  `void ** ppv` oder auf NULL ( ) festgelegt  `*ppv = NULL` werden.</span><span class="sxs-lookup"><span data-stu-id="0bf67-131">For example, an output pointer-parameter of  `void ** ppv` must be left as it was on input or can be set to NULL (  `*ppv = NULL`).</span></span>
  

