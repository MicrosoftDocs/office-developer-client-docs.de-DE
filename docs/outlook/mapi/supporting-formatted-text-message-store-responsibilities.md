---
title: Unterstützen von Formatierten Textnachrichten Store Verantwortlichkeiten
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: a97993c2-52e4-4b71-ac03-2c02d82447d8
description: 'Letzte Änderung: Montag, 9. März 2015'
ms.openlocfilehash: 502ba82279664638c8e7e4ae68f74df74758918d
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33435516"
---
# <a name="supporting-formatted-text-message-store-responsibilities"></a><span data-ttu-id="a4651-103">Unterstützen von formatierten Text: Nachrichten Store Verantwortlichkeiten</span><span class="sxs-lookup"><span data-stu-id="a4651-103">Supporting Formatted Text: Message Store Responsibilities</span></span>

  
  
<span data-ttu-id="a4651-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="a4651-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="a4651-105">Nachrichtenspeicheranbieter verwenden die **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md))-Eigenschaft, um zu veröffentlichen, ob sie Rich Text Format (RTF), #A0 verarbeiten können und ob sie den formatierten Text in einem komprimierten oder nicht komprimierten Format speichern, wenn sie RTF-lich sind.</span><span class="sxs-lookup"><span data-stu-id="a4651-105">Message store providers use the **PR_STORE_SUPPORT_MASK** ([PidTagStoreSupportMask](pidtagstoresupportmask-canonical-property.md)) property to publish whether or not they can handle Rich Text Format (RTF), HTML text and, if they are RTF-aware, whether they store the formatted text in a compressed or uncompressed format.</span></span> <span data-ttu-id="a4651-106">Nachrichtenspeicheranbieter geben an, dass sie RTF-bewusst sind, indem sie das STORE_RTF_OK-Bit festlegen und den formatierten Text in einem nicht komprimierten Formular speichern, indem sie das STORE_UNCOMPRESSED_RTF festlegen.</span><span class="sxs-lookup"><span data-stu-id="a4651-106">Message store providers indicate that they are RTF-aware by setting the STORE_RTF_OK bit and that they store the formatted text in an uncompressed form by setting the STORE_UNCOMPRESSED_RTF bit.</span></span> <span data-ttu-id="a4651-107">Nachrichtenspeicheranbieter geben an, dass sie HTML-bewusst sind, indem sie STORE_HTML_OK festlegen.</span><span class="sxs-lookup"><span data-stu-id="a4651-107">Message store providers indicate they are HTML-aware by setting the STORE_HTML_OK bit.</span></span>
  
<span data-ttu-id="a4651-108">Es ist zwar wichtig, dass ein RTF-bewusster Client auf das STORE_RTF_OK-Bit überprüft, um festzustellen, ob ein Nachrichtenspeicher RTF unterstützt, es ist jedoch nicht erforderlich, dass sich ein Client mit dem Format des formatierten Texts eines RTF-benachrichtigungsspeichers gedankent.</span><span class="sxs-lookup"><span data-stu-id="a4651-108">While it is important for an RTF-aware client to check for the STORE_RTF_OK bit to determine whether or not a message store supports RTF, it is not necessary for a client to be concerned with the format of an RTF-aware store's formatted text.</span></span> 
  
<span data-ttu-id="a4651-109">Alle Nachrichtenspeicher müssen Nicht-RTF-bewusste Clients unterstützen.</span><span class="sxs-lookup"><span data-stu-id="a4651-109">All message stores must support non-RTF-aware clients.</span></span> <span data-ttu-id="a4651-110">Ein Nicht-RTF-benachrichtigungsspeicher muss die **PR_RTF_IN_SYNC** ([PidTagRtfInSync](pidtagrtfinsync-canonical-property.md))-Eigenschaft während eines Aufrufs der [IMAPIProp::SaveChanges-Methode](imapiprop-savechanges.md) der Nachricht löschen, wenn ein Client **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) geändert hat, ohne entweder **PR_RTF_IN_SYNC** oder **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)) zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="a4651-110">A non-RTF-aware message store must delete the **PR_RTF_IN_SYNC** ([PidTagRtfInSync](pidtagrtfinsync-canonical-property.md)) property during a call to the message's [IMAPIProp::SaveChanges](imapiprop-savechanges.md) method if a client has changed **PR_BODY** ([PidTagBody](pidtagbody-canonical-property.md)) without updating either **PR_RTF_IN_SYNC** or **PR_RTF_COMPRESSED** ([PidTagRtfCompressed](pidtagrtfcompressed-canonical-property.md)).</span></span> <span data-ttu-id="a4651-111">Das **PR_RTF_IN_SYNC** bewirkt, **dass die PR_RTF_COMPRESSED-Eigenschaft** beim nächsten Aufruf von RTFSync von der **PR_BODY-Eigenschaft** neu komputiert [wird.](rtfsync.md)</span><span class="sxs-lookup"><span data-stu-id="a4651-111">Deleting **PR_RTF_IN_SYNC** causes the **PR_RTF_COMPRESSED** property to be recomputed from the **PR_BODY** property the next time an RTF-aware client calls [RTFSync](rtfsync.md).</span></span> 
  
<span data-ttu-id="a4651-112">Die meisten #A0 erhalten keinen Nachrichtentext von Clients. sie muss auf Anforderung berechnet werden.</span><span class="sxs-lookup"><span data-stu-id="a4651-112">Most RTF-aware message stores are not given the message text by clients; it must be computed on request.</span></span> <span data-ttu-id="a4651-113">Da diese Berechnung zeitaufwändig und kostspielig ist, sollten Clients nach Möglichkeit **PR_RTF_COMPRESSED** verwenden.</span><span class="sxs-lookup"><span data-stu-id="a4651-113">Because this computation is time consuming and expensive, clients should use **PR_RTF_COMPRESSED** whenever possible.</span></span> <span data-ttu-id="a4651-114">Um die **PR_BODY** zu berechnen, muss der Nachrichtenspeicheranbieter die Komprimierung des Inhalts der PR_RTF_COMPRESSED-Eigenschaft und die **Rich-Text-Formatierung** entfernen.</span><span class="sxs-lookup"><span data-stu-id="a4651-114">To compute the **PR_BODY** property, the message store provider must uncompress the contents of the **PR_RTF_COMPRESSED** property and remove the rich text formatting.</span></span> <span data-ttu-id="a4651-115">Für Clients, die die PR_RTF_COMPRESSED **nicht** unterstützen, muss diese Berechnung für jede Nachricht stattfinden.</span><span class="sxs-lookup"><span data-stu-id="a4651-115">Clients that do not support the **PR_RTF_COMPRESSED** property require this computation to take place for every message.</span></span> 
  
<span data-ttu-id="a4651-116">Beim Kopieren von Nachrichten laufen Nachrichtenspeicheranbieter, die die **Methoden IMAPISupport::D oCopyProps** oder **IMAPISupport::D oCopyTo** nicht verwenden, das Risiko, eine Nachricht ohne Inhalt zu erstellen, wenn ihre Implementierung die **PR_BODY-Eigenschaft** ausschließt und auf **PR_RTF_COMPRESSED PR_RTF_COMPRESSED**.</span><span class="sxs-lookup"><span data-stu-id="a4651-116">When copying messages, message store providers that do not use the **IMAPISupport::DoCopyProps** or **IMAPISupport::DoCopyTo** methods run the risk of creating a message with no content if their implementation excludes the **PR_BODY** property and relies on **PR_RTF_COMPRESSED**.</span></span> <span data-ttu-id="a4651-117">Es ist möglich, dass die Daten in **der PR_RTF_COMPRESSED** beschädigt sind.</span><span class="sxs-lookup"><span data-stu-id="a4651-117">It is possible for the data in the **PR_RTF_COMPRESSED** property to be corrupt.</span></span> <span data-ttu-id="a4651-118">Überprüfen Sie vor dem Ausschließen einer dieser Nachrichteninhaltseigenschaften im Kopiervorgang wie folgt auf Beschädigungen:</span><span class="sxs-lookup"><span data-stu-id="a4651-118">Before excluding either of these message content properties in the copy operation, check for corruption as follows:</span></span> 
  
1. <span data-ttu-id="a4651-119">Wenn der Wert der **PR_RTF_COMPRESSED** nicht größer als der komprimierte RTF ist, ist die Eigenschaft beschädigt.</span><span class="sxs-lookup"><span data-stu-id="a4651-119">If the value of **PR_RTF_COMPRESSED** is not larger than the compressed RTF, the property is corrupt.</span></span> 
    
2. <span data-ttu-id="a4651-120">Wenn der magische Wert im RTF-Header nicht  _dwMagicCompressedRTF_ oder  _dwMagicUncompressedRTF_ ist, ist die Eigenschaft beschädigt.</span><span class="sxs-lookup"><span data-stu-id="a4651-120">If the magic value in the RTF header is not  _dwMagicCompressedRTF_ or  _dwMagicUncompressedRTF_, the property is corrupt.</span></span>
    
<span data-ttu-id="a4651-121">Nachrichtenspeicheranbieter, die die Supportmethoden verwenden, müssen sich nicht mit der Implementierung einer Überprüfung auf **PR_RTF_COMPRESSED** sorgen. MAPI stellt sicher, dass die entsprechenden Eigenschaften vorhanden sind und gültig sind.</span><span class="sxs-lookup"><span data-stu-id="a4651-121">Message store providers using the support methods need not be concerned with implementing a check for **PR_RTF_COMPRESSED** corruption; MAPI ensures that the appropriate properties exist and are valid.</span></span> 
  
<span data-ttu-id="a4651-122">Es gibt drei verschiedene Stufen der #A0 für Nachrichtenspeicheranbieter, die sie implementieren können. MAPI empfiehlt, dass RTF-bewusste Nachrichtenspeicheranbieter ihre Unterstützung auf mittlerer oder höchster Ebene implementieren.</span><span class="sxs-lookup"><span data-stu-id="a4651-122">There are three different levels of RTF support that message store providers can implement; MAPI recommends that RTF-aware message store providers implement their support at the middle or highest level.</span></span> <span data-ttu-id="a4651-123">Alle RTF-benachrichtigungsspeicheranbieter sorgen  dafür, PR_BODY aus den in **PR_RTF_COMPRESSED** enthaltenen Daten für ausgehende Nachrichten zu generieren und einen Aufruf an **RTFSync** zu senden, um Text und Formatierungen für eingehende Nachrichten zu synchronisieren.</span><span class="sxs-lookup"><span data-stu-id="a4651-123">All RTF-aware message store providers take care of generating **PR_BODY** from the data included in **PR_RTF_COMPRESSED** on outgoing messages and make a call to **RTFSync** to synchronize text and formatting on incoming messages.</span></span> 
  
<span data-ttu-id="a4651-124">Die Unterschiede zwischen diesen drei Ebenen werden in der folgenden Tabelle beschrieben.</span><span class="sxs-lookup"><span data-stu-id="a4651-124">The differences between these three levels are described in the following table.</span></span> 
  
|<span data-ttu-id="a4651-125">**Unterstützungsumfang**</span><span class="sxs-lookup"><span data-stu-id="a4651-125">**Level of support**</span></span>|<span data-ttu-id="a4651-126">**Beschreibung**</span><span class="sxs-lookup"><span data-stu-id="a4651-126">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="a4651-127">Niedrig</span><span class="sxs-lookup"><span data-stu-id="a4651-127">Low</span></span>  <br/> |<span data-ttu-id="a4651-128">Der Nachrichtenspeicheranbieter ruft **RTFSync** auf, wenn Änderungen an einer Nachricht gespeichert werden, und extrahiert die Daten für die **PR_BODY-Eigenschaft** aus **PR_RTF_COMPRESSED** anstatt dass Clients sie festlegen müssen.</span><span class="sxs-lookup"><span data-stu-id="a4651-128">Message store provider calls **RTFSync** whenever changes are saved to a message and extracts the data for the **PR_BODY** property from **PR_RTF_COMPRESSED** rather than requiring clients to set it.</span></span> <span data-ttu-id="a4651-129">Sowohl **PR_BODY** als **auch PR_RTF_COMPRESSED** werden gespeichert.</span><span class="sxs-lookup"><span data-stu-id="a4651-129">Both **PR_BODY** and **PR_RTF_COMPRESSED** are stored.</span></span>  <br/> |
|<span data-ttu-id="a4651-130">Middle</span><span class="sxs-lookup"><span data-stu-id="a4651-130">Middle</span></span>  <br/> |<span data-ttu-id="a4651-131">Der Nachrichtenspeicheranbieter speichert nur **die PR_RTF_COMPRESSED-** und **Computereigenschaft,** PR_BODY falls erforderlich.</span><span class="sxs-lookup"><span data-stu-id="a4651-131">Message store provider stores only the **PR_RTF_COMPRESSED** property, computing **PR_BODY** when necessary.</span></span>  <br/> |
|<span data-ttu-id="a4651-132">Hoch</span><span class="sxs-lookup"><span data-stu-id="a4651-132">High</span></span>  <br/> |<span data-ttu-id="a4651-133">Nachrichtenspeicheranbieter speichert weder **PR_BODY** noch die zusätzlichen RTF-Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="a4651-133">Message store provider stores neither **PR_BODY** or the auxiliary RTF properties.</span></span> <span data-ttu-id="a4651-134">**RTFSync wird** aufgerufen, wenn sich der Nachrichtentext geändert hat und die Formatierung unverändert bleibt oder wenn eine neue Nachricht von einem Transportanbieter heruntergeladen wird.</span><span class="sxs-lookup"><span data-stu-id="a4651-134">**RTFSync** is called when the message text has changed and the formatting remains unchanged or when a new message is downloaded by a transport provider.</span></span>  <br/> |
   

