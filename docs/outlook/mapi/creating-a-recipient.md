---
title: Erstellen eines Empfängers
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 586c901f-d9f9-44f2-a328-051775a81265
description: 'Letzte Änderung: Montag, 9. März 2015'
ms.openlocfilehash: e14430d1539b90e089a9dabe1315384050f3dd5e
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33429586"
---
# <a name="creating-a-recipient"></a><span data-ttu-id="87d2c-103">Erstellen eines Empfängers</span><span class="sxs-lookup"><span data-stu-id="87d2c-103">Creating a Recipient</span></span>

  
  
<span data-ttu-id="87d2c-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="87d2c-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="87d2c-105">Clients erstellen Empfänger, wenn sie Nachrichten adressieren und Einträge zu veränderbaren Adressbuchcontainern hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="87d2c-105">Clients create recipients when they are addressing messages and when they are adding entries to modifiable address book containers.</span></span> <span data-ttu-id="87d2c-106">MAPI bietet drei Methoden zum Erstellen von Empfängern:</span><span class="sxs-lookup"><span data-stu-id="87d2c-106">MAPI provides three methods for creating recipients:</span></span>
  
- [<span data-ttu-id="87d2c-107">IAddrBook::CreateOneOff</span><span class="sxs-lookup"><span data-stu-id="87d2c-107">IAddrBook::CreateOneOff</span></span>](iaddrbook-createoneoff.md)
    
- [<span data-ttu-id="87d2c-108">IAddrBook::NewEntry</span><span class="sxs-lookup"><span data-stu-id="87d2c-108">IAddrBook::NewEntry</span></span>](iaddrbook-newentry.md)
    
- [<span data-ttu-id="87d2c-109">IABContainer::CreateEntry</span><span class="sxs-lookup"><span data-stu-id="87d2c-109">IABContainer::CreateEntry</span></span>](iabcontainer-createentry.md)
    
<span data-ttu-id="87d2c-110">Rufen **Sie IAddrBook::CreateOneOff auf,** wenn Sie Empfänger erstellen, die zum Adressieren von Nachrichten verwendet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="87d2c-110">Call **IAddrBook::CreateOneOff** when you are creating recipients to be used to address messages.</span></span> <span data-ttu-id="87d2c-111">**CreateOneOff erstellt** einen speziell formatierten one-off-Eintragsbezeichner, der einer Adresse eines bestimmten Adresstyps zugeordnet werden soll.</span><span class="sxs-lookup"><span data-stu-id="87d2c-111">**CreateOneOff** creates a specially formatted one-off entry identifier to be associated with an address of a particular address type.</span></span> <span data-ttu-id="87d2c-112">Weitere Informationen zu one-offs und one-off entry identifiers finden Sie unter [One-Off Addresses](one-off-addresses.md) and [One-Off Entry Identifiers](one-off-entry-identifiers.md).</span><span class="sxs-lookup"><span data-stu-id="87d2c-112">For more information about one-offs and one-off entry identifiers, see [One-Off Addresses](one-off-addresses.md) and [One-Off Entry Identifiers](one-off-entry-identifiers.md).</span></span>
  
<span data-ttu-id="87d2c-113">Rufen **Sie IAddrBook::NewEntry** auf, wenn Sie Empfänger erstellen, die zum Adressieren von Nachrichten oder zum Hinzufügen zu einem Container verwendet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="87d2c-113">Call **IAddrBook::NewEntry** when you are creating recipients to be used either to address messages or to add to a container.</span></span> <span data-ttu-id="87d2c-114">**NewEntry verfügt** über drei Parameterpaare, die Eintragsbezeichner enthalten.</span><span class="sxs-lookup"><span data-stu-id="87d2c-114">**NewEntry** has three pairs of parameters that contain entry identifiers.</span></span> <span data-ttu-id="87d2c-115">Diese Parameter werden wie folgt beschrieben:</span><span class="sxs-lookup"><span data-stu-id="87d2c-115">These parameters are described as follows:</span></span> 
  
|<span data-ttu-id="87d2c-116">**Parameterpaar**</span><span class="sxs-lookup"><span data-stu-id="87d2c-116">**Parameter pair**</span></span>|<span data-ttu-id="87d2c-117">**Beschreibung**</span><span class="sxs-lookup"><span data-stu-id="87d2c-117">**Description**</span></span>|
|:-----|:-----|
| <span data-ttu-id="87d2c-118">_cbEidContainer_ und  _lpEidContainer_</span><span class="sxs-lookup"><span data-stu-id="87d2c-118">_cbEidContainer_ and  _lpEidContainer_</span></span> <br/> |<span data-ttu-id="87d2c-119">Eintrags-ID für den Container, in den der neue Eintrag platziert werden soll.</span><span class="sxs-lookup"><span data-stu-id="87d2c-119">Entry identifier for the container into which the new entry should be placed.</span></span>  <br/> |
| <span data-ttu-id="87d2c-120">_cbEidNewEntryTpl_ und  _lpEidNewEntryTpl_</span><span class="sxs-lookup"><span data-stu-id="87d2c-120">_cbEidNewEntryTpl_ and  _lpEidNewEntryTpl_</span></span> <br/> |<span data-ttu-id="87d2c-121">Eintrags-ID für die Vorlage, die zum Erstellen des neuen Eintrags verwendet werden soll.</span><span class="sxs-lookup"><span data-stu-id="87d2c-121">Entry identifier for the template to be used to create the new entry.</span></span>  <br/> |
| <span data-ttu-id="87d2c-122">_lpcbEidNewEntry_ und  _lppEidNewEntry_</span><span class="sxs-lookup"><span data-stu-id="87d2c-122">_lpcbEidNewEntry_ and  _lppEidNewEntry_</span></span> <br/> |<span data-ttu-id="87d2c-123">Eintrags-ID für den neuen Eintrag.</span><span class="sxs-lookup"><span data-stu-id="87d2c-123">Entry identifier for the new entry.</span></span>  <br/> |
   
<span data-ttu-id="87d2c-124">Um einen Empfänger für eine ausgehende Nachricht zu erstellen, legen Sie  _cbEidContainer_ auf Null und  _lpEidContainer auf_ NULL.</span><span class="sxs-lookup"><span data-stu-id="87d2c-124">To create a recipient for an outgoing message, set  _cbEidContainer_ to zero and  _lpEidContainer_ to NULL.</span></span> <span data-ttu-id="87d2c-125">**NewEntry** erstellt einen Empfänger mit einer Eintrags-ID, die dem einmalformat entspricht, dem gleichen Empfängertyp, der durch einen Aufruf von **IAddrBook::CreateOneOff** erzeugt wird.</span><span class="sxs-lookup"><span data-stu-id="87d2c-125">**NewEntry** creates a recipient with an entry identifier that conforms to the one-off format, the same type of recipient that is produced by a call to **IAddrBook::CreateOneOff**.</span></span> 
  
<span data-ttu-id="87d2c-126">Um einen Empfänger zu erstellen, der in einen bestimmten Container eingefügt werden soll, legen Sie  _lpEidContainer_ auf den Eintragsbezeichner des Containers und  _cbEidContainer_ auf die Anzahl der Bytes im Eintragsbezeichner des Containers.</span><span class="sxs-lookup"><span data-stu-id="87d2c-126">To create a recipient to be inserted into a particular container, set  _lpEidContainer_ to the container's entry identifier and  _cbEidContainer_ to the number of bytes in the container's entry identifier.</span></span> 
  
<span data-ttu-id="87d2c-127">Um eine Vorlage zum Erstellen eines Empfängers zu verwenden, legen Sie  _lpEidNewEntryTpl_ auf den Eintragsbezeichner der zu verwendenden Vorlage und  _cbEidNewEntryTpl_ auf die Anzahl der Bytes in diesem Eintragsbezeichner.</span><span class="sxs-lookup"><span data-stu-id="87d2c-127">To use a template to create a recipient, set  _lpEidNewEntryTpl_ to the entry identifier of the template to be used and  _cbEidNewEntryTpl_ to the count of bytes in this entry identifier.</span></span> <span data-ttu-id="87d2c-128">Die meisten veränderbaren Adressbuchcontainer unterstützen eine oder mehrere Vorlagen zum Erstellen von Einträgen eines bestimmten Typs.</span><span class="sxs-lookup"><span data-stu-id="87d2c-128">Most modifiable address book containers support one or more templates for creating entries of a particular type.</span></span> <span data-ttu-id="87d2c-129">Bei einmal erstellten Vorlagen handelt es sich in der Regel um Dialogfelder, aber nicht immer.</span><span class="sxs-lookup"><span data-stu-id="87d2c-129">One-off templates are typically, but not always, dialog boxes.</span></span> <span data-ttu-id="87d2c-130">Wenn Sie Informationen in die Vorlage eingeben, wird ein Empfänger mit einer Adresse erzeugt, die für den Typ korrekt formatiert ist.</span><span class="sxs-lookup"><span data-stu-id="87d2c-130">Entering information into the template produces a recipient with an address that is correctly formatted for the type.</span></span> 
  
<span data-ttu-id="87d2c-131">Rufen Sie die Vorlageneintrags-ID von einer der beiden Abzeichner ab:</span><span class="sxs-lookup"><span data-stu-id="87d2c-131">Obtain the template entry identifier from either:</span></span>
  
- <span data-ttu-id="87d2c-132">Auf **die PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) -Spalte in der #A0 des Containers zugegriffen wird, indem die [IMAPIProp::OpenProperty-Methode](imapiprop-openproperty.md) des Containers und **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) als Eigenschaftentag und IID_IMAPITable als Schnittstellenbezeichner angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="87d2c-132">The **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)) column in the container's one-off table, accessed by calling the container's [IMAPIProp::OpenProperty](imapiprop-openproperty.md) method and specifying **PR_CREATE_TEMPLATES** ([PidTagCreateTemplates](pidtagcreatetemplates-canonical-property.md)) as the property tag and IID_IMAPITable as the interface identifier.</span></span> 
    
- <span data-ttu-id="87d2c-133">Die Eigenschaften **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) und **PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)) eines Adressbuchanbieters, die die Eintragsbezeichner für die Nachrichtenbenutzerobjekt- und Verteilerlistenvorlagen des Anbieters enthalten.</span><span class="sxs-lookup"><span data-stu-id="87d2c-133">An address book provider's **PR_DEF_CREATE_MAILUSER** ([PidTagDefCreateMailuser](pidtagdefcreatemailuser-canonical-property.md)) and **PR_DEF_CREATE_DL** ([PidTagDefCreateDl](pidtagdefcreatedl-canonical-property.md)) properties which hold the entry identifiers for the provider's messaging user object and distribution list templates.</span></span> 
    
> [!NOTE]
> <span data-ttu-id="87d2c-134">Verwechseln Sie den Eintragsbezeichner einer neuen Eintragsvorlage nicht mit einem anderen Typ von Eintragsbezeichner, der als Vorlagenbezeichner bezeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="87d2c-134">Do not confuse a new entry template's entry identifier with a different type of entry identifier called a template identifier.</span></span> <span data-ttu-id="87d2c-135">Eine Vorlagen-ID wird nur von Anbietern verwendet, um Einträge zu verwalten, die von anderen Anbietern kopiert wurden. Es wird nie von Clients verwendet und nicht zum Erstellen neuer Einträge verwendet.</span><span class="sxs-lookup"><span data-stu-id="87d2c-135">A template identifier is used only by providers to maintain entries copied from other providers; it is never used by clients and it is not used to create new entries.</span></span> 
  
<span data-ttu-id="87d2c-136">Um dem Benutzer zu ermöglichen, den Typ des zu erstellenden Eintrags zu bestimmen, übergeben Sie null für  _cbEidNewEntryTpl_ und NULL für  _lpEidNewEntryTpl_.</span><span class="sxs-lookup"><span data-stu-id="87d2c-136">To enable the user to determine the type of entry to be created, pass zero for  _cbEidNewEntryTpl_ and NULL for  _lpEidNewEntryTpl_.</span></span> <span data-ttu-id="87d2c-137">In diesem Fall zeigt **NewEntry** ein allgemeines Dialogfeld an, das aus der einmal erstellten TABELLE von MAPI erstellt wurde – eine hierarchische Liste aller Vorlagen, die von jedem Adressbuchanbieter im Profil unterstützt werden.</span><span class="sxs-lookup"><span data-stu-id="87d2c-137">When this occurs, **NewEntry** displays a common dialog box built from MAPI's one-off table — a hierarchical list of all of the templates supported by each address book provider in the profile.</span></span> 
  
<span data-ttu-id="87d2c-138">Wenn ein Adresstyp bestimmt wurde, entweder durch die Einstellung des  _lpEidNewEntryTpl-Parameters_ oder durch eine Auswahl durch den Benutzer aus der Anzeige der einmal verwendeten Tabelle, zeigt **NewEntry** die entsprechende Vorlage mithilfe der Anzeigetabelle an.</span><span class="sxs-lookup"><span data-stu-id="87d2c-138">When an address type has been determined, either through the setting of the  _lpEidNewEntryTpl_ parameter or a selection by the user from the one-off table display, **NewEntry** displays the corresponding template using its display table.</span></span> <span data-ttu-id="87d2c-139">Alle neuen Eintragsvorlagen unterstützen **die PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) -Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="87d2c-139">All new entry templates support the **PR_DETAILS_TABLE** ([PidTagDetailsTable](pidtagdetailstable-canonical-property.md)) property.</span></span> 
  
<span data-ttu-id="87d2c-140">Wenn **NewEntry** den Eintragsbezeichner des erstellten Eintrags zurückgeben soll, übergeben Sie eine gültige Adresse für die _Parameter lpcbEidNewEntry_ und _lppEidNewEntry._</span><span class="sxs-lookup"><span data-stu-id="87d2c-140">To have **NewEntry** return the entry identifier of the created entry, pass a valid address for the  _lpcbEidNewEntry_ and  _lppEidNewEntry_ parameters.</span></span> <span data-ttu-id="87d2c-141">MAPI platziert den neuen Eintragsbezeichner an der Adresse, auf die  _von lppEidNewEntry_ verwiesen wird, und die Byteanzahl des neuen Eintragsbezeichners an der Adresse, auf die  _von lpcbEidNewEntry_ verwiesen wird.</span><span class="sxs-lookup"><span data-stu-id="87d2c-141">MAPI places the new entry identifier at the address pointed to by  _lppEidNewEntry_ and the byte count of the new entry identifier at the address pointed to by  _lpcbEidNewEntry_.</span></span>
  
<span data-ttu-id="87d2c-142">Rufen [Sie IABContainer::CreateEntry auf,](iabcontainer-createentry.md) um einen Empfänger zu erstellen und ihn in einem bestimmten Adressbuchcontainer zu speichern.</span><span class="sxs-lookup"><span data-stu-id="87d2c-142">Call [IABContainer::CreateEntry](iabcontainer-createentry.md) to create a recipient and save it into a particular address book container.</span></span> <span data-ttu-id="87d2c-143">Sie können diese Methode nur mit veränderbaren Containern verwenden– Containern, deren AB_MODIFIABLE -Flag in der eigenschaft **PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)) festgelegt ist.</span><span class="sxs-lookup"><span data-stu-id="87d2c-143">You can use this method only with modifiable containers — containers that have the AB_MODIFIABLE flag set in their **PR_CONTAINER_FLAGS** ([PidTagContainerFlags](pidtagcontainerflags-canonical-property.md)) property.</span></span> <span data-ttu-id="87d2c-144">Adressbuchanbieter mit nicht veränderbaren Containern unterstützen diese Methode nicht.</span><span class="sxs-lookup"><span data-stu-id="87d2c-144">Address book providers with nonmodifiable containers do not support this method.</span></span> <span data-ttu-id="87d2c-145">Geben Sie den Eintragsbezeichner der Vorlage zum Erstellen eines Eintrags des gewünschten Typs im  _lpEntryID-Parameter_ an.</span><span class="sxs-lookup"><span data-stu-id="87d2c-145">Specify the entry identifier of the template for creating an entry of the desired type in the  _lpEntryID_ parameter.</span></span> 
  
<span data-ttu-id="87d2c-146">Geben Sie  _im ulCreateFlags-Parameter_ den Typ der doppelten Eintragsprüfung an, die erforderlich ist, und ob neue Einträge vorhandene einträge ersetzen sollen.</span><span class="sxs-lookup"><span data-stu-id="87d2c-146">In the  _ulCreateFlags_ parameter, specify the type of duplicate entry checking required and whether or not new entries should replace existing ones.</span></span> <span data-ttu-id="87d2c-147">Wenn **CreateEntry** aufgrund der doppelten Eintragsüberprüfung, die vom Anbieter auferlegt wurde, kein neues Objekt erstellt werden kann, erwarten Sie nicht, dass ein Fehler oder eine Warnung zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="87d2c-147">If **CreateEntry** fails to create a new object because of the duplicate entry checking imposed by the provider, do not expect to see an error or warning returned.</span></span> <span data-ttu-id="87d2c-148">Unter diesen Bedingungen geben Anbieter einen Erfolgscode zurück.</span><span class="sxs-lookup"><span data-stu-id="87d2c-148">Under these conditions, providers return a success code.</span></span> 
  
<span data-ttu-id="87d2c-149">Wenn Sie direkt mit einem Container arbeiten und genau wissen, welche Adresstypen der Container erstellen kann, können Sie **IABContainer::CreateEntry** aufrufen und den Eintragsbezeichner für die entsprechende Vorlage übergeben.</span><span class="sxs-lookup"><span data-stu-id="87d2c-149">If you are working directly with a container and you know exactly the types of addresses that the container can create, you can call **IABContainer::CreateEntry** and pass the entry identifier for the appropriate template.</span></span> <span data-ttu-id="87d2c-150">Der Adressbuchanbieter legt einige anfängliche Standardeigenschaften fest. Sie können **SetProps aufrufen,** um andere zu setzen.</span><span class="sxs-lookup"><span data-stu-id="87d2c-150">The address book provider sets some initial default properties; you can call **SetProps** to set others.</span></span> <span data-ttu-id="87d2c-151">Der Benutzer ist nie beteiligt.</span><span class="sxs-lookup"><span data-stu-id="87d2c-151">The user is never involved.</span></span> 
  

