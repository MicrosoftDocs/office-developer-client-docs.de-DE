---
title: Statustabelle und Statusobjekte
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 203765c1-4b08-4032-a5bf-18f3e752a899
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 3eb190069b43ea1960c3b6edf30a9e0b782d2c41
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33425176"
---
# <a name="status-table-and-status-objects"></a><span data-ttu-id="1256a-103">Statustabelle und Statusobjekte</span><span class="sxs-lookup"><span data-stu-id="1256a-103">Status Table and Status Objects</span></span>

  
  
<span data-ttu-id="1256a-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="1256a-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="1256a-105">MAPI enthält eine Tabelle mit Informationen zum Status des MAPI-Subsystems, des MAPI-Spoolers, des Adressbuchs oder eines bestimmten Dienstanbieters.</span><span class="sxs-lookup"><span data-stu-id="1256a-105">MAPI provides a table with information about the status of the MAPI subsystem, MAPI spooler, address book, or a particular service provider.</span></span> <span data-ttu-id="1256a-106">Sie können auf diese Tabelle zugreifen, indem Sie [IMAPISession::GetStatusTable aufrufen.](imapisession-getstatustable.md)</span><span class="sxs-lookup"><span data-stu-id="1256a-106">You can access this table by calling [IMAPISession::GetStatusTable](imapisession-getstatustable.md).</span></span>
  
<span data-ttu-id="1256a-107">Jede Zeile in der Statustabelle stellt ein status-Objekt dar, das von MAPI oder einem Dienstanbieter implementiert wurde.</span><span class="sxs-lookup"><span data-stu-id="1256a-107">Each row in the status table represents a status object implemented by MAPI or a service provider.</span></span> <span data-ttu-id="1256a-108">Mit einem Statusobjekt können Sie das Konfigurationseigenschaftsblatt eines Anbieters anzeigen, ein Anbieterkennwort ändern, Nachrichten hochladen oder herunterladen und mit einem bestimmten Transportanbieter kommunizieren.</span><span class="sxs-lookup"><span data-stu-id="1256a-108">You can use a status object to display a provider's configuration property sheet, to change a provider password, to upload or download messages, and to communicate with a particular transport provider.</span></span> 
  
<span data-ttu-id="1256a-109">Es gibt zwei Möglichkeiten für den Zugriff auf ein Statusobjekt:</span><span class="sxs-lookup"><span data-stu-id="1256a-109">There are two ways to access a status object:</span></span>
  
- <span data-ttu-id="1256a-110">Durch die Statustabelle</span><span class="sxs-lookup"><span data-stu-id="1256a-110">Through the status table</span></span>
    
- <span data-ttu-id="1256a-111">Über die **OpenStatusEntry-Methode eines Anmeldeobjekts**</span><span class="sxs-lookup"><span data-stu-id="1256a-111">Through a logon object's **OpenStatusEntry** method</span></span> 
    
<span data-ttu-id="1256a-112">Da Anmeldeobjekte für Clients nicht verfügbar sind, müssen Sie die Statustabelle verwenden, um auf Statusobjekte zu zugreifen.</span><span class="sxs-lookup"><span data-stu-id="1256a-112">Because logon objects are unavailable to clients, you must use the status table to access status objects.</span></span> <span data-ttu-id="1256a-113">Der Ansatz der Statustabelle ist indirekt und erfordert einige Aufrufe, bevor das status-Objekt geöffnet wird, und ein Zeiger auf seine **IMAPIStatus-Implementierung** wird zurückgegeben.</span><span class="sxs-lookup"><span data-stu-id="1256a-113">The status table approach is indirect, requiring a few calls before the status object is opened and a pointer to its **IMAPIStatus** implementation returned.</span></span> 
  
 <span data-ttu-id="1256a-114">**So öffnen Sie ein Statusobjekt mithilfe der Statustabelle**</span><span class="sxs-lookup"><span data-stu-id="1256a-114">**To use the status table to open a status object**</span></span>
  
1. <span data-ttu-id="1256a-115">Rufen **Sie IMAPIStatus::GetStatusTable auf,** um einen [IMAPITable-Zeiger abzurufen.](imapitableiunknown.md)</span><span class="sxs-lookup"><span data-stu-id="1256a-115">Call **IMAPIStatus::GetStatusTable** to retrieve an [IMAPITable](imapitableiunknown.md) pointer.</span></span> 
    
2. <span data-ttu-id="1256a-116">Rufen Sie die [IMAPITable::SetColumns-Methode](imapitable-setcolumns.md) der Statustabelle auf, um den Spaltensatz auf **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)), **PR_RESOURCE_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md)) und **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)) zu beschränken.</span><span class="sxs-lookup"><span data-stu-id="1256a-116">Call the status table's [IMAPITable::SetColumns](imapitable-setcolumns.md) method to limit the column set to **PR_ENTRYID** ([PidTagEntryId](pidtagentryid-canonical-property.md)), **PR_RESOURCE_TYPE** ([PidTagResourceType](pidtagresourcetype-canonical-property.md)), and **PR_DISPLAY_NAME** ([PidTagDisplayName](pidtagdisplayname-canonical-property.md)).</span></span>
    
3. <span data-ttu-id="1256a-117">Beschränken Sie die Tabellenansicht auf ein bestimmtes Statusobjekt.</span><span class="sxs-lookup"><span data-stu-id="1256a-117">Limit the table view to a particular status object.</span></span> <span data-ttu-id="1256a-118">Für MAPI-Implementierungen kann ein Client eine Eigenschaftseinschränkung mithilfe von **PR_RESOURCE_TYPE.**</span><span class="sxs-lookup"><span data-stu-id="1256a-118">For MAPI implementations, a client can define a property restriction using **PR_RESOURCE_TYPE**.</span></span> <span data-ttu-id="1256a-119">Bei Dienstanbieterimplementierung kann ein Client **PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md)), den Namen des Anbieters oder **auf PR_PROVIDER_DLL_NAME** ([PidTagProviderDllName](pidtagproviderdllname-canonical-property.md)) den Namen der Anbieter-DLL-Datei einschränken.</span><span class="sxs-lookup"><span data-stu-id="1256a-119">For service provider implementations, a client can restrict on **PR_PROVIDER_DISPLAY** ([PidTagProviderDisplay](pidtagproviderdisplay-canonical-property.md)), the name of the provider, or on **PR_PROVIDER_DLL_NAME** ([PidTagProviderDllName](pidtagproviderdllname-canonical-property.md)), the name of the provider DLL file.</span></span>
    
4. <span data-ttu-id="1256a-120">Rufen [Sie IMAPITable::Restrict auf, um](imapitable-restrict.md) die Einschränkung zu setzen.</span><span class="sxs-lookup"><span data-stu-id="1256a-120">Call [IMAPITable::Restrict](imapitable-restrict.md) to set the restriction.</span></span> 
    
5. <span data-ttu-id="1256a-121">Rufen [Sie HrQueryAllRows auf,](hrqueryallrows.md)und übergeben Sie die [SPropertyRestriction-Struktur,](spropertyrestriction.md) um die Zeile abzurufen, die den Status des Anbieters darstellt.</span><span class="sxs-lookup"><span data-stu-id="1256a-121">Call [HrQueryAllRows](hrqueryallrows.md), passing in the [SPropertyRestriction](spropertyrestriction.md) structure, to retrieve the row that represents the status of the provider.</span></span> 
    
6. <span data-ttu-id="1256a-122">Rufen [Sie IMAPISession::OpenEntry](imapisession-openentry.md)auf, und geben Sie den Eintragsbezeichner aus der Zeile der Statustabelle an, um das Statusobjekt zu öffnen und einen **IMAPIStatus-Zeiger abzurufen.**</span><span class="sxs-lookup"><span data-stu-id="1256a-122">Call [IMAPISession::OpenEntry](imapisession-openentry.md), specifying the entry identifier from the status table row, to open the status object and retrieve an **IMAPIStatus** pointer.</span></span> 
    
<span data-ttu-id="1256a-123">Rufen Sie zum Anzeigen eines Eigenschaftenblatts die [IMAPIStatus::SettingsDialog-Methode](imapistatus-settingsdialog.md) des Statusobjekts für den Zielanbieter auf.</span><span class="sxs-lookup"><span data-stu-id="1256a-123">To display a property sheet, call the status object's [IMAPIStatus::SettingsDialog](imapistatus-settingsdialog.md) method for the target provider.</span></span> <span data-ttu-id="1256a-124">**SettingsDialog zeigt** ein Eigenschaftenblatt zum Anzeigen und in einigen Fällen zum Ändern der Konfigurationseigenschaften eines Anbieters an.</span><span class="sxs-lookup"><span data-stu-id="1256a-124">**SettingsDialog** displays a property sheet for viewing and in some cases, changing the configuration properties of a provider.</span></span> 
  
<span data-ttu-id="1256a-125">Um mit einem Transportanbieter zu kommunizieren, rufen Sie die [IMAPIStatus::ValidateState-Methode des Statusobjekts](imapistatus-validatestate.md) auf.</span><span class="sxs-lookup"><span data-stu-id="1256a-125">To communicate with a transport provider, call its status object's [IMAPIStatus::ValidateState](imapistatus-validatestate.md) method.</span></span> <span data-ttu-id="1256a-126">**ValidateState** kann einen Transportanbieter neu konfigurieren, verhindern, dass der Anbieter eine Benutzeroberfläche anzeigen kann, und eine Sitzung steuern, die das Herunterladen von Nachrichtenkopfzeilen von einem Remoteserver erfordert, abhängig von den von Ihnen übergebenen Flags.</span><span class="sxs-lookup"><span data-stu-id="1256a-126">**ValidateState** can reconfigure a transport provider, prevent the provider from displaying a user interface, and control a session that involves downloading message headers from a remote server, depending on the flags that you pass in.</span></span> <span data-ttu-id="1256a-127">Wenn Sie beispielsweise das Herunterladen von Remoteheadern abbrechen möchten, übergeben Sie das ABORT_XP_HEADER_OPERATION **an ValidateState**.</span><span class="sxs-lookup"><span data-stu-id="1256a-127">For example, to cancel the downloading of remote headers, pass the ABORT_XP_HEADER_OPERATION flag to **ValidateState**.</span></span> <span data-ttu-id="1256a-128">Um eine Verbindung mit dem Remoteserver herzustellen oder die Verbindung zu trennen, übergeben FORCE_XP_CONNECT oder FORCE_XP_DISCONNECT.</span><span class="sxs-lookup"><span data-stu-id="1256a-128">To connect or disconnect from the remote server, pass FORCE_XP_CONNECT or FORCE_XP_DISCONNECT.</span></span> <span data-ttu-id="1256a-129">Um den Anbieter neu zu konfigurieren, übergeben Sie CONFIG_CHANGED.</span><span class="sxs-lookup"><span data-stu-id="1256a-129">To reconfigure the provider, pass CONFIG_CHANGED.</span></span> 
  
<span data-ttu-id="1256a-130">Clients, die das Senden oder Empfangen von Nachrichten bei Bedarf implementieren, rufen entweder die [IMAPIStatus::FlushQueues-Methode](imapistatus-flushqueues.md) eines Transportanbieters oder des MAPI-Spoolers auf.</span><span class="sxs-lookup"><span data-stu-id="1256a-130">Clients that implement sending or receiving of messages on demand call either a transport provider's or the MAPI spooler's [IMAPIStatus::FlushQueues](imapistatus-flushqueues.md) method.</span></span> <span data-ttu-id="1256a-131">Sie können drei Flags an die Methode übergeben: FLUSH_UPLOAD, FLUSH_DOWNLOAD und FLUSH_FORCE.</span><span class="sxs-lookup"><span data-stu-id="1256a-131">You can pass three flags into the method: FLUSH_UPLOAD, FLUSH_DOWNLOAD, and FLUSH_FORCE.</span></span> <span data-ttu-id="1256a-132">FLUSH_UPLOAD an den Anbieter oder den MAPI-Spooler, alle nachrichten zu senden, die in der Ausgabewarteschlange warten, während FLUSH_DOWNLOAD den Anbieter oder den MAPI-Spooler anweisen, eingehende Nachrichten zu empfangen.</span><span class="sxs-lookup"><span data-stu-id="1256a-132">FLUSH_UPLOAD instructs the provider or the MAPI spooler to send any messages waiting in the output queue while FLUSH_DOWNLOAD instructs the provider or the MAPI spooler to receive any incoming messages.</span></span> <span data-ttu-id="1256a-133">FLUSH_FORCE kann mit einem der anderen Flags festgelegt werden, damit das status-Objekt die Leerung unabhängig vom Zeitpunkt ausführen kann.</span><span class="sxs-lookup"><span data-stu-id="1256a-133">FLUSH_FORCE can be set with either of the other flags to cause the status object to perform the flush regardless of the timing.</span></span> 
  
<span data-ttu-id="1256a-134">Erwarten Sie nicht, dass **SettingsDialog** oder [ChangePassword](imapistatus-changepassword.md) für eines der MAPI-Subsysteme, MAPI-Spooler- oder Adressbuchstatusobjekte aufrufen können.</span><span class="sxs-lookup"><span data-stu-id="1256a-134">Do not expect to be able to call **SettingsDialog** or [ChangePassword](imapistatus-changepassword.md) on any of the MAPI subsystem, MAPI spooler, or address book status objects.</span></span> <span data-ttu-id="1256a-135">Sowohl die Subsystem- als auch die Adressbuchstatusobjekte unterstützen **nur ValidateState**; Das MAPI-Spoolerstatusobjekt unterstützt **FlushQueues** zusätzlich zu **ValidateState**.</span><span class="sxs-lookup"><span data-stu-id="1256a-135">Both the subsystem and address book status objects only support **ValidateState**; the MAPI spooler status object supports **FlushQueues** in addition to **ValidateState**.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="1256a-136">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="1256a-136">See also</span></span>



[<span data-ttu-id="1256a-137">Statustabellen</span><span class="sxs-lookup"><span data-stu-id="1256a-137">Status Tables</span></span>](status-tables.md)
  
[<span data-ttu-id="1256a-138">MAPI-Statusobjekte</span><span class="sxs-lookup"><span data-stu-id="1256a-138">MAPI Status Objects</span></span>](mapi-status-objects.md)

