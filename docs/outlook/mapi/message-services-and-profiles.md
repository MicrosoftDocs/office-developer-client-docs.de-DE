---
title: Nachrichtendienste und Profile
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: df0db1e4-69c8-44ec-bb2a-d31fc8a564b9
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 78a13bacf13b019bbf9436830ad66db7fdfaf425
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33415467"
---
# <a name="message-services-and-profiles"></a><span data-ttu-id="db7d3-103">Nachrichtendienste und Profile</span><span class="sxs-lookup"><span data-stu-id="db7d3-103">Message services and profiles</span></span>
  
<span data-ttu-id="db7d3-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="db7d3-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="db7d3-105">Einige Benutzer benötigen die Dienste mehrerer Messagingsysteme mit jeweils einem oder mehreren Dienstanbietern.</span><span class="sxs-lookup"><span data-stu-id="db7d3-105">Some users require the services of several messaging systems, each with one or more service providers.</span></span> <span data-ttu-id="db7d3-106">Da es umständlich ist, jeden dieser Dienstanbieter einzeln zu installieren und zu konfigurieren, und da ein Messagingserver in der Regel eine Gruppe verwandter Anbieter benötigt, um alle funktionen verfügbar zu machen, umfasst MAPI das Konzept eines Nachrichtendiensts.</span><span class="sxs-lookup"><span data-stu-id="db7d3-106">Because it is cumbersome to install and configure each of these service providers individually, and because a messaging server usually requires a group of related providers to expose all its functionality, MAPI includes the concept of a message service.</span></span> <span data-ttu-id="db7d3-107">Nachrichtendienste helfen Benutzern beim Installieren und Konfigurieren ihrer Dienstanbieter.</span><span class="sxs-lookup"><span data-stu-id="db7d3-107">Message services help users install and configure their service providers.</span></span>
  
<span data-ttu-id="db7d3-108">Um einen Nachrichtendienst zu erstellen, schreibt ein Entwickler ein Nachrichtendienst-Einstiegspunktprogramm, um die Konfiguration der einzelnen Anbieter im Dienst zu behandeln, und ein Setupprogramm, um folgendes zu tun:</span><span class="sxs-lookup"><span data-stu-id="db7d3-108">To create a message service, a developer writes a message-service entry point program to handle the configuration of each provider in the service and a setup program to do the following:</span></span>
  
- <span data-ttu-id="db7d3-109">Installieren Sie jeden Anbieter im Dienst.</span><span class="sxs-lookup"><span data-stu-id="db7d3-109">Install each provider in the service.</span></span>
    
- <span data-ttu-id="db7d3-110">Erstellen sie Registrierungs- und Initialisierungsdateieinträge.</span><span class="sxs-lookup"><span data-stu-id="db7d3-110">Create registry and initialization file entries.</span></span>
    
- <span data-ttu-id="db7d3-111">Erstellen Sie Einträge in der MAPI-Konfigurationsdatei Mapisvc.inf.</span><span class="sxs-lookup"><span data-stu-id="db7d3-111">Create entries in the MAPI configuration file, Mapisvc.inf.</span></span>
    
<span data-ttu-id="db7d3-112">Die Datei Mapisvc.inf enthält Informationen zur Konfiguration aller auf dem Computer installierten Nachrichtendienste und Dienstanbieter.</span><span class="sxs-lookup"><span data-stu-id="db7d3-112">The Mapisvc.inf file contains information that relates to the configuration of all message services and service providers installed on the computer.</span></span> <span data-ttu-id="db7d3-113">Sie ist in hierarchischen Abschnitten organisiert, und jede Ebene ist mit der nächsten verknüpft.</span><span class="sxs-lookup"><span data-stu-id="db7d3-113">It is organized in hierarchical sections, with each level linked to the next.</span></span> <span data-ttu-id="db7d3-114">Oben finden Sie drei Abschnitte, die Folgendes enthalten:</span><span class="sxs-lookup"><span data-stu-id="db7d3-114">At the top are three sections that contain the following:</span></span> 
  
- <span data-ttu-id="db7d3-115">Eine Liste der Hilfedateien für den Nachrichtendienst.</span><span class="sxs-lookup"><span data-stu-id="db7d3-115">A list of message service Help files.</span></span>
    
- <span data-ttu-id="db7d3-116">Eine Liste der wichtigsten Oder Standardnachrichtendienste.</span><span class="sxs-lookup"><span data-stu-id="db7d3-116">A list of the most important, or default, message services.</span></span>
    
- <span data-ttu-id="db7d3-117">Eine Liste aller Dienste auf dem Computer.</span><span class="sxs-lookup"><span data-stu-id="db7d3-117">A list of all the services on the computer.</span></span>
    
<span data-ttu-id="db7d3-118">Die nächste Ebene enthält Abschnitte für jeden Nachrichtendienst, und die letzte Ebene enthält Abschnitte für jeden Dienstanbieter in einem Dienst.</span><span class="sxs-lookup"><span data-stu-id="db7d3-118">The next level contains sections for each message service, and the last level contains sections for each service provider in a service.</span></span> <span data-ttu-id="db7d3-119">MAPI erfordert, dass Entwickler von Dienstanbietern und Nachrichtendiensten bestimmte Einträge zu Mapisvc.inf hinzufügen. Entwickler können andere Einträge nach eigenem Ermessen hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="db7d3-119">MAPI requires that developers of service providers and message services add certain entries to Mapisvc.inf; developers can add other entries at their own discretion.</span></span> <span data-ttu-id="db7d3-120">Die meisten Informationen in Mapisvc.inf landen in einem oder mehreren Profilen, einer Sammlung von Konfigurationsinformationen für den bevorzugten Satz von Nachrichtendiensten eines Benutzers.</span><span class="sxs-lookup"><span data-stu-id="db7d3-120">Most of the information in Mapisvc.inf ends up in one or more profiles, a collection of configuration information for a user's preferred set of message services.</span></span> <span data-ttu-id="db7d3-121">Da ein Computer mehrere Benutzer haben kann und ein einzelner Benutzer mehrere Einstellungssätze haben kann, können viele Profile auf einem Computer vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="db7d3-121">Because a computer can have multiple users and a single user can have multiple sets of preferences, many profiles can exist on a computer.</span></span> <span data-ttu-id="db7d3-122">Jedes Profil beschreibt einen anderen Satz von Nachrichtendiensten.</span><span class="sxs-lookup"><span data-stu-id="db7d3-122">Each profile describes a different set of message services.</span></span> <span data-ttu-id="db7d3-123">Mit mehreren Profilen kann ein Benutzer z. B. zu Hause mit einem Satz von Nachrichtendiensten und im Büro mit einem anderen Satz arbeiten.</span><span class="sxs-lookup"><span data-stu-id="db7d3-123">Having multiple profiles enables a user to work, for example, at home with one set of message services and at the office with a different set.</span></span>
  
<span data-ttu-id="db7d3-124">Profile werden bei der Installation oder Anmeldung des Nachrichtendiensts von einer Clientanwendung erstellt, die Konfigurationsunterstützung bietet.</span><span class="sxs-lookup"><span data-stu-id="db7d3-124">Profiles are created at message service installation or logon time by a client application that provides configuration support.</span></span> <span data-ttu-id="db7d3-125">MAPI stellt zwei solche Clientanwendungen zur Verfügung: ein Systemsteuerungselement und den Profil-Assistenten.</span><span class="sxs-lookup"><span data-stu-id="db7d3-125">MAPI provides two such client applications: a Control Panel item and the Profile Wizard.</span></span> <span data-ttu-id="db7d3-126">Das Systemsteuerungselement ist eine Volldienstkonfigurationsanwendung, mit der Benutzer Profile erstellen, löschen, bearbeiten und kopieren sowie Änderungen an den Einträgen in einem Profil vorgenommen können.</span><span class="sxs-lookup"><span data-stu-id="db7d3-126">The Control Panel item is a full-service configuration application with which users can create, delete, edit, and copy profiles, as well as make modifications to the entries in a profile.</span></span> <span data-ttu-id="db7d3-127">Der Profil-Assistent ist eine einfache Anwendung, die das Hinzufügen eines Nachrichtendiensts zu einem Profil so einfach wie möglich macht.</span><span class="sxs-lookup"><span data-stu-id="db7d3-127">The Profile Wizard is a simple application designed to make adding a message service to a profile as easy as possible.</span></span> <span data-ttu-id="db7d3-128">Der Profil-Assistent besteht aus einer Reihe von Dialogfelder, sogenannten Eigenschaftenseiten, in der der Benutzer aufgefordert wird, einen Dienst zu installieren und zu konfigurieren.</span><span class="sxs-lookup"><span data-stu-id="db7d3-128">The Profile Wizard consists of a series of dialog boxes, called property pages, that prompt the user through the process of installing and configuring a service.</span></span> <span data-ttu-id="db7d3-129">Der Benutzer wird nur zur Eingabe von Werten für die kritischsten Einstellungen aufgefordert. Alle anderen Einstellungen erben Standardwerte.</span><span class="sxs-lookup"><span data-stu-id="db7d3-129">The user is prompted only for values for the most critical settings; all other settings inherit default values.</span></span> <span data-ttu-id="db7d3-130">Nachdem das Profil erstellt wurde, können Benutzer keine Änderungen vornehmen.</span><span class="sxs-lookup"><span data-stu-id="db7d3-130">Once the profile has been created, users are not allowed to make changes.</span></span> 
  
<span data-ttu-id="db7d3-131">Während das Systemsteuerungselement immer über die Systemsteuerung aufgerufen wird, gibt es eine Vielzahl von Szenarien, die dazu führen können, dass der Profil-Assistent aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="db7d3-131">Whereas the Control Panel item is always invoked through the Control Panel, there are a variety of scenarios that can cause the Profile Wizard to be called.</span></span> <span data-ttu-id="db7d3-132">Clientanwendungen können den Profil-Assistenten aufrufen, um ein Standardprofil zum Zeitpunkt der Anmeldung zu erstellen, wenn noch kein Profil erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="db7d3-132">Client applications can call the Profile Wizard to create a default profile at logon time when one has not yet been created.</span></span> <span data-ttu-id="db7d3-133">Anstatt Code erneut zuimplementieren, um ein Profil hinzuzufügen, kann sich das Systemsteuerungselement oder eine andere Clientanwendung auf die bereits im Profil-Assistenten vorhandenen Funktionen verlassen.</span><span class="sxs-lookup"><span data-stu-id="db7d3-133">Rather than reimplementing code to add a profile, the Control Panel item or another client application can rely on the functionality already in the Profile Wizard.</span></span> <span data-ttu-id="db7d3-134">Ein Nachrichtendienst kann in seiner Einstiegspunktfunktion den Profil-Assistenten aufrufen, wenn der Dienst dem Standardprofil hinzugefügt werden muss.</span><span class="sxs-lookup"><span data-stu-id="db7d3-134">A message service, in its entry point function, can call the Profile Wizard when the service needs to be added to the default profile.</span></span> <span data-ttu-id="db7d3-135">Nachrichtendienste, die den Profil-Assistenten verwenden, müssen eine zusätzliche Einstiegspunktfunktion und eine standard-Windows schreiben.</span><span class="sxs-lookup"><span data-stu-id="db7d3-135">Message services that use the Profile Wizard must write an extra entry point function and a standard Windows dialog box procedure.</span></span> <span data-ttu-id="db7d3-136">Der Profil-Assistent ruft die Einstiegspunktfunktion auf, um das Konfigurationsdialogfeld des Diensts abzurufen, während die Dialogfeldprozedur die Nachrichten verarbeitet, die generiert werden, wenn dieses Dialogfeld verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="db7d3-136">The Profile Wizard calls the entry point function to retrieve the service's configuration dialog box while the dialog box procedure handles the messages that are generated when this dialog box is in use.</span></span> 
  
<span data-ttu-id="db7d3-137">Profile sind ähnlich wie die Datei Mapisvc.inf organisiert.</span><span class="sxs-lookup"><span data-stu-id="db7d3-137">Profiles are organized in a similar way to the Mapisvc.inf file.</span></span> <span data-ttu-id="db7d3-138">Profile haben verknüpfte hierarchische Abschnitte; Dienstanbieter besitzen Abschnitte auf der niedrigsten Ebene, Nachrichtendienste eigene Abschnitte auf der mittleren Ebene, und MAPI besitzt Abschnitte auf der höchsten Ebene.</span><span class="sxs-lookup"><span data-stu-id="db7d3-138">Profiles have linked hierarchical sections; service providers own sections in the lowest level, message services own sections in the middle level, and MAPI owns sections in the highest level.</span></span> <span data-ttu-id="db7d3-139">Jeder Abschnitt wird mit einem eindeutigen Bezeichner identifiziert, der als [MAPIUID bezeichnet wird.](mapiuid.md)</span><span class="sxs-lookup"><span data-stu-id="db7d3-139">Each section is identified with a unique identifier known as a [MAPIUID](mapiuid.md).</span></span> <span data-ttu-id="db7d3-140">Die MAPI-Abschnitte enthalten interne Informationen für MAPI, z. B. die Bezeichner aller Abschnitte des Nachrichtendienstprofils und Links zu jedem der anderen Abschnitte.</span><span class="sxs-lookup"><span data-stu-id="db7d3-140">The MAPI sections contain information internal to MAPI, such as the identifiers of all of the message service profile sections and links to each of the other sections.</span></span> <span data-ttu-id="db7d3-141">In jedem Abschnitt des Nachrichtendiensts werden Links zu den jeweiligen Anbieterabschnitten und in jedem Anbieterabschnitt ein Link zu seinem Dienstabschnitt speichert.</span><span class="sxs-lookup"><span data-stu-id="db7d3-141">Each message service section stores links to its provider sections, and each provider section stores a link to its service section.</span></span> 
  
<span data-ttu-id="db7d3-142">Die folgende Abbildung zeigt den Inhalt von zwei typischen Profilen.</span><span class="sxs-lookup"><span data-stu-id="db7d3-142">The following illustration shows the contents of two typical profiles.</span></span> <span data-ttu-id="db7d3-143">Sam verfügt über zwei Profile auf seinem Computer, eines für die Heimnutzung und eines für die Verwendung im Büro.</span><span class="sxs-lookup"><span data-stu-id="db7d3-143">Sam has two profiles on his computer, one for home use and one for office use.</span></span> <span data-ttu-id="db7d3-144">Das Startprofil enthält drei Nachrichtendienste.</span><span class="sxs-lookup"><span data-stu-id="db7d3-144">The home profile contains three message services.</span></span> <span data-ttu-id="db7d3-145">Message Service X ist ein einzelner Anbieterdienst für die Adressbuchverwaltung.</span><span class="sxs-lookup"><span data-stu-id="db7d3-145">Message Service X is a single provider service for address book management.</span></span> <span data-ttu-id="db7d3-146">Nachrichtendienste Y und Z verfügen über drei Anbieter – einen Adressbuchanbieter, einen Nachrichtenspeicheranbieter und einen Transportanbieter.</span><span class="sxs-lookup"><span data-stu-id="db7d3-146">Message Services Y and Z have three providers — an address book provider, a message store provider, and a transport provider.</span></span> <span data-ttu-id="db7d3-147">Sams Arbeitsprofil enthält zwei verschiedene Nachrichtendienste, von denen jeder über einen Adressbuchanbieter, einen Nachrichtenspeicheranbieter und einen Transportanbieter verfügt.</span><span class="sxs-lookup"><span data-stu-id="db7d3-147">Sam's Work Profile contains two different message services, each of which has an address book provider, a message store provider, and a transport provider.</span></span> 
  
<span data-ttu-id="db7d3-148">**Profilbeispiel**</span><span class="sxs-lookup"><span data-stu-id="db7d3-148">**Profile example**</span></span>
  
<span data-ttu-id="db7d3-149">![Profilbeispiel](media/amapi_56.gif "Profilbeispiel")</span><span class="sxs-lookup"><span data-stu-id="db7d3-149">![Profile example](media/amapi_56.gif "Profile example")</span></span>
  
<span data-ttu-id="db7d3-150">Die folgende Abbildung zeigt ein Profil, das zwei Nachrichtendienste enthält.</span><span class="sxs-lookup"><span data-stu-id="db7d3-150">The following illustration shows a profile that includes two message services.</span></span> <span data-ttu-id="db7d3-151">Der Code zum Installieren und Konfigurieren der Dienstanbieter, die zum Nachrichtendienst gehören, befindet sich in derselben DLL wie der Code für die Anbieter.</span><span class="sxs-lookup"><span data-stu-id="db7d3-151">The code for installing and configuring the service providers that belong to the message service resides in the same DLL as the code for the providers.</span></span> <span data-ttu-id="db7d3-152">Dieser Code liest Informationen aus dem Profil zur Anmeldezeit, um die Dienstanbieter zu konfigurieren, und fordert den Benutzer auf, wenn möglich und erforderlich, fehlende Informationen zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="db7d3-152">This code reads information from the profile at logon time to configure the service providers, and it prompts the user, if possible and necessary, for missing information.</span></span> <span data-ttu-id="db7d3-153">Anforderungen eines Clients zum Anzeigen oder Ändern von Konfigurationseinstellungen für einen der Anbieter werden ebenfalls durch diesen allgemeinen Code behandelt.</span><span class="sxs-lookup"><span data-stu-id="db7d3-153">Requests from a client to view or change configuration settings for any of the providers are also handled by this common code.</span></span>
  
<span data-ttu-id="db7d3-154">**Installieren und Konfigurieren von Serviceanbietern**</span><span class="sxs-lookup"><span data-stu-id="db7d3-154">**Installing and configuring service providers**</span></span>
  
<span data-ttu-id="db7d3-155">![Installieren und Konfigurieren von Dienstanbietern](media/amapi_55.gif "Installieren und Konfigurieren von Dienstanbietern")</span><span class="sxs-lookup"><span data-stu-id="db7d3-155">![Installing and configuring service providers](media/amapi_55.gif "Installing and configuring service providers")</span></span>
  
## <a name="see-also"></a><span data-ttu-id="db7d3-156">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="db7d3-156">See also</span></span>

- [<span data-ttu-id="db7d3-157">MAPIUID</span><span class="sxs-lookup"><span data-stu-id="db7d3-157">MAPIUID</span></span>](mapiuid.md)
- [<span data-ttu-id="db7d3-158">Übersicht über die MAPI-Programmierung</span><span class="sxs-lookup"><span data-stu-id="db7d3-158">MAPI Programming Overview</span></span>](mapi-programming-overview.md)

