---
title: Transportanbieterrolle im MAPI-Subsystem
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 7659369a-0952-4f5a-a86b-91958c4c1a3f
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 7cadb57706e3feec7ed98dd5e4e8d75967036fef
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33424056"
---
# <a name="transport-provider-role-in-the-mapi-subsystem"></a><span data-ttu-id="540f9-103">Transportanbieterrolle im MAPI-Subsystem</span><span class="sxs-lookup"><span data-stu-id="540f9-103">Transport provider role in the MAPI subsystem</span></span>
  
<span data-ttu-id="540f9-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="540f9-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="540f9-105">DlLs (Dynamic Link Libraries) des Transportanbieters stellen die Schnittstelle zwischen dem MAPI-Spooler und dem Teil eines Messagingsystems bereit, das für das Senden und Empfangen von Nachrichten zuständig ist.</span><span class="sxs-lookup"><span data-stu-id="540f9-105">Transport provider dynamic-link libraries (DLLs) provide the interface between the MAPI spooler and the part of a messaging system responsible for message sending and receiving.</span></span> <span data-ttu-id="540f9-106">Der MAPI-Spooler und der Transportanbieter arbeiten zusammen, um die Verantwortlichkeiten des Sendens einer Nachricht oder des Empfangens einer Nachricht zu übernehmen.</span><span class="sxs-lookup"><span data-stu-id="540f9-106">The MAPI spooler and the transport provider work together to handle the responsibilities of sending a message or receiving a message.</span></span> <span data-ttu-id="540f9-107">Der MAPI-Spooler lädt die Transportanbieter-DLL, wenn sie zum ersten Mal verwendet wird, und gibt sie frei, wenn sie nicht mehr benötigt wird.</span><span class="sxs-lookup"><span data-stu-id="540f9-107">The MAPI spooler loads the transport provider DLL when it is first used and releases it when it is no longer needed.</span></span> <span data-ttu-id="540f9-108">Mehrere Transportanbieter können auf demselben System installiert werden, aber MAPI stellt den erforderlichen Spooler zur.</span><span class="sxs-lookup"><span data-stu-id="540f9-108">Multiple transport providers can be installed on the same system, but MAPI supplies the one spooler required.</span></span>
  
<span data-ttu-id="540f9-109">Clientanwendungen kommunizieren in der Regel nicht direkt mit dem Transportanbieter.</span><span class="sxs-lookup"><span data-stu-id="540f9-109">Client applications do not typically communicate directly with the transport provider.</span></span> <span data-ttu-id="540f9-110">Stattdessen senden Clients Nachrichten über einen Speicheranbieter, und der MAPI-Spooler sendet ausgehende Nachrichten an den entsprechenden Transportanbieter und übermittelt eingehende Nachrichten an den entsprechenden Nachrichtenspeicher.</span><span class="sxs-lookup"><span data-stu-id="540f9-110">Rather, clients submit messages through a store provider and the MAPI spooler sends outgoing messages to the appropriate transport provider and delivers incoming messages to the appropriate message store.</span></span> <span data-ttu-id="540f9-111">Der MAPI-Spooler führt seine Arbeit aus und ruft Transportanbieter auf, wenn sich Vordergrundanwendungen im Leerlauf befinden.</span><span class="sxs-lookup"><span data-stu-id="540f9-111">The MAPI spooler does its work and makes its calls to transport providers when foreground applications are idle.</span></span> <span data-ttu-id="540f9-112">Nach der optionalen Anzeige von Dialogfeldern bei der ersten Anmeldung des Transportanbieters werden transportprovider im Hintergrund ausgeführt, es sei denn, der Client wird zum Leeren von Sende- und Empfangswarteschlangen aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="540f9-112">After optionally displaying dialog boxes when the transport provider is first logged on, transport providers operate in the background unless called by the client to flush send and receive queues.</span></span> 
  
<span data-ttu-id="540f9-113">Transportanbieter haben in einem MAPI-Messagingsystem die folgenden Zuständigkeiten:</span><span class="sxs-lookup"><span data-stu-id="540f9-113">Transport providers have the following responsibilities in a MAPI messaging system:</span></span>
  
- <span data-ttu-id="540f9-114">Registrieren Sie die Adresstypen, die sie mit dem MAPI-Spooler akzeptieren können, damit der MAPI-Spooler Nachrichten abhängig von der Zieladresse der Nachrichten an den entsprechenden Transportanbieter übermitteln kann.</span><span class="sxs-lookup"><span data-stu-id="540f9-114">Register the address types they can accept with the MAPI spooler so the MAPI spooler can submit messages to the appropriate transport provider depending on the destination address of the messages.</span></span> <span data-ttu-id="540f9-115">Ein Transportanbieter kann mehrere Adresstypen registrieren.</span><span class="sxs-lookup"><span data-stu-id="540f9-115">One transport provider can register more than one address type.</span></span> <span data-ttu-id="540f9-116">Transportanbieter können auch die Adressen bestimmter Empfänger mit dem MAPI-Spooler registrieren.</span><span class="sxs-lookup"><span data-stu-id="540f9-116">Transport providers can also register specific recipients' addresses with the MAPI spooler.</span></span> <span data-ttu-id="540f9-117">Nachrichten, die an eine dieser Adressen adressiert sind, werden an den Transportanbieter übermittelt, der die Adresse beim MAPI-Spooler registriert hat.</span><span class="sxs-lookup"><span data-stu-id="540f9-117">Messages addressed to one of these addresses will be submitted to the transport provider that registered the address with the MAPI spooler.</span></span> <span data-ttu-id="540f9-118">Weitere Informationen finden Sie [unter Transport Provider and MAPI Spooler Operational Model](transport-provider-and-mapi-spooler-operational-model.md).</span><span class="sxs-lookup"><span data-stu-id="540f9-118">For more information, see [Transport Provider and MAPI Spooler Operational Model](transport-provider-and-mapi-spooler-operational-model.md).</span></span>
    
- <span data-ttu-id="540f9-119">Senden eingehender Nachrichten an den MAPI-Spooler.</span><span class="sxs-lookup"><span data-stu-id="540f9-119">Deliver incoming messages to the MAPI spooler.</span></span> <span data-ttu-id="540f9-120">Je nach Art des Messagingsystems kann ein Transportanbieter den MAPI-Spooler entweder direkt benachrichtigen, wenn eine neue Nachricht eintrifft, oder er kann anfordern, dass der MAPI-Spooler den Transportanbieter regelmäßig abruft, um nach neuen Nachrichten zu suchen.</span><span class="sxs-lookup"><span data-stu-id="540f9-120">Depending on the nature of the messaging system, a transport provider can either directly notify the MAPI spooler when a new message arrives, or it can request that the MAPI spooler poll the transport provider periodically to check for new messages.</span></span>
    
- <span data-ttu-id="540f9-121">Konvertieren von MAPI-Nachrichteneigenschaften in und von Nachrichteneigenschaften, die für das Messagingsystem nativ sind.</span><span class="sxs-lookup"><span data-stu-id="540f9-121">Convert MAPI message properties to and from message properties native to the messaging system.</span></span> <span data-ttu-id="540f9-122">Der Transportanbieter muss beispielsweise die Adressen des Absenders und empfängers in einer ausgehenden Nachricht in ein Formular konvertieren, das für das Messagingsystem akzeptabel ist.</span><span class="sxs-lookup"><span data-stu-id="540f9-122">For example, the transport provider might have to convert the sender's and recipient's addresses in an outgoing message to a form that is acceptable to the messaging system.</span></span> <span data-ttu-id="540f9-123">Einige Messagingsysteme unterstützen nicht alle MAPI-Nachrichteneigenschaften.</span><span class="sxs-lookup"><span data-stu-id="540f9-123">Some messaging systems do not support all of the MAPI message properties.</span></span> <span data-ttu-id="540f9-124">Weitere Informationen zum Beibehalten von MAPI-Nachrichteneigenschaften beim Senden von Nachrichten an ein Messagingsystem finden Sie unter [Developing a TNEF-Enabled Transport Provider](developing-a-tnef-enabled-transport-provider.md).</span><span class="sxs-lookup"><span data-stu-id="540f9-124">For more information about preserving MAPI message properties when delivering messages to a messaging system, see [Developing a TNEF-Enabled Transport Provider](developing-a-tnef-enabled-transport-provider.md).</span></span>
    
- <span data-ttu-id="540f9-125">Registrieren Von Nachrichten- und Empfängeroptionen, die für den Transportanbieter spezifisch sind.</span><span class="sxs-lookup"><span data-stu-id="540f9-125">Register message and recipient options specific to the transport provider.</span></span>
    
- <span data-ttu-id="540f9-126">Führen Sie eine Überprüfung der anmeldeinformationen durch, die vom Messagingsystem erforderlich sind.</span><span class="sxs-lookup"><span data-stu-id="540f9-126">Perform any verification of credentials required by the messaging system.</span></span>
    
- <span data-ttu-id="540f9-127">Greifen Sie auf ausgehende Nachrichten zu, indem Sie das message-Objekt verwenden, das vom MAPI-Spooler an sie übergeben wird.</span><span class="sxs-lookup"><span data-stu-id="540f9-127">Access outbound messages using the message object passed to it by the MAPI spooler.</span></span>
    
- <span data-ttu-id="540f9-128">Übersetzen Sie das Nachrichtenformat, wie es vom zugrunde liegenden Messagingsystem erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="540f9-128">Translate message format as required by the underlying messaging system.</span></span>
    
- <span data-ttu-id="540f9-129">Benachrichtigen Sie den #A0 darüber, welche Empfänger einer ausgehenden Nachricht der Transportanbieter für die Verarbeitung verantwortlich ist, indem Sie die **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) -Eigenschaft für diese Empfänger festlegen.</span><span class="sxs-lookup"><span data-stu-id="540f9-129">Notify the MAPI spooler which recipients of an outgoing message the transport provider has accepted responsibility for handling by setting the **PR_RESPONSIBILITY** ([PidTagResponsibility](pidtagresponsibility-canonical-property.md)) property for those recipients.</span></span>
    
- <span data-ttu-id="540f9-130">Informieren Sie den MAPI-Spooler, wenn eine eingehende Nachricht verarbeitet werden muss.</span><span class="sxs-lookup"><span data-stu-id="540f9-130">Inform the MAPI spooler when an incoming message needs to be handled.</span></span>
    
- <span data-ttu-id="540f9-131">Übergeben Sie eingehende Nachrichtendaten mithilfe von Nachrichtenobjekten an den MAPI-Spooler.</span><span class="sxs-lookup"><span data-stu-id="540f9-131">Pass incoming message data to the MAPI spooler by using message objects.</span></span>
    
- <span data-ttu-id="540f9-132">Zuweisen von Werten zu allen erforderlichen MAPI-Nachrichteneigenschaften für eingehende Nachrichten.</span><span class="sxs-lookup"><span data-stu-id="540f9-132">Assign values to all required MAPI message properties on incoming messages.</span></span>
    
- <span data-ttu-id="540f9-133">Löschen Sie die Nachricht nach der Zustellung nach Bedarf aus dem zugrunde liegenden Messagingsystem.</span><span class="sxs-lookup"><span data-stu-id="540f9-133">Delete the message from the underlying messaging system after delivery, if necessary.</span></span>
    
- <span data-ttu-id="540f9-134">Bereitstellen von Statusinformationen für die MAPI-Spooler- und Clientanwendungen.</span><span class="sxs-lookup"><span data-stu-id="540f9-134">Provide status information for the MAPI spooler and client applications.</span></span>
    
<span data-ttu-id="540f9-135">Die folgende Abbildung zeigt die Rolle eines Transportanbieters im Hinblick auf die anderen Komponenten der MAPI-Architektur.</span><span class="sxs-lookup"><span data-stu-id="540f9-135">The following illustration shows a transport provider's role with respect to the other components of the MAPI architecture.</span></span>
  
<span data-ttu-id="540f9-136">**Transportanbieterrolle in einem Messaging-System**</span><span class="sxs-lookup"><span data-stu-id="540f9-136">**Transport provider role in a messaging system**</span></span>
  
<span data-ttu-id="540f9-137">![Rolle des Transportanbieters in einem Messagingsystem](media/xp01.gif "Transport provider role in a messaging system")</span><span class="sxs-lookup"><span data-stu-id="540f9-137">![Transport provider role in a messaging system](media/xp01.gif "Transport provider role in a messaging system")</span></span>
  

