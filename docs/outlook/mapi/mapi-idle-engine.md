---
title: MAPI Idle Engine
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 755d096a-2a61-44d2-a765-5d464a857756
description: 'Letzte Änderung: Montag, 9. März 2015'
ms.openlocfilehash: d8d591c02bb621c16a1d1b46272b19573ea79785
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33428452"
---
# <a name="mapi-idle-engine"></a><span data-ttu-id="1507a-103">MAPI Idle Engine</span><span class="sxs-lookup"><span data-stu-id="1507a-103">MAPI Idle Engine</span></span>

  
  
<span data-ttu-id="1507a-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="1507a-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="1507a-105">MAPI bietet mehrere Funktionen, die gemeinsam als Leerlaufmodul bezeichnet werden.</span><span class="sxs-lookup"><span data-stu-id="1507a-105">MAPI provides several functions that are collectively known as the idle engine.</span></span> <span data-ttu-id="1507a-106">Mit diesen Funktionen können Clients, Adressbuchanbieter und Nachrichtenspeicheranbieter verschiedene Aufgaben in langsamen Zeiten in der Sitzung oder als Reaktion auf eine langsame Zeit ausführen.</span><span class="sxs-lookup"><span data-stu-id="1507a-106">These functions allow clients, address book providers, and message store providers to perform various tasks during slow times in the session or in response to a slow time.</span></span> <span data-ttu-id="1507a-107">Clients und Dienstanbieter können z. B. langsame Vorgänge zurückdingen oder Dateien schließen, die für einen längeren Zeitraum nicht verwendet wurden.</span><span class="sxs-lookup"><span data-stu-id="1507a-107">For example, clients and service providers can defer slow operations or close files that have remained unused for a lengthy period.</span></span> <span data-ttu-id="1507a-108">Transportanbieter verwenden in der Regel nicht das Leerlaufmodul, da die **IXPLogon::Idle-Methode** ihren Platz einnimmt.</span><span class="sxs-lookup"><span data-stu-id="1507a-108">Transport providers typically do not use the idle engine because the **IXPLogon::Idle** method takes its place.</span></span> <span data-ttu-id="1507a-109">Weitere Informationen finden Sie unter [IXPLogon::Idle](ixplogon-idle.md).</span><span class="sxs-lookup"><span data-stu-id="1507a-109">For more information, see [IXPLogon::Idle](ixplogon-idle.md).</span></span>
  
<span data-ttu-id="1507a-110">Um das Leerlaufmodul zu verwenden, erstellen Clients und Dienstanbieter eine Rückruffunktion, die die Aufgaben enthält, die auftreten sollten, wenn sich das MAPI-Subsystem im Leerlauf befindet.</span><span class="sxs-lookup"><span data-stu-id="1507a-110">To use the idle engine, clients and service providers create a callback function that contains the tasks that should occur when the MAPI subsystem is idle.</span></span> <span data-ttu-id="1507a-111">Wenn MAPI Leerlaufzeit erkennt, wird diese Rückruffunktion aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="1507a-111">When MAPI detects idle time, it invokes this callback function.</span></span> <span data-ttu-id="1507a-112">Die Rückruffunktion folgt dem **FNIDLE-Prototyp,** der wie folgt definiert ist:</span><span class="sxs-lookup"><span data-stu-id="1507a-112">The callback function follows the **FNIDLE** prototype, defined as follows:</span></span> 
  
 `BOOL (STDAPICALLTYPE FNIDLE) (LPVOID lpvContext)`
  
<span data-ttu-id="1507a-113">Weitere Informationen finden Sie unter [FNIDLE](fnidle.md).</span><span class="sxs-lookup"><span data-stu-id="1507a-113">For more information, see [FNIDLE](fnidle.md).</span></span>
  
<span data-ttu-id="1507a-114">Die Funktionen des Leerlaufmoduls sind:</span><span class="sxs-lookup"><span data-stu-id="1507a-114">The functions that make up the idle engine are:</span></span>
  
[<span data-ttu-id="1507a-115">ChangeIdleRoutine</span><span class="sxs-lookup"><span data-stu-id="1507a-115">ChangeIdleRoutine</span></span>](changeidleroutine.md)
  
[<span data-ttu-id="1507a-116">DeregisterIdleRoutine</span><span class="sxs-lookup"><span data-stu-id="1507a-116">DeregisterIdleRoutine</span></span>](deregisteridleroutine.md)
  
[<span data-ttu-id="1507a-117">EnableIdleRoutine</span><span class="sxs-lookup"><span data-stu-id="1507a-117">EnableIdleRoutine</span></span>](enableidleroutine.md)
  
[<span data-ttu-id="1507a-118">FtgRegisterIdleRoutine</span><span class="sxs-lookup"><span data-stu-id="1507a-118">FtgRegisterIdleRoutine</span></span>](ftgregisteridleroutine.md)
  
[<span data-ttu-id="1507a-119">MAPIDeInitIdle</span><span class="sxs-lookup"><span data-stu-id="1507a-119">MAPIDeInitIdle</span></span>](mapideinitidle.md)
  
[<span data-ttu-id="1507a-120">MAPIInitIdle</span><span class="sxs-lookup"><span data-stu-id="1507a-120">MAPIInitIdle</span></span>](mapiinitidle.md)
  
<span data-ttu-id="1507a-121">Um eine Rückruffunktion zu registrieren, rufen Clients und Dienstanbieter die **FtgRegisterIdleRoutine-Funktion** auf.</span><span class="sxs-lookup"><span data-stu-id="1507a-121">To register a callback function, clients and service providers call the **FtgRegisterIdleRoutine** function.</span></span> <span data-ttu-id="1507a-122">Die Eingabeparameter umfassen eine optionale Priorität, einen Speicherblock, der an Ihre Rückruffunktion als Eingabe übergeben wird, einen Zeitraum, der in irgendeiner Weise verwendet werden muss, und eine Reihe von Optionskennzeichen.</span><span class="sxs-lookup"><span data-stu-id="1507a-122">The input parameters include an optional priority, a block of memory that is passed to your callback function as input, an amount of time to be used in any way appropriate, and a set of option flags.</span></span> 
  
<span data-ttu-id="1507a-123">Clients und Dienstanbieter können eine Priorität im  _priIdle-Parameter_ angeben, der steuert, wie die Leerlauffunktion ausgeführt wird, oder Null angeben, wenn die Priorität kein Problem ist.</span><span class="sxs-lookup"><span data-stu-id="1507a-123">Clients and service providers can specify a priority in the  _priIdle_ parameter that controls how the idle function runs or specify zero if priority is not an issue.</span></span> <span data-ttu-id="1507a-124">Da negative Zahlen höhere Prioritäten als positive Zahlen oder Null darstellen, sollten Komprimierungs- und Suchvorgängen negative Zahlen zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="1507a-124">Because negative numbers represent higher priorities than positive numbers or zero, compression and search operations should be assigned negative numbers.</span></span> <span data-ttu-id="1507a-125">Vorgängen, die einmal auftreten, sollten positive Zahlen zugewiesen werden.</span><span class="sxs-lookup"><span data-stu-id="1507a-125">Tasks that occur once should be assigned positive numbers.</span></span> 
  
<span data-ttu-id="1507a-126">Zum Aufheben der Registrierung einer aktiven Rückruffunktion rufen Clients und Dienstanbieter die **DeregisterIdleRoutine-Funktion** auf.</span><span class="sxs-lookup"><span data-stu-id="1507a-126">To deregister an active callback function, clients and service providers call the **DeregisterIdleRoutine** function.</span></span> <span data-ttu-id="1507a-127">Da **DeregisterIdleRoutine** asynchron funktioniert, kann die Rückruffunktion jederzeit während des Registrierungsaufrufs und möglicherweise auch nach der **DeregisterIdleRoutine** aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="1507a-127">Because **DeregisterIdleRoutine** operates asynchronously, it is possible for the callback function to be invoked at any time during the deregister call and possibly even after **DeregisterIdleRoutine** has returned.</span></span> 
  
<span data-ttu-id="1507a-128">Um einige oder alle Merkmale einer Rückruffunktion zu ändern, rufen Clients und Dienstanbieter die **ChangeIdleRoutine-Funktion** auf.</span><span class="sxs-lookup"><span data-stu-id="1507a-128">To modify some or all of the characteristics of a callback function, clients and service providers call the **ChangeIdleRoutine** function.</span></span> <span data-ttu-id="1507a-129">**ChangeIdleRoutine** nimmt Änderungen an der Einstellung des flags-Parameters  _"ircIdle"_ vor. **ChangeIdleRoutine** kann die Funktion selbst, ihre Priorität, Die Zeiteinstellung und den Eingabeparameter ändern.</span><span class="sxs-lookup"><span data-stu-id="1507a-129">**ChangeIdleRoutine** makes changes according to how the flags parameter  _ircIdle_ is set; **ChangeIdleRoutine** can change the function itself, its priority, time setting, and input parameter.</span></span> 
  
<span data-ttu-id="1507a-130">MAPI definiert leerlauf wie das Betriebssystem, wenn das Betriebssystem über eine Definition verfügt.</span><span class="sxs-lookup"><span data-stu-id="1507a-130">MAPI defines idle the same as the operating system, when the operating system has a definition.</span></span> <span data-ttu-id="1507a-131">In Win32 erstellt MAPI einen Thread mit Der Priorität der Leerlaufklasse, um Aufgaben im Leerlauf zu planen.</span><span class="sxs-lookup"><span data-stu-id="1507a-131">On Win32, MAPI creates a thread with idle-class priority to schedule idle tasks.</span></span> <span data-ttu-id="1507a-132">Dieser Thread verfolgt die Uhrzeit und postet eine Nachricht an den Thread, der die Leerlaufaufgabe ausführen soll, wenn der Zeitpunkt für die Ausführung eintrifft.</span><span class="sxs-lookup"><span data-stu-id="1507a-132">This thread keeps track of the time and posts a message to the thread that is to execute the idle task when the time for its execution arrives.</span></span> <span data-ttu-id="1507a-133">Win32 plant Threads, nicht Prozesse.</span><span class="sxs-lookup"><span data-stu-id="1507a-133">Win32 schedules threads, not processes.</span></span> <span data-ttu-id="1507a-134">Wenn Vorgänge mit einer Höheren Priorität als die Leerlaufpriorität auf der Arbeitsstation ausgeführt werden, sollte die Leerlaufaufgabe erst nach Abschluss der Vorgänge für die Ausführung geplant werden.</span><span class="sxs-lookup"><span data-stu-id="1507a-134">If tasks that have a priority higher than the idle priority are occurring on the workstation, the idle task should not get scheduled for execution until the tasks have completed.</span></span> 
  
<span data-ttu-id="1507a-135">Alle Leerlaufaufgaben werden im Thread ausgeführt, der **MAPIInitIdle aufgerufen hat.**</span><span class="sxs-lookup"><span data-stu-id="1507a-135">All idle tasks run on the thread that called **MAPIInitIdle**.</span></span> <span data-ttu-id="1507a-136">MAPI verfügt über einen separaten Thread für die Planung, aber wenn eine Leerlaufaufgabe berechtigt wird, wird eine Nachricht zurück an den Initialisierungsthread gesendet, und die Leerlaufaufgabe wird dort ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="1507a-136">MAPI has a separate thread for scheduling, but when an idle task becomes eligible, it posts a message back over to the initialization thread and the idle task is executed there.</span></span> <span data-ttu-id="1507a-137">Die Auswirkungen auf unterschiedliche Typen von Clients sind wie folgt:</span><span class="sxs-lookup"><span data-stu-id="1507a-137">The implications for different types of clients are as follows.</span></span>
  
|<span data-ttu-id="1507a-138">**Threadmodell**</span><span class="sxs-lookup"><span data-stu-id="1507a-138">**Threading model**</span></span>|<span data-ttu-id="1507a-139">**Implikationen**</span><span class="sxs-lookup"><span data-stu-id="1507a-139">**Implication**</span></span>|
|:-----|:-----|
|<span data-ttu-id="1507a-140">Singlethreading</span><span class="sxs-lookup"><span data-stu-id="1507a-140">Single-threaded</span></span>  <br/> |<span data-ttu-id="1507a-141">Kein Problem.</span><span class="sxs-lookup"><span data-stu-id="1507a-141">No problem.</span></span> <span data-ttu-id="1507a-142">Leerlauffunktionen werden im Hauptthread Ihres Clients ausgeführt und über die Nachrichtenschleife serialisiert.</span><span class="sxs-lookup"><span data-stu-id="1507a-142">Idle functions execute on your client's main thread and are serialized through the message loop.</span></span>  <br/> |
|<span data-ttu-id="1507a-143">Freethreading</span><span class="sxs-lookup"><span data-stu-id="1507a-143">Free-threaded</span></span>  <br/> |<span data-ttu-id="1507a-144">Leerlauffunktionen müssen threadsicher sein, aber Ihr Client verfügt bereits über die erforderliche Infrastruktur.</span><span class="sxs-lookup"><span data-stu-id="1507a-144">Idle functions must be thread-safe, but your client already has the necessary infrastructure.</span></span> <span data-ttu-id="1507a-145">Ihr Client benötigt möglicherweise das MAPI-Leerlaufmodul überhaupt nicht.</span><span class="sxs-lookup"><span data-stu-id="1507a-145">Your client might not need the MAPI idle engine at all.</span></span>  <br/> |
|<span data-ttu-id="1507a-146">Apartmentthreading</span><span class="sxs-lookup"><span data-stu-id="1507a-146">Apartment-threaded</span></span>  <br/> |<span data-ttu-id="1507a-147">Die Idle-Funktion muss für denselben Thread ausgeführt werden, der sie registriert hat, wenn sie MAPI, OLE oder andere COM-Schnittstellen verwenden möchte.</span><span class="sxs-lookup"><span data-stu-id="1507a-147">Idle function has to execute on the same thread that registered it if it wants to use MAPI, OLE, or any other COM interfaces.</span></span> <span data-ttu-id="1507a-148">Die unkomplizierteste Möglichkeit besteht in der Registrierung einer Leerlauffunktion bei MAPI, die eine Nachricht an den richtigen Thread postet und die "echte" Leerlauffunktion direkt aus der Nachrichtenschleife dieses Threads zurücksennen.</span><span class="sxs-lookup"><span data-stu-id="1507a-148">The most straightforward way is to register an idle function with MAPI that posts a message to the right thread and dispatch the "real" idle function directly from that thread's message loop.</span></span>  <br/> |
   

