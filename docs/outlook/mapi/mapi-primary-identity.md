---
title: PRIMÄRE MAPI-Identität
manager: soliver
ms.date: 03/09/2015
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 8787a873-6752-4b17-8ea3-8fed793e1371
description: 'Letzte Änderung: Montag, 9. März 2015'
ms.openlocfilehash: 5bf88de280b012c54d4caaac6bdfe877f476ac37
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33404722"
---
# <a name="mapi-primary-identity"></a><span data-ttu-id="d849e-103">PRIMÄRE MAPI-Identität</span><span class="sxs-lookup"><span data-stu-id="d849e-103">MAPI Primary Identity</span></span>

  
  
<span data-ttu-id="d849e-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="d849e-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="d849e-105">Die meisten MAPI-Sitzungen verfügen über einen bestimmten Dienstanbieter, der die primäre Identität für die Sitzung liefert.</span><span class="sxs-lookup"><span data-stu-id="d849e-105">Most MAPI sessions have a particular service provider that supplies the primary identity for the session.</span></span> <span data-ttu-id="d849e-106">In der Regel handelt es sich um einen Adressbuchanbieter, der Identität über eines seiner Messagingbenutzerobjekte oder Verteilerlisten liefert.</span><span class="sxs-lookup"><span data-stu-id="d849e-106">Typically, it is an address book provider, which supplies identity through one of its messaging user objects or distribution lists.</span></span> <span data-ttu-id="d849e-107">In der Tat empfiehlt MAPI, dass Nachrichtendienste, die einen Adressbuchanbieter enthalten, eines ihrer Objekte für die primäre Identität verwenden.</span><span class="sxs-lookup"><span data-stu-id="d849e-107">In fact, MAPI recommends that message services that include an address book provider use one of its objects for the primary identity.</span></span> <span data-ttu-id="d849e-108">Wenn ein Dienstanbieter, der zu einem Nachrichtendienst gehört, die primäre Identität liefert, teilen sich alle anderen Dienstanbieter im Nachrichtendienst diese Identität.</span><span class="sxs-lookup"><span data-stu-id="d849e-108">When a service provider that belongs to a message service supplies the primary identity, all of the other service providers in the message service share this identity.</span></span>
  
<span data-ttu-id="d849e-109">Der MAPISVC. Die INF-Konfigurationsdatei enthält Einträge zur Identität auf Nachrichtendienst- und Dienstanbieterebene.</span><span class="sxs-lookup"><span data-stu-id="d849e-109">The MAPISVC.INF configuration file has entries relating to identity at both the message service and service provider level.</span></span> <span data-ttu-id="d849e-110">Die Abschnitte des Nachrichtendiensts müssen einen Eintrag enthalten, der antrat, ob der Dienst die primäre Identität liefern kann. Dienstanbieterabschnitte enthalten einen ähnlichen Eintrag nur, wenn der Anbieter eine Identität liefern kann.</span><span class="sxs-lookup"><span data-stu-id="d849e-110">Message service sections must include an entry that states whether or not the service can supply the primary identity; service provider sections include a similar entry only when the provider can supply an identity.</span></span>
  
<span data-ttu-id="d849e-111">In der folgenden Tabelle sind die Einträge aufgeführt, die in den Abschnitten nachrichtendienst und Dienstanbieter in MAPISVC angezeigt werden. INF-Datei.</span><span class="sxs-lookup"><span data-stu-id="d849e-111">The following table lists the entries that appear in the message service and service provider sections in the MAPISVC.INF file.</span></span>
  
|<span data-ttu-id="d849e-112">**Primärer Identitätsanbieter**</span><span class="sxs-lookup"><span data-stu-id="d849e-112">**Primary identity supplier**</span></span>|<span data-ttu-id="d849e-113">**PR_RESOURCE_FLAGS-Einstellung**</span><span class="sxs-lookup"><span data-stu-id="d849e-113">**PR_RESOURCE_FLAGS setting**</span></span>|
|:-----|:-----|
|<span data-ttu-id="d849e-114">Nachrichtendienst</span><span class="sxs-lookup"><span data-stu-id="d849e-114">Message service</span></span>  <br/> | `SERVICE_PRIMARY_IDENTITY` <br/> |
|<span data-ttu-id="d849e-115">Nicht der Nachrichtendienst</span><span class="sxs-lookup"><span data-stu-id="d849e-115">Not the message service</span></span>  <br/> | `SERVICE_NO_PRIMARY_IDENTITY` <br/> |
|<span data-ttu-id="d849e-116">Dienstanbieter</span><span class="sxs-lookup"><span data-stu-id="d849e-116">Service provider</span></span>  <br/> | `STATUS_PRIMARY_IDENTITY` <br/> |
   
<span data-ttu-id="d849e-117">Obwohl mehrere Nachrichtendienste ihre Fähigkeit zum Bereitstellen der primären Identität einer Sitzung deklarieren können, ist dafür nur ein Nachrichtendienst ausgewählt.</span><span class="sxs-lookup"><span data-stu-id="d849e-117">Although multiple message services can declare their ability to provide a session's primary identity, only one message service is selected to do so.</span></span> <span data-ttu-id="d849e-118">Diese Auswahl kann auftreten:</span><span class="sxs-lookup"><span data-stu-id="d849e-118">This selection can occur:</span></span>
  
- <span data-ttu-id="d849e-119">Wenn ein Profil erstellt wird.</span><span class="sxs-lookup"><span data-stu-id="d849e-119">When a profile is created.</span></span>
    
- <span data-ttu-id="d849e-120">Wenn ein Client **IMsgServiceAdmin::SetPrimaryIdentity** aufruft, um explizit einen bestimmten Nachrichtendienst als Anbieter der Sitzungsidentität zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="d849e-120">When a client calls **IMsgServiceAdmin::SetPrimaryIdentity** to explicitly establish a particular message service as the provider of the session identity.</span></span> <span data-ttu-id="d849e-121">Weitere Informationen.</span><span class="sxs-lookup"><span data-stu-id="d849e-121">For more information.</span></span> <span data-ttu-id="d849e-122">Weitere Informationen finden Sie [unter IMsgServiceAdmin::SetPrimaryIdentity](imsgserviceadmin-setprimaryidentity.md).</span><span class="sxs-lookup"><span data-stu-id="d849e-122">See [IMsgServiceAdmin::SetPrimaryIdentity](imsgserviceadmin-setprimaryidentity.md).</span></span>
    
<span data-ttu-id="d849e-123">Wenn ein Profil erstellt wird, bestimmt MAPI den ersten zu konfigurierenden Nachrichtendienst, der einen Anbieter mit dem STATUS_PRIMARY_IDENTITY-Flag enthält, das in seiner **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md))-Eigenschaft festgelegt ist, um die primäre Identität zu liefern.</span><span class="sxs-lookup"><span data-stu-id="d849e-123">When a profile is created, MAPI designates the first message service to be configured that includes a provider with the STATUS_PRIMARY_IDENTITY flag set in its **PR_RESOURCE_FLAGS** ([PidTagResourceFlags](pidtagresourceflags-canonical-property.md)) property to supply the primary identity.</span></span> <span data-ttu-id="d849e-124">Innerhalb des festgelegten Nachrichtendiensts wird der erste Anbieter ausgewählt, der mit diesem Ressourcenflagsatz konfiguriert werden soll, um die Identität für den Dienst zur Verfügung zu stellen.</span><span class="sxs-lookup"><span data-stu-id="d849e-124">Within the designated message service, the first provider to be configured with this resource flag set is chosen to provide the identity for the service.</span></span> <span data-ttu-id="d849e-125">Das STATUS_PRIMARY_IDENTITY wird für alle anderen Anbieter im angegebenen Dienst und andere Nachrichtendienste im Profil geräumt.</span><span class="sxs-lookup"><span data-stu-id="d849e-125">The STATUS_PRIMARY_IDENTITY flag is cleared for all other providers in the designated service and other message services in the profile.</span></span> <span data-ttu-id="d849e-126">Wenn der Anbieter, der die primäre Identität liefert, jederzeit aus dem Profil entfernt wird, weist MAPI die Rolle dem nächsten zu konfigurierenden Anbieter zu, der Identität liefern kann.</span><span class="sxs-lookup"><span data-stu-id="d849e-126">If at any time the provider supplying primary identity is removed from the profile, MAPI assigns the role to the next provider to be configured that can supply identity.</span></span> <span data-ttu-id="d849e-127">Dies wird durch die Darstellung des Eintrags im Abschnitt des Anbieters  `PR_RESOURCE_FLAGS=STATUS_PRIMARY_IDENTITY` in MAPISVC.INF bestimmt.</span><span class="sxs-lookup"><span data-stu-id="d849e-127">This is determined by the appearance of the  `PR_RESOURCE_FLAGS=STATUS_PRIMARY_IDENTITY` entry in the provider's section in MAPISVC.INF.</span></span> 
  
<span data-ttu-id="d849e-128">Wenn ein Client die **IMsgServiceAdmin::SetPrimaryIdentity-Methode** eines Nachrichtendiensts aufruft, gibt er die MAPIUID für einen Dienstanbieter innerhalb des Zieldiensts an.</span><span class="sxs-lookup"><span data-stu-id="d849e-128">When a client calls a message service's **IMsgServiceAdmin::SetPrimaryIdentity** method, it specifies the MAPIUID for a service provider within the target service.</span></span> <span data-ttu-id="d849e-129">Weitere Informationen finden Sie unter [MAPIUID](mapiuid.md).</span><span class="sxs-lookup"><span data-stu-id="d849e-129">For more information, see [MAPIUID](mapiuid.md).</span></span> <span data-ttu-id="d849e-130">Der durch die **MAPIUID** dargestellte Dienstanbieter wird zugewiesen, um die primäre Identität für den Nachrichtendienst und für die Sitzung zu liefern, und alle anderen Anbieter im Dienst teilen diese Identität.</span><span class="sxs-lookup"><span data-stu-id="d849e-130">The service provider represented by the **MAPIUID** is assigned to supply the primary identity for the message service and for the session, and all of the other providers in the service will share this identity.</span></span> 
  
<span data-ttu-id="d849e-131">Jeder Anbieter im Nachrichtendienst, der für die Bereitstellung der primären Identität zuständig ist, aktualisiert seine Zeile in der Statustabelle, um die folgenden Eigenschaften zu enthalten.</span><span class="sxs-lookup"><span data-stu-id="d849e-131">Every provider in the message service responsible for supplying the primary identity updates its row in the status table to include the following properties.</span></span>
  
|<span data-ttu-id="d849e-132">**Primäre Identitätseigenschaft**</span><span class="sxs-lookup"><span data-stu-id="d849e-132">**Primary identity property**</span></span>|<span data-ttu-id="d849e-133">**Festgelegt auf**</span><span class="sxs-lookup"><span data-stu-id="d849e-133">**Set to**</span></span>|
|:-----|:-----|
|<span data-ttu-id="d849e-134">**PR_IDENTITY_DISPLAY** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="d849e-134">**PR_IDENTITY_DISPLAY** ([PidTagIdentityDisplay](pidtagidentitydisplay-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="d849e-135">Anzeigename des Objekts, das die primäre Identität liefert.</span><span class="sxs-lookup"><span data-stu-id="d849e-135">Display name of the object supplying the primary identity.</span></span>  <br/> |
|<span data-ttu-id="d849e-136">**PR_IDENTITY_SEARCH_KEY** ([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="d849e-136">**PR_IDENTITY_SEARCH_KEY** ([PidTagIdentitySearchKey](pidtagidentitysearchkey-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="d849e-137">Suchtaste für das Objekt, das die primäre Identität liefert.</span><span class="sxs-lookup"><span data-stu-id="d849e-137">Search key for the object supplying the primary identity.</span></span>  <br/> |
|<span data-ttu-id="d849e-138">**PR_IDENTITY_ENTRYID** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md))</span><span class="sxs-lookup"><span data-stu-id="d849e-138">**PR_IDENTITY_ENTRYID** ([PidTagIdentityEntryId](pidtagidentityentryid-canonical-property.md))</span></span>  <br/> |<span data-ttu-id="d849e-139">Eintrags-ID für das Objekt, das die primäre Identität liefert.</span><span class="sxs-lookup"><span data-stu-id="d849e-139">Entry identifier for the object supplying the primary identity.</span></span>  <br/> |
   
 <span data-ttu-id="d849e-140">**So rufen Sie die Eintrags-ID für das Objekt ab, das die primäre Identität liefert**</span><span class="sxs-lookup"><span data-stu-id="d849e-140">**To retrieve the entry identifier for the object supplying the primary identity**</span></span>
  
- <span data-ttu-id="d849e-141">Rufen Sie die **IMAPISession::QueryIdentity-Methode** auf.</span><span class="sxs-lookup"><span data-stu-id="d849e-141">Call the **IMAPISession::QueryIdentity** method.</span></span> <span data-ttu-id="d849e-142">Weitere Informationen finden Sie unter [IMAPISession::QueryIdentity](imapisession-queryidentity.md).</span><span class="sxs-lookup"><span data-stu-id="d849e-142">For more information, see [IMAPISession::QueryIdentity](imapisession-queryidentity.md).</span></span> <span data-ttu-id="d849e-143">**QueryIdentity** durchsucht die Statustabelle nach der Zeile, die den Wert STATUS_PRIMARY_IDENTITY in der spalte **PR_RESOURCE_FLAGS** enthält, und gibt die entsprechende **PR_IDENTITY_ENTRYID** als Eintrags-ID für die primäre Identität zurück.</span><span class="sxs-lookup"><span data-stu-id="d849e-143">**QueryIdentity** searches the status table for the row that contains the value STATUS_PRIMARY_IDENTITY in its **PR_RESOURCE_FLAGS** column and returns the corresponding **PR_IDENTITY_ENTRYID** as the entry identifier for the primary identity.</span></span> 
    

