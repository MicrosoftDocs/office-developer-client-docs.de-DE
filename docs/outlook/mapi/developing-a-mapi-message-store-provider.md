---
title: Entwickeln eines MAPI-Nachrichtenspeicheranbieteres
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
api_type:
- COM
ms.assetid: 83692674-0b5a-468d-9cd7-a2ac3d140bda
description: 'Letzte Änderung: Samstag, 23. Juli 2011'
ms.openlocfilehash: 76332b57b2957b5682efb415121ea6db42409c30
ms.sourcegitcommit: 8657170d071f9bcf680aba50b9c07f2a4fb82283
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/28/2019
ms.locfileid: "33412611"
---
# <a name="developing-a-mapi-message-store-provider"></a><span data-ttu-id="bd3b7-103">Entwickeln eines MAPI-Nachrichtenspeicheranbieteres</span><span class="sxs-lookup"><span data-stu-id="bd3b7-103">Developing a MAPI message store provider</span></span>
  
<span data-ttu-id="bd3b7-104">**Gilt für**: Outlook 2013 | Outlook 2016</span><span class="sxs-lookup"><span data-stu-id="bd3b7-104">**Applies to**: Outlook 2013 | Outlook 2016</span></span> 
  
<span data-ttu-id="bd3b7-105">Wie andere MAPI-Dienstanbieter sind Nachrichtenspeicher Dynamic Link Libraries (DLLs), die die Dienste eines zugrunde liegenden Speichermechanismus für MAPI-Clientanwendungen und den MAPI-Spooler präsentieren.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-105">Like other MAPI service providers, message stores are dynamic-link libraries (DLLs) that present the services of an underlying storage mechanism to MAPI client applications and the MAPI spooler.</span></span> <span data-ttu-id="bd3b7-106">Der Nachrichtenspeicheranbieter stellt den zugrunde liegenden Speichermechanismus als hierarchischen Satz von Ordnern und Nachrichten vor, die MAPI-Clients und der MAPI-Spooler verwenden können.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-106">The message store provider presents the underlying storage mechanism as a hierarchical set of folders and messages that MAPI clients and the MAPI spooler can use.</span></span>
  
<span data-ttu-id="bd3b7-107">Die folgende Abbildung zeigt die grundlegende ARCHITEKTUR des MAPI-Nachrichtenspeichers.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-107">The following illustration shows the basic MAPI message store architecture.</span></span>
  
<span data-ttu-id="bd3b7-108">**Architektur des Nachrichtenspeichers**</span><span class="sxs-lookup"><span data-stu-id="bd3b7-108">**Message store architecture**</span></span>
  
<span data-ttu-id="bd3b7-109">![Architektur des Nachrichtenspeichers](media/storearc.gif "Nachrichtenspeicherarchitektur")</span><span class="sxs-lookup"><span data-stu-id="bd3b7-109">![Message store architecture](media/storearc.gif "Message store architecture")</span></span>
  
<span data-ttu-id="bd3b7-110">Sie können einen Nachrichtenspeicheranbieter mithilfe eines beliebigen zugrunde liegenden Speichermechanismus implementieren.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-110">You can implement a message store provider by using any sort of underlying storage mechanism you like.</span></span> <span data-ttu-id="bd3b7-111">Allerdings müssen Sie sich der Leistungsbedenken bewusst sein.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-111">However, you need to be aware of performance concerns.</span></span> <span data-ttu-id="bd3b7-112">Darüber hinaus muss der zugrunde liegende Speichermechanismus als hierarchische Auflistung von MAPI-Objekten dargestellt werden.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-112">In addition, the underlying storage mechanism must be presented as a hierarchical collection of MAPI objects.</span></span> <span data-ttu-id="bd3b7-113">Diese Anforderungen bedeuten, dass Nachrichtenspeicher in der Regel mithilfe eines vorhandenen Datenbankprodukts implementiert werden, das die hierarchische Speicherung von Objekten in der Datenbank unterstützt und über eine Programmierschnittstelle oder eine klar definierte Dateistruktur verfügt.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-113">These requirements mean that message stores are typically implemented by using an existing database product that supports hierarchical storage of objects in the database and that has a programming interface or well-defined file structure.</span></span> <span data-ttu-id="bd3b7-114">Beispielsweise können Microsoft Office Access-, SQL- und Oracle-Datenbanken als zugrunde liegender Speichermechanismus verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-114">For example, Microsoft Office Access, SQL, and Oracle databases can be used as the underlying storage mechanism.</span></span> <span data-ttu-id="bd3b7-115">Einige Datenbankprodukte verfügen über Featuresätze, die die Implementierung von MAPI-Features vereinfachen, sodass Ihre Auswahl des Datenbankprodukts von den Features betroffen sein kann, die Ihr Nachrichtenspeicheranbieter unterstützen muss.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-115">Some database products have feature sets that make it easier to implement MAPI features, so your choice of database product may be affected by the features that your message store provider needs to support.</span></span>
  
<span data-ttu-id="bd3b7-116">Die Verwendung einer vorhandenen Datenbank als zugrunde liegender Speichermechanismus erspart Ihnen Arbeit, da es in der Regel einfacher ist, MapI-Clients Datenbankobjekte als MAPI-Objekte zu präsentieren, als einen eigenen hierarchischen Speichermechanismus zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-116">Using an existing database as the underlying storage mechanism saves you work because it is usually easier to present database objects to MAPI clients as MAPI objects than to implement your own hierarchical storage mechanism.</span></span> <span data-ttu-id="bd3b7-117">Auf diese Weise können Sie MAPI-Vorgänge auf einer höheren Ebene behandeln, als wenn Sie einen eigenen hierarchischen Speichermechanismus implementieren.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-117">Doing this enables you to treat MAPI operations at a higher level than if you implement your own hierarchical storage mechanism.</span></span> <span data-ttu-id="bd3b7-118">Beispielsweise wird die Suche nach einer Nachricht mit einer bestimmten Betreffzeile zu einer ziemlich einfachen Aufgabe, eine entsprechende Datenbankabfrage zu erstellen und zu übermitteln, anstatt komplexe Routinen zu implementieren, um Ihren hierarchischen Speichermechanismus zu durchsuchen.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-118">For example, searching for a message with a particular subject line becomes a fairly simple matter of constructing and submitting an appropriate database query, rather than implementing complex routines to search your hierarchical storage mechanism.</span></span>
  
<span data-ttu-id="bd3b7-119">Nachrichtenspeicheranbieter kommunizieren mit MAPI-Clients und dem MAPI-Spooler, um Vorgänge für Ordner und Objekte durchzuführen.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-119">Message store providers communicate with MAPI clients and the MAPI spooler to perform operations on folders and objects.</span></span> <span data-ttu-id="bd3b7-120">Der Nachrichtenspeicheranbieter übersetzt diese Vorgänge in Vorgänge auf niedrigerer Ebene für den zugrunde liegenden Speichermechanismus.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-120">The message store provider translates those operations into lower level operations on the underlying storage mechanism.</span></span> <span data-ttu-id="bd3b7-121">Der MAPI-Spooler kommuniziert normalerweise beim Senden und Empfangen von Nachrichten mit dem Nachrichtenspeicheranbieter.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-121">The MAPI spooler typically communicates with the message store provider while sending and receiving messages.</span></span> <span data-ttu-id="bd3b7-122">MAPI-Clients kommunizieren in der Regel mit Nachrichtenspeicheranbietern, um die Ordnerhierarchie zu bearbeiten und Nachrichten zu lesen, zu bearbeiten, zu löschen und zu senden.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-122">MAPI clients typically communicate with message store providers to manipulate the folder hierarchy and to read, edit, delete, and send messages.</span></span>
  
<span data-ttu-id="bd3b7-123">Sowohl die MAPI-Spooler- als auch die MAPI-Clients kommunizieren mit dem Nachrichtenspeicheranbieter, um neue Nachrichten zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-123">Both the MAPI spooler and MAPI clients communicate with the message store provider to create new messages.</span></span> <span data-ttu-id="bd3b7-124">Clientanwendungen tun dies, wenn Benutzer eine Nachricht verfassen.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-124">Client applications do this when users compose a message.</span></span> <span data-ttu-id="bd3b7-125">Der MAPI-Spooler führt dies aus, wenn er eine eingehende Nachricht empfängt.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-125">The MAPI spooler does this when it receives an incoming message.</span></span> <span data-ttu-id="bd3b7-126">In beiden Fällen wird die neue Nachricht in der Regel im Posteingangsordner des Nachrichtenspeichers erstellt, wenn es eine gibt.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-126">In either case, the new message is usually created in the Inbox folder of the message store, if there is one.</span></span>
  
<span data-ttu-id="bd3b7-127">Nachrichtenspeicheranbieter nutzen MAPI-Tabellen, Ordner, Nachrichten und Eigenschaften stark.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-127">Message store providers make heavy use of MAPI tables, folders, messages, and properties.</span></span> <span data-ttu-id="bd3b7-128">Die Implementierungsdetails für diese Objekte sind in [MAPI Tables,](mapi-tables.md) [MAPI Folders,](mapi-folders.md) [MAPI Messages](mapi-messages.md)und [MAPI Property Overview dokumentiert.](mapi-property-overview.md)</span><span class="sxs-lookup"><span data-stu-id="bd3b7-128">The implementation details for those objects are documented in [MAPI Tables](mapi-tables.md), [MAPI Folders](mapi-folders.md), [MAPI Messages](mapi-messages.md), and [MAPI Property Overview](mapi-property-overview.md).</span></span> <span data-ttu-id="bd3b7-129">Sie sollten sich mit diesem Material vertraut machen, bevor Sie versuchen, einen Nachrichtenspeicheranbieter zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-129">You should familiarize yourself with that material before attempting to implement a message store provider.</span></span>
  
<span data-ttu-id="bd3b7-130">Es gibt zwei wichtige Typen von Nachrichtenspeicheranbietern: solche, die als Standardnachrichtenspeicher eines Benutzers fungieren können, und solche, die nicht verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-130">There are two important types of message store providers: those that can act as a user's default message store and those that cannot.</span></span> <span data-ttu-id="bd3b7-131">Ein Standardnachrichtenspeicher ist ein Nachrichtenspeicher, in dem Clientanwendungen und der MAPI-Spooler jede Messagingaufgabe ausführen können, z. B. das Empfangen von Nachrichten oder das Erstellen von Ordnern.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-131">A default message store is one in which client applications and the MAPI spooler can perform any messaging task, such as receiving messages or creating folders.</span></span> <span data-ttu-id="bd3b7-132">Ein Standardmäßiger Nachrichtenspeicheranbieter muss mehrere weitere Features als die für alle Nachrichtenspeicheranbieter erforderliche Mindestanzahl unterstützen.</span><span class="sxs-lookup"><span data-stu-id="bd3b7-132">A default message store provider must support several more features than the minimum number required for all message store providers.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="bd3b7-133">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="bd3b7-133">See also</span></span>

- [<span data-ttu-id="bd3b7-134">MAPI-Konzepte</span><span class="sxs-lookup"><span data-stu-id="bd3b7-134">MAPI concepts</span></span>](mapi-concepts.md)

