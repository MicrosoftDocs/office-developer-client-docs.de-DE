---
title: Analysieren des Nachrichtendownloadverlaufs für ein POP3-Konto
manager: soliver
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
localization_priority: Normal
ms.assetid: 394e1430-04d6-4d61-be13-eb695309fa73
description: In diesem Thema wird die Struktur des POP3-BLOB beschrieben, das den Nachrichtendownloadverlauf eines POP3-Kontos darstellt, um die Nachrichten zu identifizieren, die für dieses Konto heruntergeladen oder gelöscht wurden.
ms.openlocfilehash: 44a799f6b6fbe2a2841522c18405149a470b0236
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "32327763"
---
# <a name="parsing-the-message-download-history-for-a-pop3-account"></a><span data-ttu-id="b07bd-103">Analysieren des Nachrichtendownloadverlaufs für ein POP3-Konto</span><span class="sxs-lookup"><span data-stu-id="b07bd-103">Parsing the message download history for a POP3 account</span></span>

<span data-ttu-id="b07bd-104">In diesem Thema wird die Struktur des POP3-BLOB beschrieben, das den Nachrichtendownloadverlauf eines POP3-Kontos darstellt, um die Nachrichten zu identifizieren, die für dieses Konto heruntergeladen oder gelöscht wurden.</span><span class="sxs-lookup"><span data-stu-id="b07bd-104">This topic describes the structure of the POP3 BLOB that represents the message download history of a POP3 account, to identify the messages that have been downloaded or deleted on that account.</span></span>

<span data-ttu-id="b07bd-105"><a name="OL15Con_AuxRef_ParsingMsgsHistory_WhyParseHistory"> </a></span><span class="sxs-lookup"><span data-stu-id="b07bd-105"><a name="OL15Con_AuxRef_ParsingMsgsHistory_WhyParseHistory"> </a></span></span>

## <a name="why-parse-the-message-download-history"></a><span data-ttu-id="b07bd-106">Warum sollte der Nachrichtendownloadverlauf analysiert werden?</span><span class="sxs-lookup"><span data-stu-id="b07bd-106">Why parse the message download history?</span></span>

<span data-ttu-id="b07bd-107">Der Post Office Protocol (POP)-Anbieter für Outlook ermöglicht Benutzern das Abrufen und Herunterladen neuer E-Mail-Nachrichten auf ihrem lokalen Gerät und anschließend das Verlassen oder Löschen dieser E-Mail-Nachrichten auf dem E-Mail-Server.</span><span class="sxs-lookup"><span data-stu-id="b07bd-107">The Post Office Protocol (POP) provider for Outlook allows users to retrieve and download new email messages on their local device, and subsequently to leave or delete these email messages on the mail server.</span></span> <span data-ttu-id="b07bd-108">Wenn der E-Mail-Client überprüft, ob neue Nachrichten heruntergeladen werden sollen, muss er nur die neuen Nachrichten für diesen Posteingang identifizieren und herunterladen können.</span><span class="sxs-lookup"><span data-stu-id="b07bd-108">When the mail client checks for new messages to download, it has to be able to identify and download only the new messages for that Inbox.</span></span> <span data-ttu-id="b07bd-109">Der E-Mail-Client verwendet dazu zunächst den Befehl UIDL (Unique ID Listing), um eine Karte jeder Nachricht zu erhalten, die jemals an diesen Posteingang an einen eindeutigen Bezeichner (Unique Identifier, UID) zugestellt wurde.</span><span class="sxs-lookup"><span data-stu-id="b07bd-109">The mail client does this by first using the UIDL (Unique ID Listing) command to obtain a map of each message that has ever been delivered to that Inbox to a unique identifier (UID).</span></span> <span data-ttu-id="b07bd-110">Der Client ruft außerdem den Nachrichtendownloadverlauf für Nachrichten ab, die für den Posteingang auf diesem Client heruntergeladen oder gelöscht wurden.</span><span class="sxs-lookup"><span data-stu-id="b07bd-110">The client also gets the message download history for messages that have been downloaded or deleted for the Inbox on that client.</span></span> <span data-ttu-id="b07bd-111">Mithilfe der UiD-Karte und des Downloadverlaufs der Nachricht kann der Client dann die Nachrichten identifizieren, die im Verlauf nicht vorhanden sind, als neu und sollten daher heruntergeladen werden.</span><span class="sxs-lookup"><span data-stu-id="b07bd-111">Using the message UID map and download history, the client can then identify those messages that are absent from the history as new and, hence, should be downloaded.</span></span>
  
<span data-ttu-id="b07bd-112">So erhalten Sie den Nachrichtendownloadverlauf für einen Posteingang:</span><span class="sxs-lookup"><span data-stu-id="b07bd-112">To get the messages download history for an Inbox:</span></span>
  
- <span data-ttu-id="b07bd-113">Führen Sie die Schritte unter Suchen des Nachrichtendownloadverlaufs für ein [POP3-Konto](locating-the-message-download-history-for-a-pop3-account.md) aus, um die [PidTagAttachDataBinary-Eigenschaft](https://msdn.microsoft.com/library/3b0a8b28-863e-4b96-a4c0-fdb8f40555b9%28Office.15%29.aspx) zu finden, die ein binary large object (BLOB) enthält, das den Nachrichtenverlauf für ein #A0 darstellt.</span><span class="sxs-lookup"><span data-stu-id="b07bd-113">Follow the steps in [Locating the message download history for a POP3 account](locating-the-message-download-history-for-a-pop3-account.md) to find the [PidTagAttachDataBinary](https://msdn.microsoft.com/library/3b0a8b28-863e-4b96-a4c0-fdb8f40555b9%28Office.15%29.aspx) property, which contains a binary large object (BLOB) that represents the message history for a POP3 account.</span></span> 
    
- <span data-ttu-id="b07bd-114">Lesen Sie dieses Thema, das die Struktur des BLOB beschreibt, und zeigt ein Beispiel-BLOB zum Identifizieren von Nachrichten, die für den Posteingang des POP3-Kontos heruntergeladen oder gelöscht wurden.</span><span class="sxs-lookup"><span data-stu-id="b07bd-114">Read this topic, which describes the structure of the BLOB, and shows an example BLOB to identify messages that have been downloaded or deleted for the Inbox of the POP3 account.</span></span>

<span data-ttu-id="b07bd-115"><a name="OL15Con_AuxRef_ParsingMsgsHistory_BLOBStructure"> </a></span><span class="sxs-lookup"><span data-stu-id="b07bd-115"><a name="OL15Con_AuxRef_ParsingMsgsHistory_BLOBStructure"> </a></span></span>

## <a name="pop-blob-structure"></a><span data-ttu-id="b07bd-116">POP-BLOB-Struktur</span><span class="sxs-lookup"><span data-stu-id="b07bd-116">POP BLOB structure</span></span>

<span data-ttu-id="b07bd-117">Die POP-BLOB-Struktur beginnt, wie in Tabelle 1 beschrieben, mit zwei Feldern, **Version** und **Count,** gefolgt von einer **Anzahl** von Ressourcentags, von denen jedes null-terminated ist.</span><span class="sxs-lookup"><span data-stu-id="b07bd-117">The POP BLOB structure, as described in Table 1, begins with two fields, **Version** and **Count**, followed by a **Count** number of resource tags, each of which is null-terminated.</span></span> 
  
<span data-ttu-id="b07bd-118">**Tabelle 1. Struktur des BLOB, das den Nachrichtendownloadverlauf eines POP3-Kontos darstellt**</span><span class="sxs-lookup"><span data-stu-id="b07bd-118">**Table 1. Structure of the BLOB that represents the message download history of a POP3 account**</span></span>

|<span data-ttu-id="b07bd-119">**Feld in BLOB**</span><span class="sxs-lookup"><span data-stu-id="b07bd-119">**Field in BLOB**</span></span>|<span data-ttu-id="b07bd-120">**Größe**</span><span class="sxs-lookup"><span data-stu-id="b07bd-120">**Size**</span></span>|<span data-ttu-id="b07bd-121">**Beschreibung**</span><span class="sxs-lookup"><span data-stu-id="b07bd-121">**Description**</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="b07bd-122">**Version**</span><span class="sxs-lookup"><span data-stu-id="b07bd-122">**Version**</span></span> <br/> |<span data-ttu-id="b07bd-123">2 Bytes</span><span class="sxs-lookup"><span data-stu-id="b07bd-123">2 bytes</span></span>  <br/> |<span data-ttu-id="b07bd-124">Muss 3 sein (**PBLOB_VERSION_NUM**).</span><span class="sxs-lookup"><span data-stu-id="b07bd-124">Must be 3 (**PBLOB_VERSION_NUM**).</span></span>  <br/> |
|<span data-ttu-id="b07bd-125">**Count**</span><span class="sxs-lookup"><span data-stu-id="b07bd-125">**Count**</span></span> <br/> |<span data-ttu-id="b07bd-126">2 Bytes</span><span class="sxs-lookup"><span data-stu-id="b07bd-126">2 bytes</span></span>  <br/> |<span data-ttu-id="b07bd-127">Die Anzahl der Ressourcentags in diesem BLOB.</span><span class="sxs-lookup"><span data-stu-id="b07bd-127">The number of resource tags in this BLOB.</span></span>  <br/> |
|<span data-ttu-id="b07bd-128">Ressourcentag</span><span class="sxs-lookup"><span data-stu-id="b07bd-128">Resource tag</span></span>  <br/> |<span data-ttu-id="b07bd-129">Variable</span><span class="sxs-lookup"><span data-stu-id="b07bd-129">Variable</span></span>  <br/> |<span data-ttu-id="b07bd-130">0 oder mehr null-terminierte UTF-8-Zeichenfolgen, die die Ressourcentags codieren.</span><span class="sxs-lookup"><span data-stu-id="b07bd-130">0 or more null-terminated UTF-8 strings that encode the resource tags.</span></span> <span data-ttu-id="b07bd-131">Die Anzahl der mit Null beendeten Zeichenfolgen muss mit **Count übereinstimmen.**</span><span class="sxs-lookup"><span data-stu-id="b07bd-131">The number of null-terminated strings must match **Count**.</span></span>  <br/> |
   
<span data-ttu-id="b07bd-132">Jedes Ressourcentag gibt den Vorgang an, der auf eine Nachricht angewendet wird, einige Datum-Uhrzeit-Metadaten zu dem Vorgang und codiert die UID der Nachricht.</span><span class="sxs-lookup"><span data-stu-id="b07bd-132">Each resource tag specifies the operation that is applied to a message, some date-time metadata about the operation, and encodes the UID of the message.</span></span> <span data-ttu-id="b07bd-133">Das Format einer Ressourcentagzeichenfolge wird wie folgt aufgeschlüsselt und in Tabelle 2 weiter erläutert.</span><span class="sxs-lookup"><span data-stu-id="b07bd-133">The format of a resource tag string is broken down as follows, and is further explained in Table 2.</span></span> 
  
`Ocyyyymmddhhmmssuuu...`
  
<span data-ttu-id="b07bd-134">**Tabelle 2. Struktur eines Ressourcentags**</span><span class="sxs-lookup"><span data-stu-id="b07bd-134">**Table 2. Structure of a resource tag**</span></span>

|<span data-ttu-id="b07bd-135">**Feld in einem Ressourcentag**</span><span class="sxs-lookup"><span data-stu-id="b07bd-135">**Field in a resource tag**</span></span>|<span data-ttu-id="b07bd-136">**Größe**</span><span class="sxs-lookup"><span data-stu-id="b07bd-136">**Size**</span></span>|<span data-ttu-id="b07bd-137">**Beschreibung**</span><span class="sxs-lookup"><span data-stu-id="b07bd-137">**Description**</span></span>|
|:-----|:-----|:-----|
| `O` <br/> |<span data-ttu-id="b07bd-138">1 Zeichen</span><span class="sxs-lookup"><span data-stu-id="b07bd-138">1 character</span></span>  <br/> |<span data-ttu-id="b07bd-139">Der Für die E-Mail-Nachricht ausgeführte Vorgang.</span><span class="sxs-lookup"><span data-stu-id="b07bd-139">The operation performed on the email message.</span></span> <span data-ttu-id="b07bd-140">Der Wert muss "+", "-" oder " sein, was einen erfolgreichen &amp; get-, delete- oder get-and-delete-Vorgang angibt.</span><span class="sxs-lookup"><span data-stu-id="b07bd-140">The value must be "+", "-", or "&amp;", which indicates a successful get, delete, or get-and-delete operation, respectively.</span></span>  <br/> |
| `c` <br/> |<span data-ttu-id="b07bd-141">1 Zeichen</span><span class="sxs-lookup"><span data-stu-id="b07bd-141">1 character</span></span>  <br/> |<span data-ttu-id="b07bd-142">Der Teil des Nachrichteninhalts, der an dem Vorgang beteiligt ist.</span><span class="sxs-lookup"><span data-stu-id="b07bd-142">The part of the message content involved in the operation.</span></span> <span data-ttu-id="b07bd-143">Der Wert muss " ", "h" oder "b" sein, was den Inhalt von keinem, Header oder Textkörper angibt.</span><span class="sxs-lookup"><span data-stu-id="b07bd-143">The value must be " ", "h", or "b", which indicates the content of none, header, or body, respectively.</span></span>  <br/> |
| `yyyy` <br/> |<span data-ttu-id="b07bd-144">4 Zeichen</span><span class="sxs-lookup"><span data-stu-id="b07bd-144">4 characters</span></span>  <br/> |<span data-ttu-id="b07bd-145">Das vierstellige Jahr des Vorgangs.</span><span class="sxs-lookup"><span data-stu-id="b07bd-145">The four-digit year of the operation.</span></span>  <br/> |
| `MM` <br/> |<span data-ttu-id="b07bd-146">2 Zeichen</span><span class="sxs-lookup"><span data-stu-id="b07bd-146">2 characters</span></span>  <br/> |<span data-ttu-id="b07bd-147">Der zweistellige Monat des Vorgangs.</span><span class="sxs-lookup"><span data-stu-id="b07bd-147">The two-digit month of the operation.</span></span>  <br/> |
| `dd` <br/> |<span data-ttu-id="b07bd-148">2 Zeichen</span><span class="sxs-lookup"><span data-stu-id="b07bd-148">2 characters</span></span>  <br/> |<span data-ttu-id="b07bd-149">Der zweistellige Tag des Vorgangs.</span><span class="sxs-lookup"><span data-stu-id="b07bd-149">The two-digit day of the operation.</span></span>  <br/> |
| `hh` <br/> |<span data-ttu-id="b07bd-150">2 Zeichen</span><span class="sxs-lookup"><span data-stu-id="b07bd-150">2 characters</span></span>  <br/> |<span data-ttu-id="b07bd-151">Die zweistellige Stunde des Vorgangs.</span><span class="sxs-lookup"><span data-stu-id="b07bd-151">The two-digit hour of the operation.</span></span>  <br/> |
| `mm` <br/> |<span data-ttu-id="b07bd-152">2 Zeichen</span><span class="sxs-lookup"><span data-stu-id="b07bd-152">2 characters</span></span>  <br/> |<span data-ttu-id="b07bd-153">Die zweistellige Minute des Vorgangs.</span><span class="sxs-lookup"><span data-stu-id="b07bd-153">The two-digit minute of the operation.</span></span>  <br/> |
| `ss` <br/> |<span data-ttu-id="b07bd-154">2 Zeichen</span><span class="sxs-lookup"><span data-stu-id="b07bd-154">2 characters</span></span>  <br/> |<span data-ttu-id="b07bd-155">Die zweistellige Sekunde des Vorgangs.</span><span class="sxs-lookup"><span data-stu-id="b07bd-155">The two-digit second of the operation.</span></span>  <br/> |
| `uuu…` <br/> |<span data-ttu-id="b07bd-156">Variable Länge</span><span class="sxs-lookup"><span data-stu-id="b07bd-156">Variable length</span></span>  <br/> |<span data-ttu-id="b07bd-157">Die codierte UID einer Nachricht.</span><span class="sxs-lookup"><span data-stu-id="b07bd-157">The encoded UID of a message.</span></span>  <br/> |

<span data-ttu-id="b07bd-158"><a name="OL15Con_AuxRef_ParsingMsgsHistory_Example"> </a></span><span class="sxs-lookup"><span data-stu-id="b07bd-158"><a name="OL15Con_AuxRef_ParsingMsgsHistory_Example"> </a></span></span>

## <a name="example"></a><span data-ttu-id="b07bd-159">Beispiel</span><span class="sxs-lookup"><span data-stu-id="b07bd-159">Example</span></span>

<span data-ttu-id="b07bd-160">Abbildung 1 zeigt ein Beispiel für ein BLOB, das den Nachrichtendownloadverlauf eines POP-Kontos darstellt.</span><span class="sxs-lookup"><span data-stu-id="b07bd-160">Figure 1 shows an example of a BLOB that represents the message download history of a POP account.</span></span> 
  
<span data-ttu-id="b07bd-161">**Abbildung 1. Beispiel-BLOB-Struktur für den Nachrichtendownloadverlauf eines POP3-Kontos**</span><span class="sxs-lookup"><span data-stu-id="b07bd-161">**Figure 1. Example BLOB structure for the message download history of a POP3 account**</span></span>

![BLOB für Nachrichten-Downloadverlauf von POP3-Konto](media/OL15Con_AuxRef_ParsingMsgsHistory_Blob.gif)
  
<span data-ttu-id="b07bd-163">Basierend auf der in Tabelle 1 und Tabelle 2 beschriebenen Struktur stellt dieser BLOB den Downloadverlauf von 23 E-Mail-Nachrichten dar.</span><span class="sxs-lookup"><span data-stu-id="b07bd-163">Based on the structure described in Table 1 and Table 2, this BLOB represents the download history of 23 email messages.</span></span>
  
<span data-ttu-id="b07bd-164">Beachten Sie zum Analysieren der unformatierten UID in jedem Ressourcentag, dass die UID dieser Codierung folgt: Zeichen in einer UID sind hauptsächlich alphanumerische Zeichen, und jedem nicht alphanumerischen Zeichen wird das ASCII-Zeichen "$" (0x24) vorangehen.</span><span class="sxs-lookup"><span data-stu-id="b07bd-164">To parse the raw UID in each resource tag, be aware that the UID follows this encoding: characters in a UID are mostly alphanumeric characters, and each non-alphanumeric character is preceded by the ASCII character "$" (0x24).</span></span> <span data-ttu-id="b07bd-165">Die ASCII-Zeichen $2d stellen also das nicht alphanumerische Zeichen "-" dar.</span><span class="sxs-lookup"><span data-stu-id="b07bd-165">So the ASCII characters $2d represent the non-alphanumeric character "-".</span></span> <span data-ttu-id="b07bd-166">Abbildung 2 zeigt ein Beispiel für das erste Konvertieren der unformatierten UID im Ressourcentag 1 in die ASCII-Darstellung und anschließend das Konvertieren eines nicht alphanumerischen Zeichens, dem "$" vorangegangen ist, um die tatsächliche UID zu erzeugen:</span><span class="sxs-lookup"><span data-stu-id="b07bd-166">Figure 2 shows an example of first converting the raw UID in resource tag 1 to the ASCII representation, then converting any non-alphanumeric character preceded by "$" to produce the actual UID:</span></span>
  
`0BC535DB-EA63-11E1-A75C-00215AD7BB74`
  
<span data-ttu-id="b07bd-167">**Abbildung 2. Konvertieren der unformatierten UID in einem Ressourcentag in die tatsächliche Nachrichten-UID**</span><span class="sxs-lookup"><span data-stu-id="b07bd-167">**Figure 2. Converting the raw UID in a resource tag to the actual message UID**</span></span>

![Konvertieren der Roh-UID in BLOB in tatsächliche Nachrichten-UID](media/OL15Con_AuxRef_ParsingMsgsHistory_BlobRscTag.gif)
  
<span data-ttu-id="b07bd-169">Zum Interpretieren von Ressourcentag 1 in diesem BLOB: Die Nachricht mit der UID wurde am  `0BC535DB-EA63-11E1-A75C-00215AD7BB74` 6. September 2012 um 13:11:38 Uhr erfolgreich abgerufen.</span><span class="sxs-lookup"><span data-stu-id="b07bd-169">To interpret resource tag 1 in this BLOB: the message with the UID  `0BC535DB-EA63-11E1-A75C-00215AD7BB74` was successfully retrieved on September 6, 2012, at 13:11:38.</span></span> 
  
<span data-ttu-id="b07bd-170">Sie können die verbleibenden 22 Ressourcentags für dieses BLOB ähnlich analysieren.</span><span class="sxs-lookup"><span data-stu-id="b07bd-170">You can similarly parse the remaining 22 resource tags for that BLOB.</span></span>
  
## <a name="see-also"></a><span data-ttu-id="b07bd-171">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="b07bd-171">See also</span></span>
<span data-ttu-id="b07bd-172"><a name="OL15Con_AuxRef_ParsingMsgsHistory_AdditionalRsc"> </a></span><span class="sxs-lookup"><span data-stu-id="b07bd-172"><a name="OL15Con_AuxRef_ParsingMsgsHistory_AdditionalRsc"> </a></span></span>

- [<span data-ttu-id="b07bd-173">Verwalten des Nachrichtendownloads für POP3-Konten</span><span class="sxs-lookup"><span data-stu-id="b07bd-173">Managing message downloads for POP3 accounts</span></span>](managing-message-downloads-for-pop3-accounts.md)    
- [<span data-ttu-id="b07bd-174">Suchen den Nachrichten-Downloadverlauf für ein POP3-Konto</span><span class="sxs-lookup"><span data-stu-id="b07bd-174">Locating the message download history for a POP3 account</span></span>](locating-the-message-download-history-for-a-pop3-account.md)    
- [<span data-ttu-id="b07bd-175">Analyse des POP3-UIDL-Verlaufs</span><span class="sxs-lookup"><span data-stu-id="b07bd-175">Parsing the POP3 UIDL History</span></span>](https://blogs.msdn.com/b/stephen_griffin/archive/2012/12/04/parsing-the-pop3-uidl-history.aspx)
    

